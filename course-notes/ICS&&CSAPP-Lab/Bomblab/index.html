
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../Datalab/" rel="prev"/>
<link href="../Binalab/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.20" name="generator"/>
<title>CSAPP Bomblab - CSNote</title>
<link href="../../../assets/stylesheets/main.e53b48f4.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet"/>
<link href="https://fonts.loli.net/css?family=JetBrains Mono:400,500,600,700&amp;display=swap" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="black" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#csapp-bomblab-solution">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="CSNote" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="CSNote">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            CSNote
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              CSAPP Bomblab
            
          </span>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="CSNote" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="CSNote">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    CSNote
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    index
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    OI-learning
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            OI-learning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/">
<span class="md-ellipsis">
    intro
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/C%2B%2B%20OOP/">
<span class="md-ellipsis">
    C++ é¢å‘å¯¹è±¡
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Algorithm
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            Algorithm
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Algorithm/STL_algorithm/">
<span class="md-ellipsis">
    STL ç®—æ³•åº“ ref
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Algorithm/fastpow/">
<span class="md-ellipsis">
    å¿«é€Ÿå¹‚
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Data Structure
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
            Data Structure
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Data-Structure/linkedlist/">
<span class="md-ellipsis">
    é“¾è¡¨
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Data-Structure/vector/">
<span class="md-ellipsis">
    STL vector ref
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Data-Structure/stack/">
<span class="md-ellipsis">
    æ ˆ &amp;&amp; å•è°ƒæ ˆ
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Data-Structure/queue/">
<span class="md-ellipsis">
    é˜Ÿåˆ— &amp;&amp; å•è°ƒé˜Ÿåˆ—
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../OI-Learning/Data-Structure/hashmap/">
<span class="md-ellipsis">
    å“ˆå¸Œè¡¨
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Course Notes
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
<span class="md-ellipsis">
    ICSPA x86 note
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_1">
<span class="md-nav__icon md-icon"></span>
            ICSPA x86 note
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ICSPA-x86/PA0/">
<span class="md-ellipsis">
    PA0
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ICSPA-x86/PA1/">
<span class="md-ellipsis">
    PA1
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ICSPA-x86/PA2-1/">
<span class="md-ellipsis">
    PA2-1
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ICSPA-x86/i386/">
<span class="md-ellipsis">
    i386 æŒ‡ä»¤ç»“æ„ for PA2-1
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ICSPA-x86/PA2-2/">
<span class="md-ellipsis">
    PA2-2
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
<span class="md-ellipsis">
    ç½‘ç»œæ”»é˜²å®æˆ˜ note
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
            ç½‘ç»œæ”»é˜²å®æˆ˜ note
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network-attack-and-defense-in-action/lab01/">
<span class="md-ellipsis">
    Lab01
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network-attack-and-defense-in-action/lab02/">
<span class="md-ellipsis">
    Lab02
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network-attack-and-defense-in-action/lab03/">
<span class="md-ellipsis">
    Lab03
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network-attack-and-defense-in-action/lab04/">
<span class="md-ellipsis">
    Lab04
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Network-attack-and-defense-in-action/lab05/">
<span class="md-ellipsis">
    Lab05
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
<span class="md-ellipsis">
    ICS &amp;&amp; CSAPP Labs
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
            ICS &amp;&amp; CSAPP Labs
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../intro/">
<span class="md-ellipsis">
    intro
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Datalab/">
<span class="md-ellipsis">
    CSAPP Datalab
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    CSAPP Bomblab
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    CSAPP Bomblab
    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#solution">
<span class="md-ellipsis">
      Solution
    </span>
</a>
<nav aria-label="Solution" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-1">
<span class="md-ellipsis">
      Phase 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-2">
<span class="md-ellipsis">
      Phase 2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-3">
<span class="md-ellipsis">
      Phase 3
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-4">
<span class="md-ellipsis">
      Phase 4
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-5">
<span class="md-ellipsis">
      Phase 5
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-6">
<span class="md-ellipsis">
      Phase 6
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#secret-phase">
<span class="md-ellipsis">
      Secret Phase
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#final-ans">
<span class="md-ellipsis">
      Final Ans
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Binalab/">
<span class="md-ellipsis">
    ICS Binalab
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Deep Learning
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Deep Learning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../Deep-Learning/intro/">
<span class="md-ellipsis">
    intro
    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#solution">
<span class="md-ellipsis">
      Solution
    </span>
</a>
<nav aria-label="Solution" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-1">
<span class="md-ellipsis">
      Phase 1
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-2">
<span class="md-ellipsis">
      Phase 2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-3">
<span class="md-ellipsis">
      Phase 3
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-4">
<span class="md-ellipsis">
      Phase 4
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-5">
<span class="md-ellipsis">
      Phase 5
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#phase-6">
<span class="md-ellipsis">
      Phase 6
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#secret-phase">
<span class="md-ellipsis">
      Secret Phase
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#final-ans">
<span class="md-ellipsis">
      Final Ans
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="csapp-bomblab-solution">CSAPP Bomblab Solution</h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p>âœ 2245 words  | ğŸ› 703 codelines  | â° 16 min read | Enjoy ğŸ¶</p>
</div>
<p>äºŒè¿›åˆ¶ç‚¸å¼¹ <code>Bomb</code> æ˜¯ä¸€ä¸ªç”±å¤šä¸ªé˜¶æ®µç»„æˆçš„ç¨‹åºï¼Œæ¯ä¸ªé˜¶æ®µä¼šè¦æ±‚ç”¨æˆ·åœ¨ <code>stdin</code> è¾“å…¥ç‰¹å®šå­—ç¬¦ä¸²ã€‚è‹¥è¾“å…¥æ­£ç¡®ï¼Œè¯¥é˜¶æ®µå³è¢«æ‹†é™¤å¹¶è¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼›å¦åˆ™ç¨‹åºå°†è¾“å‡º"BOOM! ! ! "åç»ˆæ­¢ï¼ˆå³ç‚¸å¼¹çˆ†ç‚¸ï¼‰ã€‚åªæœ‰å½“æ‰€æœ‰é˜¶æ®µå‡è¢«æ‹†é™¤åï¼Œç‚¸å¼¹æ‰ç®—å½»åº•è§£é™¤ã€‚</p>
<div class="admonition quote">
<p class="admonition-title">éšç¬”</p>
<p>æš‘å‡å†™ Bomblab çš„æ—¶å€™æˆ‘åªæ¥è§¦è¿‡ RISC-V çš„æ±‡ç¼–è¯­è¨€ï¼Œæ²¡æœ‰ i386 æ±‡ç¼–çš„é˜…è¯»ç»éªŒã€‚å› æ­¤è¿™ç¯‡é¢˜è§£çš„è¯­è¨€æ¯”è¾ƒç»†ç¢ï¼Œå¹¶ä¸”å¯¹äº â€œå¯„å­˜å™¨å­˜å‚¨å€¼â€ ä¸ â€œå¯„å­˜å™¨å­˜å‚¨åœ°å€æŒ‡å‘å€¼â€ çš„æ¦‚å¿µæœ‰äº›åŒºåˆ†ä¸æ¸…ï¼ˆå¸Œæœ›ä¸ä¼šè¿‡åº¦å½±å“ç†è§£ï¼‰</p>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒBinalab çš„é¢˜è§£æ˜¾å¾—æ›´åŠ ç†Ÿç»ƒ</p>
</div>
<hr/>
<h2 id="solution">Solution</h2>
<p>ä¸ºäº†é”»ç‚¼ä¸ªäººé˜…è¯» x86-64 æ±‡ç¼–ä»£ç çš„èƒ½åŠ›ï¼Œæˆ‘é‡‡ç”¨çš„æ‹†å¼¹æ–¹æ¡ˆæ˜¯ç›´æ¥åˆ†æåæ±‡ç¼–ä»£ç ï¼Œå› æ­¤ä¸‹é¢çš„æ“ä½œå°†å¾ˆå°‘ä½¿ç”¨ gdb å·¥å…·</p>
<p>åœ¨è¿›è¡Œå¯¹ <code>bomb</code> çš„åç¼–è¯‘ä¹‹å‰ï¼Œå¯ä»¥çœ‹ä¸€çœ‹æ—è¾¹çš„ <code>bomb.c</code> æ–‡ä»¶ï¼ˆè¿™æ˜¯ä¸€ä¸ªæç¤ºä½œç”¨çš„æ–‡ä»¶ï¼Œå±•ç¤ºäº†åŸç¨‹åº <code>&lt;main&gt;</code> å‡½æ•°çš„æµç¨‹ï¼‰ï¼Œè¿™ä¸ªCç¨‹åºå‘Šè¯‰æˆ‘ä»¬ <code>bomb</code> çš„è¿è¡Œæ–¹å¼ï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_line</span><span class="p">();</span><span class="w">                </span><span class="cm">/* Get input                   */</span>
<span class="n">phase_1</span><span class="p">(</span><span class="n">input</span><span class="p">);</span><span class="w">                     </span><span class="cm">/* Run the phase               */</span>
<span class="n">phase_defused</span><span class="p">();</span><span class="w">                    </span><span class="cm">/* Drat!  They figured it out!</span>
<span class="cm">                                     * Let me know how they did it. */</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"Phase 1 defused. How about the next one?</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>å¦å¤–æœ€åçš„æ³¨é‡Šè¯´æ˜ä¹Ÿæš—ç¤ºäº†æ€»å…±ä¸åªæœ‰å…­ä¸ª bomb éœ€è¦æ‹†é™¤ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cm">/* Wow, they got it!  But isn't something... missing?  Perhaps</span>
<span class="cm"> * something they overlooked?  Mua ha ha ha ha! */</span>
</code></pre></div></td></tr></table></div>
<p><code>â¯ objdump bomb -d -j .text</code> å¼€å§‹æ‹†å¼¹ï¼ˆåç¼–è¯‘ä»£ç æ®µï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šæ ‡è®°ç‚¹ï¼Œè€Œæˆ‘ä»¬ç›®å‰éœ€è¦å…³æ³¨çš„åªæœ‰ <code>&lt;main&gt;</code> éƒ¨åˆ†å’Œ <code>&lt;phase&gt;</code> éƒ¨åˆ†ã€‚å…¶ä¸­ <code>main</code> éƒ¨åˆ†ä» <code>bomb.c</code> æ–‡ä»¶ä¸­å°±èƒ½ç†è§£æ„æ€ï¼ˆåˆå§‹åŒ–ç‚¸å¼¹ï¼Œæ£€æµ‹è¾“å…¥åˆ¤æ–­ç‚¸å¼¹æ˜¯å¦çˆ†ç‚¸ç­‰ç­‰ï¼‰ï¼Œæ‰€ä»¥ç›´æ¥çœ‹å…­ä¸ªé˜¶æ®µçš„æ±‡ç¼–ä»£ç å³å¯ï¼š</p>
<p>ï¼ˆæœ‰è¶£çš„æ˜¯æœ‰ä¸€ä¸ª <code>&lt;secret_phase&gt;</code> æ ‡è®°ç‚¹ï¼Œè¿™å¯¹åº”äº† <code>bomb.c</code> ä¸­æš—ç¤ºçš„éšè—ç‚¸å¼¹ï¼‰</p>
<hr/>
<h3 id="phase-1">Phase 1</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">000000000400</span><span class="nf">ee0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase_1</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ee0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                    </span><span class="c1"># æ ˆä¸Šåˆ†é… 8byte çš„ç©ºé—´ï¼ˆèµ·å¯¹é½ä½œç”¨ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ee4:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x402400</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># å°† 0x402400 è¿™ä¸ªåœ°å€åŠ è½½åˆ° %esi ä¸­</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ee9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">4</span><span class="no">a</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401338</span> <span class="p">&lt;</span><span class="no">strings_not_equal</span><span class="p">&gt;</span><span class="w">   </span><span class="c1"># è°ƒç”¨æ‰§è¡Œ strings_not_equal å‡½æ•°</span>
<span class="w">  </span><span class="err">400</span><span class="nl">eee:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># è®¡ç®— %eax &amp; %eaxï¼Œä¸ä¿å­˜ç»“æœï¼Œç›®çš„æ˜¯æ”¹å˜æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ef0:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400ef7</span> <span class="p">&lt;</span><span class="no">phase_1</span><span class="p">+</span><span class="mi">0x17</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å½“æ ‡å¿—ä½ ZF==1 æ—¶è·³è½¬åˆ° 400ef7 ï¼ˆè¡¨ç¤ºæ‹†å¼¹æˆåŠŸï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ef2:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!!!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ef7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                    </span><span class="c1"># é‡Šæ”¾æ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">400</span><span class="nl">efb:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">                                 </span><span class="c1"># ç»“æŸå­ç¨‹åº</span>

<span class="err">0000000000401338</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">strings_not_equal</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># æ¯”è¾ƒ %rdi ä¸ %rsi æŒ‡å‘çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰åˆ™è¿”å› 1ï¼Œåä¹‹è¿”å› 0ï¼Œæ­¤å¤„åç¼–è¯‘ä»£ç ç•¥</span>
</code></pre></div></td></tr></table></div>
<p><code>strings_not_equal</code> æ¯”è¾ƒçš„æ˜¯è¾“å…¥ <code>%rdi</code> å’Œ <code>%rsi</code> æŒ‡å‘çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸ç›¸åŒï¼Œè€Œä¸¤ä¸ªç›¸åŒçš„è¾“å…¥å¯ä»¥è§¦å‘ <code>je</code> çš„è·³è½¬é¿å…ç‚¸å¼¹çˆ†ç‚¸</p>
<p>ï¼ˆæ ‡å¿—ä½å°±æ˜¯æ¡ä»¶ç ï¼‰</p>
<p><code>400ee4</code> å¤„ <code>%esi</code> è¢«èµ‹å€¼ä¸º <code>$0x402400</code> çš„å­—ç¬¦ä¸²ï¼Œåœ¨gdbç¯å¢ƒä¸­å¯¹è¿™ä¸ªåœ°å€æŸ¥çœ‹å­˜å‚¨çš„å­—ç¬¦ä¸²å†…å®¹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>â¯<span class="w"> </span>gdb<span class="w"> </span>./bomb
GNU<span class="w"> </span>gdb<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span><span class="m">12</span>.1-0ubuntu1~22.04.2<span class="o">)</span><span class="w"> </span><span class="m">12</span>.1
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/s<span class="w"> </span>0x402400
0x402400:<span class="w">   </span><span class="s2">"Border relations with Canada have never been better."</span>
</code></pre></div></td></tr></table></div>
<p>å¾—åˆ°äº†ç¬¬ä¸€ä¸ªç­”æ¡ˆï¼š<code>Border relations with Canada have never been better.</code></p>
<div class="admonition tip">
<p class="admonition-title">gdb çš„ <code>x</code> å‘½ä»¤ï¼ˆe<strong>X</strong>amine memoryï¼‰ç”¨äºæŸ¥çœ‹å†…å­˜ä¸­çš„æ•°æ®</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>x/<span class="o">[</span>N<span class="o">][</span>F<span class="o">][</span>U<span class="o">]</span><span class="w"> </span>&lt;address&gt;
</code></pre></div></td></tr></table></div>
<p><strong><code>N</code></strong>ï¼šæ˜¾ç¤ºçš„å•ä½æ•°é‡ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º1ï¼‰ã€‚</p>
<p><strong><code>F</code></strong>ï¼šæ˜¾ç¤ºæ ¼å¼ï¼ˆå¦‚åå…­è¿›åˆ¶ã€åè¿›åˆ¶ã€å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚</p>
<p><strong><code>U</code></strong>ï¼šå•ä½å¤§å°ï¼ˆå¦‚å­—èŠ‚ã€å­—ã€åŒå­—ç­‰ï¼‰ã€‚</p>
<p><strong><code>&lt;address&gt;</code></strong>ï¼šå†…å­˜åœ°å€ï¼ˆå¯ä»¥æ˜¯å¯„å­˜å™¨ã€å˜é‡åæˆ–ç›´æ¥åœ°å€ï¼‰ã€‚</p>
</div>
<h3 id="phase-2">Phase 2</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400</span><span class="nf">efc</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase_2</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400</span><span class="nl">efc:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400</span><span class="nl">efd:</span><span class="w">   </span><span class="err">53</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbx</span><span class="w">                         </span><span class="c1"># è¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨</span>
<span class="w">  </span><span class="err">400</span><span class="nl">efe:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">28</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x28</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                   </span><span class="c1"># å¼€è¾Ÿæ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f02:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f05:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">52</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40145c</span> <span class="p">&lt;</span><span class="no">read_six_numbers</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># è¡¨æ˜å¯†ç æ˜¯å…­ä¸ªï¼ˆæ•´ï¼‰æ•°</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f0a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">3</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">                  </span><span class="c1"># æ ¹æ® (%rsp) - 1 æ”¹å˜æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f0e:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">20</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400f30</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å¦‚æœç›¸ç­‰å°±è·³è½¬ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥ BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f10:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f15:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">19</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400f30</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— æ¡ä»¶è·³è½¬</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f17:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># ä» 400f3a è·³è½¬ï¼›å°† (%rbx-4) å¤„æ•°æ®å­˜å…¥ %eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f1a:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">add</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># %eax *= 2</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f1c:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="err">03</span><span class="w">                   </span><span class="nf">cmp</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,(</span><span class="nv">%rbx</span><span class="p">)</span><span class="w">                  </span><span class="c1"># æ ¹æ®(%rbx) - %eax è®¾ç½®æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f1e:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400f25</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å¦‚æœç›¸ç­‰å°±è·³è½¬ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥ BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f20:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f25:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c3</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%rbx</span><span class="w">                    </span><span class="c1"># ä» 400f1e è·³è½¬ï¼›%rbx+=4</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f29:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">39</span><span class="w"> </span><span class="nf">eb</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%rbp</span><span class="p">,</span><span class="nv">%rbx</span><span class="w">                    </span><span class="c1"># æ ¹æ® %rbx - %rbp æ”¹å˜æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f2c:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">e9</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">400f17</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x1b</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å¦‚æœä¸ç›¸ç­‰å°±è·³è½¬å›ä¸Šä¸€æ¬¡è·³è½¬ç‚¹ï¼ˆä¸€æ¬¡å¾ªç¯ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f2e:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400f3c</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x40</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— æ¡ä»¶è·³è½¬ï¼Œè¡¨ç¤ºæ‹†å¼¹æˆåŠŸ</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f30:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">5</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">04</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbx</span><span class="w">               </span><span class="c1"># ä» 400f0e è·³è½¬ï¼›%rbx = %rsp+4</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f35:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">6</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbp</span><span class="w">              </span><span class="c1"># %rbp = %rsp + 0x18</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f3a:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">db</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400f17</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x1b</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— æ¡ä»¶è·³è½¬</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f3c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">28</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x28</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f40:</span><span class="w">   </span><span class="err">5</span><span class="nf">b</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f41:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f42:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span>

<span class="err">000000000040145</span><span class="nf">c</span><span class="w"> </span><span class="err">&lt;</span><span class="no">read_six_numbers</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># è¯»å–å…­ä¸ªæ•°</span>
<span class="na">...</span><span class="w"> </span><span class="no">...</span>
<span class="w">  </span><span class="err">401480:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">c3</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x4025c3</span><span class="p">,</span><span class="nv">%esi</span>
<span class="na">...</span><span class="w"> </span><span class="no">...</span>
<span class="c1"># (gdb) x/s 0x4025c3</span>
<span class="c1"># 0x4025c3: "%d %d %d %d %d %d"</span>
<span class="c1"># è¯´æ˜è¯»å–çš„æ˜¯æ•´æ•°ï¼Œæ•°å­—ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”</span>
</code></pre></div></td></tr></table></div>
<p>é¦–å…ˆçœ‹æœ€å¼€å§‹çš„è¿™ä¸€éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">f0a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">3</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">                  </span><span class="c1"># æ ¹æ® (%rsp) - 1 æ”¹å˜æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f0e:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">20</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400f30</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å¦‚æœç›¸ç­‰å°±è·³è½¬ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥ BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f10:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
</code></pre></div></td></tr></table></div>
<p>å¾ˆæ˜æ˜¾ï¼Œç¬¬ä¸€ä¸ªæ•°å­—è¦è¾“å…¥ <code>1</code> ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸</p>
<p>ç„¶åçœ‹è¿™ä¸€éƒ¨åˆ†</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">f30:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">5</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">04</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbx</span><span class="w">               </span><span class="c1"># ä» 400f0e è·³è½¬ï¼›%rbx = %rsp+4</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f35:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">6</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbp</span><span class="w">              </span><span class="c1"># %rbp = %rsp + 0x18</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f3a:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">db</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400f17</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x1b</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— æ¡ä»¶è·³è½¬</span>
</code></pre></div></td></tr></table></div>
<p>è¿™é‡Œç¨‹åºè®¾å®šäº† <code>%rbx</code> å­˜å‚¨ç¬¬äºŒä¸ªæ•°å­—<strong>çš„åœ°å€</strong>ï¼Œ<code>%rbp</code> ä¸ºç¬¬å…­ä¸ªæ•°å­—ä¹‹å<strong>çš„åœ°å€</strong>ï¼ˆ<code>0x18</code> = 24 = 6 intï¼‰ï¼Œæ¥ç€è·³è½¬åˆ°ä¸€ä¸ªå¾ªç¯éƒ¨åˆ†</p>
<p>ç»“åˆåé¢çš„ç¨‹åºå¯ä»¥çœ‹å¾—å‡ºæ¥ï¼Œè¿™æ®µä»£ç å¯ä»¥ç±»æ¯” <code>for (int i = 1; i &lt; 6; i++)</code> çš„å‰ä¸¤ä¸ªå‚æ•°è®¾ç½®</p>
<p>æ¥ç€æ˜¯è¿™ä¸€éƒ¨åˆ†ï¼Œçœ‹ä¸Šå»æ˜¯ä¸ªæœ‰é™å¾ªç¯</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">f17:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># ä» 400f3a è·³è½¬ï¼›å°† (%rbx-4) å¤„æ•°æ®å­˜å…¥ %eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f1a:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">add</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># %eax *= 2</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f1c:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="err">03</span><span class="w">                   </span><span class="nf">cmp</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,(</span><span class="nv">%rbx</span><span class="p">)</span><span class="w">                  </span><span class="c1"># æ ¹æ®(%rbx) - %eax è®¾ç½®æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f1e:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400f25</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å¦‚æœç›¸ç­‰å°±è·³è½¬ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥ BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f20:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f25:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c3</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%rbx</span><span class="w">                    </span><span class="c1"># ä» 400f1e è·³è½¬ï¼›%rbx+=4</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f29:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">39</span><span class="w"> </span><span class="nf">eb</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%rbp</span><span class="p">,</span><span class="nv">%rbx</span><span class="w">                    </span><span class="c1"># æ ¹æ® %rbx - %rbp æ”¹å˜æ ‡å¿—ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f2c:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">e9</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">400f17</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x1b</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># å¦‚æœä¸ç›¸ç­‰å°±è·³è½¬å›ä¸Šä¸€æ¬¡è·³è½¬ç‚¹ï¼ˆä¸€æ¬¡å¾ªç¯ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f2e:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400f3c</span> <span class="p">&lt;</span><span class="no">phase_2</span><span class="p">+</span><span class="mi">0x40</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— æ¡ä»¶è·³è½¬ï¼Œè¡¨ç¤ºæ‹†å¼¹æˆåŠŸ</span>
</code></pre></div></td></tr></table></div>
<p>è¿™é‡Œç›´æ¥å†™å‡ºå¯¹åº”çš„ C è¯­è¨€ä»£ç äº†ï¼Œå…¶ä¸­è§„å®š <code>%rsp</code> å¼€å§‹çš„å…­ä¸ªæ•°å­—ç»„æˆæ•°ç»„ <code>stack[6]</code> ï¼Œ<code>%rbx + 4</code> è¡¨ç¤º <code>i++</code> </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">EAX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">];</span><span class="w">                                               </span><span class="c1">// EAX ä¸º â€œä¸Šä¸€ä¸ªæ•°å­—â€</span>
<span class="w">    </span><span class="n">EAX</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">                                                           </span><span class="c1">// EAX ä¸º â€œä¸Šä¸€ä¸ªæ•°å­—â€ çš„ä¸¤å€</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">stack</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EAX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">){</span><span class="w">                                            </span><span class="c1">// ZF == 1 ?</span>
<span class="w">    </span><span class="k">continue</span><span class="p">;</span><span class="w">                                                           </span><span class="c1">// è·³è¿‡å¼•çˆ†ç‚¸å¼¹çš„å‡½æ•°</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">explode_bomb</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ç”±æ­¤å¯è§ï¼Œæ¥ä¸‹æ¥çš„äº”ä¸ªæ•°å­—éƒ½è¦æ±‚æ¯ä¸ªæ•°å­—æ˜¯ä¸Šä¸€ä¸ªæ•°å­—çš„ä¸¤å€ï¼Œå› æ­¤ç¬¬äºŒä¸ªç­”æ¡ˆæ˜¯ <code>1 2 4 8 16 32</code> </p>
<h3 id="phase-3">Phase 3</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400</span><span class="nf">f43</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase_3</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f43:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                   </span><span class="c1"># å¼€è¾Ÿæ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f47:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span><span class="w">               </span><span class="c1"># %rcx = %rsp + 12ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f4c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">               </span><span class="c1"># %rdx = %rsp + 8ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f51:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">cf</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x4025cf</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># (gdb) x/s 0x4025cf: "%d %d", èµ‹å€¼ç»™ %esi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f56:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># %eax = 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f5b:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400bf0</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span><span class="w"> </span><span class="c1"># è°ƒç”¨æ ‡å‡†åº“å‡½æ•° sscanfï¼Œè¯»å–çš„å†…å®¹å‚è§ 0x4025cf</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f60:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># æ¯”è¾ƒ %eax ~ 1</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f63:</span><span class="w">   </span><span class="err">7</span><span class="nf">f</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jg</span><span class="w">     </span><span class="mh">400f6a</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x27</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æœ‰ç¬¦å· â€œå¤§äºâ€ æˆç«‹åˆ™è·³è¿‡å¼•çˆ†ä»£ç ï¼Œå¦åˆ™ BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f65:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f6a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="mi">07</span><span class="w">          </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x7</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">               </span><span class="c1"># æ¯”è¾ƒ (%rsp + 8) ~ 7</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f6f:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">3</span><span class="nf">c</span><span class="w">                   </span><span class="no">ja</span><span class="w">     </span><span class="mh">400fad</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x6a</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— ç¬¦å· â€œå¤§äºâ€ æˆç«‹åˆ™è·³è½¬è‡³å¼•çˆ†ä»£ç ï¼Œå¦åˆ™ç»§ç»­å‘ä¸‹è¿è¡Œ</span>

<span class="w">  </span><span class="err">400</span><span class="nl">f71:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">               </span><span class="c1"># %eax = %rsp + 8</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f75:</span><span class="w">   </span><span class="nf">ff</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">jmp</span><span class="w">    </span><span class="p">*</span><span class="mi">0x402470</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">           </span><span class="c1"># è¿™é‡Œæ˜¯é—´æ¥è·³è½¬ä¸­çš„è·³è½¬è¡¨è·³è½¬ï¼Œæ˜¯ switch è¯­å¥çš„å®ç°</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f7c:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">cf</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xcf</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># %eax = 207</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f81:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">3</span><span class="no">b</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f83:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">c3</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x2c3</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 707</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f88:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">34</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f8a:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x100</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 256</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f8f:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">2</span><span class="no">d</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f91:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x185</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 389</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f96:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">26</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f98:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">ce</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xce</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># %eax = 206</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f9d:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f9f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">aa</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x2aa</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 682</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fa4:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">18</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fa6:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">47</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x147</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 327</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fab:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">11</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fad:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">88</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fb2:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># %eax = 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fb7:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fb9:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">37</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x137</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 311</span>

<span class="w">  </span><span class="err">400</span><span class="nl">fbe:</span><span class="w">   </span><span class="err">3</span><span class="nf">b</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">               </span><span class="c1"># æ¯”è¾ƒ %eax ~ (%rsp + 12)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fc2:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400fc9</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x86</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># è‹¥ â€œç›¸ç­‰â€ æˆç«‹åˆ™æˆåŠŸæ‹†å¼¹</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fc4:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fc9:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fcd:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
</code></pre></div></td></tr></table></div>
<p>å…ˆçœ‹ç¬¬ä¸€éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">f43:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                   </span><span class="c1"># å¼€è¾Ÿæ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f47:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span><span class="w">               </span><span class="c1"># %rcx = %rsp + 12</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f4c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">               </span><span class="c1"># %rdx = %rsp + 8</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f51:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">cf</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x4025cf</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># (gdb) x/s 0x4025cf: "%d %d", èµ‹å€¼ç»™ %esi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f56:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># %eax = 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f5b:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400bf0</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span><span class="w"> </span><span class="c1"># è°ƒç”¨æ ‡å‡†åº“å‡½æ•° sscanfï¼Œè¯»å–çš„å†…å®¹å‚è§ 0x4025cf</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f60:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># æ¯”è¾ƒ %eax ~ 1</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f63:</span><span class="w">   </span><span class="err">7</span><span class="nf">f</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jg</span><span class="w">     </span><span class="mh">400f6a</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x27</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æœ‰ç¬¦å· â€œå¤§äºâ€ æˆç«‹åˆ™è·³è¿‡å¼•çˆ†ä»£ç ï¼Œå¦åˆ™ BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f65:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f6a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="mi">07</span><span class="w">          </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x7</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">               </span><span class="c1"># æ¯”è¾ƒ (%rsp + 8) ~ 7</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f6f:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">3</span><span class="nf">c</span><span class="w">                   </span><span class="no">ja</span><span class="w">     </span><span class="mh">400fad</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x6a</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># æ— ç¬¦å· â€œå¤§äºâ€ æˆç«‹åˆ™è·³è½¬è‡³å¼•çˆ†ä»£ç ï¼Œå¦åˆ™ç»§ç»­å‘ä¸‹è¿è¡Œ</span>
</code></pre></div></td></tr></table></div>
<p><code>mov $0x4025cf,%esi</code>  è¿™ä¸€å¥å¯ä»¥çŸ¥é“éœ€è¦è¯»å–çš„æ˜¯ä¸¤ä¸ªæ•´æ•°</p>
<div class="admonition tip">
<p class="admonition-title">About <code>sscanf</code></p>
<p><code>sscanf</code> çš„å‡½æ•°åŸå‹ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•° <code>%rdi</code> æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ ¼å¼å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯ <code>0x4025cf</code> çš„å†…å®¹ï¼› <code>%rdx</code> ä¸ <code>%rcx</code> åˆ†åˆ«å­˜å‚¨ç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ªç»“æœçš„åœ°å€ï¼ˆä¹‹åçš„å‚æ•°ä¾æ¬¡ <code>r8</code> å’Œ <code>r9</code> å­˜å‚¨ï¼Œæ¥ç€ä¼šä½¿ç”¨æ ˆä¼ é€’ï¼‰</p>
<p>å› æ­¤ä¸¤ä¸ª <code>lea</code> è¯­å¥çœ‹ä¼¼æ²¡æœ‰ä½œç”¨ï¼Œå®åˆ™è¡¨ç¤ºäº†ä¸¤ä¸ªæ•´æ•°çš„åœ°å€</p>
</div>
<p><code>%eax</code> æ ¹æ®çº¦å®šè¢«è®¾å®šä¸º <code>sscanf</code> çš„è¿”å›å€¼ï¼Œ<code>400f60 ~ 400f65</code> çš„åˆ¤æ–­è·³è½¬è¯´æ˜ â€œå¦‚æœ <code>%eax</code> çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥çš„æ•´æ•°ä¸ªæ•°æ²¡è¾¾åˆ° 2 ä¸ªï¼Œç›´æ¥å¼•çˆ†ç‚¸å¼¹â€</p>
<p>æ¥ä¸‹æ¥ <code>cmpl $0x7,0x8(%rsp)</code> åŠå…¶åé¢çš„è·³è½¬è¡¨æ˜ï¼šç¬¬ä¸€ä¸ªæ•°ï¼ˆä¹Ÿå°±æ˜¯ <code>0x8(%rsp)</code> , ä¹Ÿå°±æ˜¯ <code>%rdx</code> çš„å¯¹åº”å€¼ï¼‰å¿…é¡» <code>&lt;= 7</code> ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸ï¼ˆå› ä¸ºæ˜¯æ— ç¬¦å·æ¯”è¾ƒï¼Œæ‰€ä»¥è´Ÿæ•°è¾“å…¥éƒ½ä¸æ­£ç¡®ï¼‰</p>
<p>æ€»ç»“ï¼šéœ€è¦è¾“å…¥ä¸¤ä¸ªæ•°ï¼›ç¬¬ä¸€ä¸ªæ•°ä¸èƒ½è¶…è¿‡ <code>7</code> </p>
<p>å†çœ‹ç¬¬äºŒéƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">f71:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">               </span><span class="c1"># %eax = %rsp + 8</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f75:</span><span class="w">   </span><span class="nf">ff</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">jmp</span><span class="w">    </span><span class="p">*</span><span class="mi">0x402470</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="w">           </span><span class="c1"># è¿™é‡Œæ˜¯é—´æ¥è·³è½¬ä¸­çš„è·³è½¬è¡¨è·³è½¬ï¼Œæ˜¯ switch è¯­å¥çš„å®ç°</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f7c:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">cf</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xcf</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># %eax = 207</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f81:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">3</span><span class="no">b</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f83:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">c3</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x2c3</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 707</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f88:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">34</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f8a:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x100</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 256</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f8f:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">2</span><span class="no">d</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f91:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x185</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 389</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f96:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">26</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f98:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">ce</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xce</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># %eax = 206</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f9d:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">f9f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">aa</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x2aa</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 682</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fa4:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">18</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fa6:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">47</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x147</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 327</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fab:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">11</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fad:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">88</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fb2:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># %eax = 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fb7:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400fbe</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x7b</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fb9:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">37</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x137</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %eax = 311</span>
</code></pre></div></td></tr></table></div>
<p>ç¬¬ä¸€æ­¥ <code>mov 0x8(%rsp),%eax</code> æŠŠç¬¬ä¸€ä¸ªè¾“å…¥çš„æ•°å­—å¤åˆ¶åˆ°äº† <code>%eax</code> </p>
<p>æ¥ä¸‹æ¥å…³é”®çš„ä¸€æ­¥ <code>jmp *0x402470(,%rax,8)</code> æ˜¯è·³è½¬è¡¨è·³è½¬ã€‚ä½¿ç”¨ <code>gdb x</code> æŸ¥çœ‹è·³è½¬è¡¨å†…å®¹</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x/8gx<span class="w"> </span>0x402470<span class="w">    </span><span class="c1"># ä»¥åŒå­—ä¸ºå•ä½ï¼Œæ˜¾ç¤º 8 ä¸ªè¿ç»­çš„åå…­è¿›åˆ¶æ•°å€¼ï¼ˆè€ƒè™‘åˆ° %rdx å€¼ &lt;= 7ï¼Œæ˜¾ç¤º 8 ä¸ªå€¼è¶³å¤Ÿï¼‰</span>
0x402470:<span class="w">   </span>0x0000000000400f7c<span class="w">  </span>0x0000000000400fb9
0x402480:<span class="w">   </span>0x0000000000400f83<span class="w">  </span>0x0000000000400f8a
0x402490:<span class="w">   </span>0x0000000000400f91<span class="w">  </span>0x0000000000400f98
0x4024a0:<span class="w">   </span>0x0000000000400f9f<span class="w">  </span>0x0000000000400fa6
</code></pre></div></td></tr></table></div>
<p><code>*0x402470(,%rax,8)</code> è¡¨ç¤ºå†…å­˜é—´æ¥å¯»å€ï¼Œå¯ä»¥ç†è§£ä¸ºä»¥ <code>0x402470</code> ä¸ºåŸºå€ï¼ŒåŠ ä¸Š <code>%rax</code> ä¸ª <code>64bit</code> çš„åç§»é‡ï¼Œæ¯”å¦‚ <code>%rax</code> ä¸º <code>1</code> æ—¶ï¼Œå°±è·³è½¬åˆ° <code>400fb9</code> </p>
<p>ä¸å¦¨å°±ä»¥è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—ä¸º <code>1</code> ä¸ºä¾‹ï¼Œæ­¤æ—¶ <code>%eax</code> è¢«èµ‹å€¼ä¸º <code>311</code> </p>
<p>æœ€åçœ‹ç¬¬ä¸‰éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">fbe:</span><span class="w">   </span><span class="err">3</span><span class="nf">b</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">               </span><span class="c1"># æ¯”è¾ƒ %eax ~ (%rsp + 12)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fc2:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400fc9</span> <span class="p">&lt;</span><span class="no">phase_3</span><span class="p">+</span><span class="mi">0x86</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># è‹¥ â€œç›¸ç­‰â€ æˆç«‹åˆ™æˆåŠŸæ‹†å¼¹</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fc4:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">        </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fc9:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fcd:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
</code></pre></div></td></tr></table></div>
<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼šå¦‚æœä¸Šä¸€éƒ¨åˆ†è®¾å®šçš„ <code>%eax</code> ä¸ç¬¬äºŒä¸ªè¾“å…¥ç›¸ç­‰å°±è§£é™¤ç‚¸å¼¹ï¼Œå¦åˆ™å¼•çˆ†ã€‚æ¯”å¦‚ <code>%rdx</code> å€¼ä¸º <code>1</code> æ—¶ï¼Œå¿…é¡»æœ‰ <code>%rcx</code> å€¼ä¸º <code>311</code> ã€‚ä¹Ÿå°±æ˜¯è¯´è·³è½¬è¡¨å†³å®šäº†å…±è®¡ 8 ä¸ª <code>%rdx</code> è¾“å…¥å¯¹åº”çš„å”¯ä¸€çš„ <code>%rcx</code> ï¼š</p>
<table>
<tr>
<td>%rdx</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
</tr>
<tr>
<td>%rcx</td>
<td>207</td>
<td>311</td>
<td>707</td>
<td>256</td>
<td>389</td>
<td>206</td>
<td>682</td>
<td>327</td>
</tr>
</table>
<p>åœ¨ä¸Šé¢çš„ç»„åˆä¸­éšæ„é€‰æ‹©ä¸€é¡¹ä½œä¸ºç­”æ¡ˆå°±å¯ä»¥æ‹†é™¤ç¬¬ä¸‰ä¸ªç‚¸å¼¹ï¼Œæ¯”å¦‚ <code>2 707</code> </p>
<h3 id="phase-4">Phase 4</h3>
<p>ï¼ˆå‡å°‘äº†æ³¨é‡Šé‡ï¼‰</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">000000000040100</span><span class="nf">c</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase_4</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">40100</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401010:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span>
<span class="w">  </span><span class="err">401015:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40101</span><span class="nl">a:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">cf</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x4025cf</span><span class="p">,</span><span class="nv">%esi</span>
<span class="w">  </span><span class="err">40101</span><span class="nl">f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401024:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">c7</span><span class="w"> </span><span class="no">fb</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400bf0</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401029:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">02</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x2</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40102</span><span class="nl">c:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401035</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40102</span><span class="nl">e:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="mi">0</span><span class="no">e</span><span class="w">          </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0xe</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>
<span class="w">  </span><span class="err">401033:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">40103a</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x2e</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401035:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">40103</span><span class="nl">a:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="mi">0</span><span class="no">e</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xe</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">40103</span><span class="nl">f:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%esi</span>
<span class="w">  </span><span class="err">401044:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">7</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%edi</span>
<span class="w">  </span><span class="err">401048:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">81</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400fce</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40104</span><span class="nl">d:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40104</span><span class="nl">f:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401058</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x4c</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401051:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>
<span class="w">  </span><span class="err">401056:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40105d</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x51</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401058:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">dd</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40105</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401061:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
</code></pre></div></td></tr></table></div>
<p>å…ˆçœ‹è¿™éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">40100</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401010:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span>
<span class="w">  </span><span class="err">401015:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40101</span><span class="nl">a:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">cf</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x4025cf</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># (gdb) x/s 0x4025cf: "%d %d", èµ‹å€¼ç»™ %esi</span>
<span class="w">  </span><span class="err">40101</span><span class="nl">f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401024:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">c7</span><span class="w"> </span><span class="no">fb</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400bf0</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401029:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">02</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x2</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40102</span><span class="nl">c:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401035</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40102</span><span class="nl">e:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="mi">0</span><span class="no">e</span><span class="w">          </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0xe</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span>
<span class="w">  </span><span class="err">401033:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">40103a</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x2e</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401035:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>è¿™ä¸€éƒ¨åˆ†å’Œä¸Šä¸€é˜¶æ®µå‡ ä¹ä¸€æ ·ï¼šè¯»å–ä¸¤ä¸ªæ•´æ•°ï¼›å¦‚æœè¾“å…¥çš„æ•´æ•°ä¸ªæ•°ä¸ä¸º <code>2</code> åˆ™çˆ†ç‚¸ï¼Œå¦åˆ™è®©ç¬¬ä¸€ä¸ªæ•°å­—ä¸ <code>14</code> æ¯”è¾ƒï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ•°å­— <code>&lt;= 14</code> åˆ™è·³è½¬è‡³ä¸‹ä¸€éƒ¨åˆ†ï¼ˆå› ä¸ºæ˜¯æ— ç¬¦å·æ¯”è¾ƒï¼Œæ‰€ä»¥è´Ÿæ•°è¾“å…¥éƒ½ä¸æ­£ç¡®ï¼‰ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸</p>
<p>äºæ˜¯æˆ‘ä»¬çŸ¥é“äº†ç­”æ¡ˆæ˜¯ä¸¤ä¸ªæ•°å­—ï¼Œå¹¶ä¸”ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯ä¸è¶…è¿‡ <code>14</code> çš„éè´Ÿæ•° </p>
<p>å†çœ‹å¦ä¸€éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">40103</span><span class="nl">a:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="mi">0</span><span class="no">e</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xe</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">40103</span><span class="nl">f:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%esi</span>
<span class="w">  </span><span class="err">401044:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">7</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%edi</span>
<span class="w">  </span><span class="err">401048:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">81</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400fce</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">&gt;</span><span class="w">           </span><span class="c1"># è°ƒç”¨ä¸€ä¸ªç¥ç§˜å‡½æ•°</span>
<span class="w">  </span><span class="err">40104</span><span class="nl">d:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># åªæœ‰è¿”å›å€¼ %eax == 0 æ—¶ä½¿ ZF ç½® 1ï¼Œå’Œä¸‹ä¸€æ¡æŒ‡ä»¤ç»“åˆä½¿ç”¨</span>
<span class="w">  </span><span class="err">40104</span><span class="nl">f:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401058</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x4c</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># ZF == 0 æ—¶è·³è½¬çˆ†ç‚¸ï¼Œä¹Ÿå°±æ˜¯è¯´ func4 çš„è¿”å›å€¼å¿…é¡»æ˜¯ 0</span>
<span class="w">  </span><span class="err">401051:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">           </span><span class="c1"># ç¬¬äºŒä¸ªæ•°ä¸ 0 æ¯”è¾ƒ</span>
<span class="w">  </span><span class="err">401056:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40105d</span> <span class="p">&lt;</span><span class="no">phase_4</span><span class="p">+</span><span class="mi">0x51</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># ç¬¬äºŒä¸ªæ•°å¦‚æœç­‰äº 0 ï¼Œåˆ™è§£é™¤ç‚¸å¼¹ï¼Œå¦åˆ™å¼•çˆ†</span>
<span class="w">  </span><span class="err">401058:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">dd</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40105</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401061:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">  </span>
</code></pre></div></td></tr></table></div>
<p>å°† <code>%esi</code> ä¸ <code>%edx</code> åˆ†åˆ«è®¾ç½®ä¸º <code>0</code> å’Œ <code>14</code>ï¼Œ<code>%edi</code> è®¾ç½®ä¸ºç¬¬ä¸€ä¸ªè¾“å…¥ï¼Œç„¶åè°ƒç”¨ <code>func4</code> å‡½æ•°ï¼Œå½“ä¸”ä»…å½“è¿”å›å€¼ä¸º <code>0</code> å¹¶ä¸”ç¬¬äºŒä¸ªè¾“å…¥çš„æ•°ä¸º <code>0</code> æ—¶è§£é™¤ç‚¸å¼¹</p>
<p>ç°åœ¨æ¥çœ‹ <code>func4</code> ï¼šï¼ˆ<code>%rdx</code> ä¸ <code>%rcx</code> åˆ†åˆ«å‚¨å­˜äº†ä¸¤ä¸ªè¾“å…¥çš„æ•°çš„åœ°å€è€Œä¸æ˜¯å€¼ï¼›<code>%edi</code> å‚¨å­˜äº†ç¬¬ä¸€ä¸ªæ•°çš„å€¼ï¼‰</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400</span><span class="nf">fce</span><span class="w"> </span><span class="err">&lt;</span><span class="no">func4</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fce:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                </span><span class="c1"># å¼€è¾Ÿäº†ä¸€ä¸ª int å¤§å°çš„æ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fd2:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">d0</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># %eax = %edx</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fd4:</span><span class="w">   </span><span class="err">29</span><span class="w"> </span><span class="nf">f0</span><span class="w">                   </span><span class="no">sub</span><span class="w">    </span><span class="nv">%esi</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># %eax -= %esi </span>
<span class="w">  </span><span class="err">400</span><span class="nl">fd6:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c1</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%ecx</span><span class="w">                </span><span class="c1"># %ecx = %eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fd8:</span><span class="w">   </span><span class="nf">c1</span><span class="w"> </span><span class="no">e9</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w">                </span><span class="no">shr</span><span class="w">    </span><span class="no">$0x1f</span><span class="p">,</span><span class="nv">%ecx</span><span class="w">               </span><span class="c1"># %ecx é€»è¾‘å³ç§» 31 ä½ï¼Œä¹Ÿå°±æ˜¯å–ç¬¦å·ä½</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fdb:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c8</span><span class="w">                   </span><span class="no">add</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># %eax += %ecx</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fdd:</span><span class="w">   </span><span class="nf">d1</span><span class="w"> </span><span class="no">f8</span><span class="w">                   </span><span class="no">sar</span><span class="w">    </span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># %eax ç®—æœ¯å³ç§» 1 ä½ï¼Œä¹Ÿå°±æ˜¯ %eax // 2</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fdf:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">30</span><span class="w">                </span><span class="no">lea</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rsi</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span><span class="w">       </span><span class="c1"># %ecx = %rax + %rsi ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>

<span class="w">  </span><span class="err">400</span><span class="nl">fe2:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">f9</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,</span><span class="nv">%ecx</span><span class="w">                </span><span class="c1"># æ¯”è¾ƒ %ecx ~ %edi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fe4:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">400ff2</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">+</span><span class="mi">0x24</span><span class="p">&gt;</span><span class="w">      </span><span class="c1"># å¦‚æœ &lt;= æˆç«‹å°±è·³è½¬è‡³ 400ff2ï¼Œå¦åˆ™ç»§ç»­</span>
<span class="w">  </span><span class="c1"># åœ¨ %ecx &gt; %edi ï¼ˆå€¼æ¯”è¾ƒï¼‰æƒ…å†µä¸‹</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fe6:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">51</span><span class="w"> </span><span class="no">ff</span><span class="w">                </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x1</span><span class="p">(</span><span class="nv">%rcx</span><span class="p">),</span><span class="nv">%edx</span><span class="w">          </span><span class="c1"># %edx = %rcx - 1ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fe9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">e0</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400fce</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">&gt;</span><span class="w">           </span><span class="c1"># é€’å½’è°ƒç”¨è‡ªèº«ï¼</span>
<span class="w">  </span><span class="err">400</span><span class="nl">fee:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">add</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># %eax *= 2ï¼Œä¹Ÿå°±æ˜¯è¿”å›å€¼ä¹˜ä»¥ 2</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ff0:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">15</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401007</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">+</span><span class="mi">0x39</span><span class="p">&gt;</span><span class="w">      </span><span class="c1"># è·³è½¬ç»“æŸå‡½æ•°è°ƒç”¨</span>
<span class="w">  </span><span class="c1"># åœ¨ %ecx &lt;= %edi æƒ…å†µä¸‹ï¼š</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ff2:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># %eax = 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ff7:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">f9</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,</span><span class="nv">%ecx</span><span class="w">                </span><span class="c1"># æ¯”è¾ƒ %ecx ~ %edi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ff9:</span><span class="w">   </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">                   </span><span class="no">jge</span><span class="w">    </span><span class="mh">401007</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">+</span><span class="mi">0x39</span><span class="p">&gt;</span><span class="w">      </span><span class="c1"># å¦‚æœ &gt;= æˆç«‹è·³è½¬ç»“æŸå‡½æ•°è°ƒç”¨</span>
<span class="w">  </span><span class="c1"># åœ¨ %ecx &lt; %edi æƒ…å†µä¸‹ï¼š</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ffb:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rcx</span><span class="p">),</span><span class="nv">%esi</span><span class="w">           </span><span class="c1"># %esi = %rcx + 1ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ffe:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">cb</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400fce</span> <span class="p">&lt;</span><span class="no">func4</span><span class="p">&gt;</span><span class="w">           </span><span class="c1"># é€’å½’è°ƒç”¨è‡ªèº«ï¼</span>
<span class="w">  </span><span class="err">401003:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%eax</span><span class="w">    </span><span class="c1"># %eax = 2 * %rax + 1 ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">401007:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                </span><span class="c1"># é‡Šæ”¾æ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">40100</span><span class="nl">b:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">                             </span><span class="c1"># é€€å‡ºå‡½æ•°ï¼Œè¿”å›å€¼æ˜¯ %eax</span>
</code></pre></div></td></tr></table></div>
<p>è¿™æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œæˆ‘ä»¬å°è¯•ç”¨ C è¯­è¨€å»æè¿°ä¸Šé¢çš„è¡Œä¸ºï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// scanf("%d %d",&amp;x,&amp;y); </span>
<span class="c1">// å‰é¢çš„ä¸€äº›æ“ä½œå¯ä»¥ç†è§£ä¸º edx = &amp;x; ecx = &amp;y; edi = x;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">func4</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">esi</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">edx</span><span class="p">){</span><span class="w">                               </span><span class="c1">// æ›´åŠ æ˜“è¯»çš„ï¼šfunc4(int target, int left, int right)</span>
<span class="w">    </span><span class="n">eax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">edi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">esi</span><span class="p">;</span><span class="w"> </span><span class="n">ecx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eax</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ecx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">eax</span><span class="o">++</span><span class="p">;</span><span class="w">                                              </span><span class="c1">// åŸä»£ç æ˜¯é€šè¿‡è·å–ç¬¦å·ä½çš„æ–¹å¼è¿›è¡Œè´Ÿæ•°çš„äºŒåˆ†ä¸­ç‚¹å€¼è°ƒæ•´</span>
<span class="w">    </span><span class="n">ecx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">eax</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">esi</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// åˆ°è¿™é‡Œçš„æ“ä½œå¯ä»¥æ€»ç»“æˆï¼šmid = l + (r - l) // 2ï¼Œä¹Ÿå°±æ˜¯äºŒåˆ†æŸ¥æ‰¾è®¡ç®—ä¸­ç‚¹å€¼ </span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">ecx</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">edi</span><span class="p">){</span><span class="w">                                                 </span><span class="c1">// 400fe4: jle 400ff2 &lt;func4+0x24&gt;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ecx</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">edi</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                                   </span><span class="c1">// 400ff9: jge 401007 &lt;func4+0x39&gt;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">func4</span><span class="p">(</span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">edx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">func4</span><span class="p">(</span><span class="n">edi</span><span class="p">,</span><span class="w"> </span><span class="n">esi</span><span class="p">,</span><span class="w"> </span><span class="n">ecx</span><span class="mi">-1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ä¸€ä¸ªå…¸å‹çš„äºŒåˆ†æŸ¥æ‰¾ï¼Œåªæœ‰æ‰¾åˆ°è¿™ä¸ªç›®æ ‡å€¼ <code>edi = x</code> æ‰ä¼šè¿”å› <code>0</code> å€¼ï¼ˆå¦å¤–é‚£ä¸ªè´Ÿæ•°åç§»è°ƒæ•´æ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºè¾“å…¥çš„æ•´æ•°å·²ç»é™åˆ¶ä¸ºäº†éè´Ÿæ•°ï¼‰</p>
<p>æ‰€ä»¥æˆ‘çš„ç¬¬ä¸€ä¸ªè¾“å…¥å¿…é¡»å¯ä»¥ç›´æ¥åœ¨äºŒåˆ†æŸ¥æ‰¾çš„æ—¶å€™è¢«ç²¾å‡†å®šä½ï¼š</p>
<p><code>14 // 2 = 7</code> <code>7 // 2 = 3</code> <code>3 // 2 = 1</code> <code>1 // 2 = 0</code> è¿™å››æ¬¡äºŒåˆ†æŸ¥æ‰¾æ—¶å‡ºç°çš„ä¸­é—´å€¼ <code>mid</code> å°±æ˜¯æ‰€æœ‰æˆç«‹çš„ç¬¬ä¸€ä¸ªè¾“å…¥</p>
<p>ä¹Ÿå°±æ˜¯è¯´ <code>7 0</code> <code>3 0</code> <code>1 0</code> <code>0 0</code> éƒ½æ˜¯æ­£ç¡®ç­”æ¡ˆ</p>
<h3 id="phase-5">Phase 5</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000401062</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">phase_5</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Part 1</span>
<span class="w">  </span><span class="err">401062:</span><span class="w">   </span><span class="err">53</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">401063:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401067:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">fb</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,</span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">40106</span><span class="nl">a:</span><span class="w">   </span><span class="err">64</span><span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%fs</span><span class="p">:</span><span class="mi">0x28</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">401071:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">401073:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">44</span><span class="w"> </span><span class="err">24</span><span class="w"> </span><span class="err">18</span><span class="w">          </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">          </span><span class="c1"># å°† %rax çš„å€¼å­˜å…¥æ ˆåœ°å€ %rsp + 24 å¤„</span>
<span class="w">  </span><span class="err">401078:</span><span class="w">   </span><span class="err">31</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">xor</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># åˆ©ç”¨å¼‚æˆ–æ“ä½œæ¸…é›¶ %eax</span>
<span class="w">  </span><span class="err">40107</span><span class="nl">a:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">9</span><span class="no">c</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40131b</span> <span class="p">&lt;</span><span class="no">string_length</span><span class="p">&gt;</span><span class="w">   </span><span class="c1"># è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</span>
<span class="w">  </span><span class="err">40107</span><span class="nl">f:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">06</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># è¿”å›å€¼ä¸ 6 æ¯”è¾ƒ</span>
<span class="w">  </span><span class="err">401082:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">4</span><span class="nf">e</span><span class="w">                   </span><span class="no">je</span><span class="w">     </span><span class="mh">4010d2</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x70</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># å¦‚æœç›¸ç­‰åˆ™è·³è½¬ï¼Œå¦åˆ™çˆ†ç‚¸</span>
<span class="w">  </span><span class="err">401084:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">b1</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># BOOM! </span>
<span class="w">  </span><span class="err">401089:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">47</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4010d2</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x70</span><span class="p">&gt;</span>
<span class="w">  </span><span class="c1"># Part 2</span>
<span class="w">  </span><span class="err">40108</span><span class="nl">b:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">03</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span><span class="w">       </span><span class="c1"># %ecx = ((%rbx + %rax å¤„çš„ 1byte å€¼) é›¶æ‰©å±•è‡³ 32 ä½)</span>
<span class="w">  </span><span class="err">40108</span><span class="nl">f:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">0</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%cl</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">               </span><span class="c1"># %rcx çš„ä½å…«ä½ å­˜å…¥ %rsp æŒ‡å‘çš„åœ°å€</span>
<span class="w">  </span><span class="err">401092:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">24</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">              </span><span class="c1"># %rsp åœ°å€å¤„çš„å†…å®¹ä¼ å…¥ %rdx</span>
<span class="w">  </span><span class="err">401096:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e2</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w">                </span><span class="no">and</span><span class="w">    </span><span class="no">$0xf</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                </span><span class="c1"># %edx ä¸ 0b1111 æŒ‰ä½ä¸ï¼Œç»“æœå­˜å…¥ %edxï¼ˆä¹Ÿå°±æ˜¯ä¿ç•™ä½å››ä½å€¼ï¼‰</span>
<span class="w">  </span><span class="err">401099:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">92</span><span class="w"> </span><span class="no">b0</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x4024b0</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%edx</span><span class="w">      </span><span class="c1"># %edx = ((0x4024b0 + %rdx å¤„çš„ 1byte å€¼) é›¶æ‰©å±•è‡³ 32 ä½)</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a0:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">54</span><span class="w"> </span><span class="err">04</span><span class="w"> </span><span class="err">10</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%dl</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">    </span><span class="c1"># %rdx çš„ä½å…«ä½ å­˜å…¥åœ°å€ %rsp + %rax + 0x10 å¤„</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                </span><span class="c1"># %rax++</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">06</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                </span><span class="c1"># %rax ä¸ 6 æ¯”è¾ƒ</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">ac:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">dd</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">40108b</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># å¦‚æœä¸ç›¸ç­‰ï¼Œå›åˆ° 40108b</span>
<span class="w">  </span><span class="c1"># Part 3</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">ae:</span><span class="w">   </span><span class="nf">c6</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">movb</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,</span><span class="mi">0x16</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">          </span><span class="c1"># *(%rsp+22) = 0x00ï¼Œæ›´ç›´è§‚çš„æ¥è¯´ï¼šrsp[22] = 0;</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">b3:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">5</span><span class="no">e</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x40245e</span><span class="p">,</span><span class="nv">%esi</span><span class="w">           </span><span class="c1"># (gdb) x/s 0x40245e: "flyers"</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">b8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">7</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">10</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdi</span><span class="w">          </span><span class="c1"># %rdi = %rsp + 16ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">bd:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">76</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401338</span> <span class="p">&lt;</span><span class="no">strings_not_equal</span><span class="p">&gt;</span><span class="w">   </span><span class="c1"># æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸² %rdi ä¸ %rsi æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› 1</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">c2:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># è¿™ä¸€éƒ¨åˆ†å’Œ Phase 1 ç›¸åŒçš„æ“ä½œ</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">c4:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">13</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4010d9</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x77</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰æ‰ä¼šè·³è½¬ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">c6:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">6</span><span class="no">f</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">cb:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">nopl</span><span class="w">   </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="c1"># 5 å­—èŠ‚é•¿åº¦çš„ NOP æ“ä½œ</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d0:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">07</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4010d9</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x77</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># è·³è½¬</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d2:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ä¸¤è¡Œæœ‰ä»€ä¹ˆç”¨</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d7:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">b2</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">40108b</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># 0_0</span>
<span class="w">  </span><span class="c1"># Part 4</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d9:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">de:</span><span class="w">   </span><span class="err">64</span><span class="w"> </span><span class="err">48</span><span class="w"> </span><span class="err">33</span><span class="w"> </span><span class="err">04</span><span class="w"> </span><span class="err">25</span><span class="w"> </span><span class="err">28</span><span class="w"> </span><span class="err">00</span><span class="w">    </span><span class="nf">xor</span><span class="w">    </span><span class="nv">%fs</span><span class="p">:</span><span class="mi">0x28</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">e5:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">4010</span><span class="nl">e7:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4010ee</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x8c</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">e9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="no">fa</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400b30</span> <span class="p">&lt;</span><span class="no">__stack_chk_fail@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">ee:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f2:</span><span class="w">   </span><span class="err">5</span><span class="nf">b</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f3:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
</code></pre></div></td></tr></table></div>
<p>ç¨‹åºä¸­æœ‰ä¸¤å¤„ <code>00 00</code> æœ‰åˆ†éš”ä½œç”¨ï¼Œåªè¦è€ƒè™‘ <code>401073 ~ 4010de</code> çš„å†…å®¹å³å¯ï¼Œå…¶ä»–çš„éƒ¨åˆ†æ˜¯ Canary æ ˆä¿æŠ¤æœºåˆ¶çš„ä½“ç°ï¼Œé˜²æ”»å‡»ç”¨çš„ï¼Œæ— éœ€æ·±æŒ–</p>
<p>å…ˆçœ‹è¿™ä¸€éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 1</span>
<span class="w">  </span><span class="err">401073:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">44</span><span class="w"> </span><span class="err">24</span><span class="w"> </span><span class="err">18</span><span class="w">          </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">          </span><span class="c1"># å°† %rax çš„å€¼å­˜å…¥æ ˆåœ°å€ %rsp + 24 å¤„</span>
<span class="w">  </span><span class="err">401078:</span><span class="w">   </span><span class="err">31</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">xor</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># åˆ©ç”¨å¼‚æˆ–æ“ä½œæ¸…é›¶ %eax</span>
<span class="w">  </span><span class="err">40107</span><span class="nl">a:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">9</span><span class="no">c</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40131b</span> <span class="p">&lt;</span><span class="no">string_length</span><span class="p">&gt;</span><span class="w">   </span><span class="c1"># è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</span>
<span class="w">  </span><span class="err">40107</span><span class="nl">f:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">06</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># è¿”å›å€¼ä¸ 6 æ¯”è¾ƒ</span>
<span class="w">  </span><span class="err">401082:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">4</span><span class="nf">e</span><span class="w">                   </span><span class="no">je</span><span class="w">     </span><span class="mh">4010d2</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x70</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># å¦‚æœç›¸ç­‰åˆ™è·³è½¬ï¼Œå¦åˆ™çˆ†ç‚¸</span>
<span class="w">  </span><span class="err">401084:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">b1</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># BOOM! </span>
<span class="w">  </span><span class="err">401089:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">47</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4010d2</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x70</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>è¦æ±‚æ˜¯è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º <code>6</code> çš„å­—ç¬¦ä¸²ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸</p>
<p>æ¥ä¸‹æ¥çš„ä¸€æ®µå¯èƒ½ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆå¾€åçœ‹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 3</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">ae:</span><span class="w">   </span><span class="nf">c6</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">movb</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,</span><span class="mi">0x16</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">          </span><span class="c1"># *(%rsp+22) = 0x00ï¼Œæ›´ç›´è§‚çš„æ¥è¯´ï¼šrsp[22] = 0;</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">b3:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">5</span><span class="no">e</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x40245e</span><span class="p">,</span><span class="nv">%esi</span><span class="w">           </span><span class="c1"># (gdb) x/s 0x40245e: "flyers"</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">b8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">7</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">10</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdi</span><span class="w">          </span><span class="c1"># %rdi = %rsp + 16ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">bd:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">76</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401338</span> <span class="p">&lt;</span><span class="no">strings_not_equal</span><span class="p">&gt;</span><span class="w">   </span><span class="c1"># æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸² %rdi ä¸ %rsi æ˜¯å¦ä¸ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› 1</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">c2:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># è¿™ä¸€éƒ¨åˆ†å’Œ Phase 1 ç›¸åŒçš„æ“ä½œ</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">c4:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">13</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4010d9</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x77</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰æ‰ä¼šè·³è½¬ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">c6:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">6</span><span class="no">f</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># BOOM!</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">cb:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">nopl</span><span class="w">   </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="c1"># 5 å­—èŠ‚é•¿åº¦çš„ NOP æ“ä½œ</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d0:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">07</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4010d9</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x77</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># è·³è½¬</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d2:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ä¸¤è¡Œæœ‰ä»€ä¹ˆç”¨</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">d7:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">b2</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">40108b</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># 0_0</span>
</code></pre></div></td></tr></table></div>
<p>æœ‰äº† Phase 1 çš„ç»éªŒæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™éƒ¨åˆ†ä»£ç æ˜¯å°† <code>%rdi</code> è®¾ç½®ä¸ºè¾“å…¥çš„å…­ä½å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼ˆ<code>4010b8</code>ï¼Œç»“åˆå‰é¢çš„ <code>movb</code> æŒ‡ä»¤å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼‰ï¼Œä¸ºå­—ç¬¦ä¸²æ·»åŠ ä¸€ä¸ª <code>\0</code> ï¼ˆ<code>4010ae</code>ï¼‰ï¼Œç„¶åå°†è¿™ä¸ªå­—ç¬¦ä¸²å’Œ <code>0x40245e</code> å­˜å‚¨çš„å­—ç¬¦ä¸² <code>flyers</code> è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒåˆ™æ‹†å¼¹æˆåŠŸã€‚ä¼¼ä¹å’Œ Phase 1 æ²¡æœ‰åŒºåˆ«</p>
<p>å›å¤´çœ‹ä¹‹å‰çš„éƒ¨åˆ†ï¼Œè¿™ä¸€éƒ¨åˆ†å¤§æ¦‚ç‡ä¼šå¯¹åŸå§‹è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹ï¼ˆå¦åˆ™å°±å’Œ Phase 1 ä¸€æ¨¡ä¸€æ ·äº†ï¼‰</p>
<p>ï¼ˆæ³¨é‡Šéƒ¨åˆ†è¿›è¡Œäº†æ›´åŠ æ˜æ˜¾çš„ä¿®æ”¹ï¼Œæ²¡é”™æˆ‘ç”¨ AI ä¿®æ­£äº†ä¸€ä¸‹ï¼‰</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 2</span>
<span class="w">  </span><span class="err">40108</span><span class="nl">b:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">03</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span><span class="w">       </span><span class="c1"># ä» %rbx + %rax åœ°å€è¯»å– 1byteï¼Œé›¶æ‰©å±•è‡³ 32 ä½å­˜å…¥ %ecx</span>
<span class="w">  </span><span class="err">40108</span><span class="nl">f:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">0</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%cl</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">               </span><span class="c1"># å°† %clï¼ˆ%ecx çš„ä½ 8 ä½ï¼‰å­˜å…¥æ ˆé¡¶ %rsp</span>
<span class="w">  </span><span class="err">401092:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">24</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">              </span><span class="c1"># ä»æ ˆé¡¶ %rsp è¯»å– 8byte åˆ° %rdxï¼Œå®é™…åªç”¨åˆ°ä½ 1byte</span>
<span class="w">  </span><span class="err">401096:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e2</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w">                </span><span class="no">and</span><span class="w">    </span><span class="no">$0xf</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                </span><span class="c1"># ä¿ç•™ %edx çš„ä½ 4 ä½ï¼Œå…¶ä½™æ¸…é›¶</span>
<span class="w">  </span><span class="err">401099:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">92</span><span class="w"> </span><span class="no">b0</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x4024b0</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%edx</span><span class="w">      </span><span class="c1"># ä»åœ°å€ 0x4024b0 + %rdx è¯»å– 1byteï¼Œé›¶æ‰©å±•è‡³ 32 ä½</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a0:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">54</span><span class="w"> </span><span class="err">04</span><span class="w"> </span><span class="err">10</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%dl</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">    </span><span class="c1"># å°† %dlï¼ˆ%edx çš„ä½ 8 ä½ï¼‰å­˜å…¥ %rsp + %rax + 16</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                </span><span class="c1"># %rax += 1ï¼ˆå¾ªç¯è®¡æ•°å™¨é€’å¢ï¼‰</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">06</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                </span><span class="c1"># æ¯”è¾ƒ %rax ~ 6ï¼ˆæ£€æŸ¥æ˜¯å¦å¾ªç¯ 6 æ¬¡ï¼‰</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">ac:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">dd</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">40108b</span> <span class="p">&lt;</span><span class="no">phase_5</span><span class="p">+</span><span class="mi">0x29</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># è‹¥æœªå®Œæˆ 6 æ¬¡å¾ªç¯ï¼Œè·³å› 40108b</span>
</code></pre></div></td></tr></table></div>
<p>æœ€åä¸‰è¡Œå¯ä»¥çœ‹å¾—å‡ºæ¥è¿™éƒ¨åˆ†å†…å®¹è¿›è¡Œäº† 6 æ¬¡å¾ªç¯æ“ä½œï¼Œå¯¹åº”äº†é•¿åº¦ä¸º 6 çš„è¾“å…¥å­—ç¬¦ä¸²ï¼Œå¤§æ¦‚ç‡æ˜¯å¯¹æ¯ä¸€ä¸ªå­—ç¬¦è¿›è¡Œäº†æŸç§æ˜ å°„å˜æ¢</p>
<p>ä¸å¦¨çœ‹ä¸€çœ‹ <code>0x4024b0</code> å¤„å­˜å‚¨äº†ä»€ä¹ˆå†…å®¹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>x<span class="w"> </span>0x4024b0
0x4024b0<span class="w"> </span>&lt;array.3449&gt;:<span class="w">  </span><span class="s2">"maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?"</span>
</code></pre></div></td></tr></table></div>
<p>åé¢é‚£ä¸€ä¸²åº”è¯¥ä¸ç”¨ç®¡ï¼Œå…³é”®æ˜¯å‰é¢çš„ <code>maduiersnfotvbyl</code> ï¼Œè¿™æ ·ä¸€ä¸²æ— åºçš„å­—ç¬¦ä¸²å¾ˆåƒæ˜¯ä¸€ç§æ˜ å°„è¡¨ï¼ˆ<code>flyers</code> è¿™å‡ ä¸ªå­—æ¯åœ¨è¿™é‡Œéƒ½èƒ½æ‰¾åˆ°ï¼‰</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­£ç¡®çš„è¾“å…¥ï¼ˆå…­ä½å­—ç¬¦ä¸²ï¼‰åœ¨ç»è¿‡æ˜ å°„ä¹‹åä¼šè½¬åŒ–ä¸º <code>flyers</code> ï¼Œæˆ–è®¸ä¼šæœ‰ä¸€ç§å¾ˆç®€å•çš„å‡è®¾ï¼š</p>
<table>
<thead>
<tr>
<th>input</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
<th>e</th>
<th>f</th>
<th>g</th>
<th>h</th>
<th>i</th>
<th>j</th>
<th>k</th>
<th>l</th>
<th>m</th>
<th>n</th>
<th>o</th>
<th>p</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>(wrong)</strong> output</td>
<td>m</td>
<td>a</td>
<td>d</td>
<td>u</td>
<td>i</td>
<td>e</td>
<td>r</td>
<td>s</td>
<td>n</td>
<td>f</td>
<td>o</td>
<td>t</td>
<td>v</td>
<td>b</td>
<td>y</td>
<td>l</td>
</tr>
</tbody>
</table>
<p>å½“ç„¶äº‹å®ä¸æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å‘ç°ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">40108</span><span class="nl">b:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">03</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span><span class="w">       </span><span class="c1"># ä» %rbx + %rax åœ°å€è¯»å– 1byteï¼Œé›¶æ‰©å±•è‡³ 32 ä½å­˜å…¥ %ecx</span>
<span class="w">  </span><span class="err">40108</span><span class="nl">f:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">0</span><span class="nf">c</span><span class="w"> </span><span class="mi">24</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%cl</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">               </span><span class="c1"># å°† %clï¼ˆ%ecx çš„ä½ 8 ä½ï¼‰å­˜å…¥æ ˆé¡¶ %rsp</span>
<span class="w">  </span><span class="err">401092:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">24</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">              </span><span class="c1"># ä»æ ˆé¡¶ %rsp è¯»å– 8byte åˆ° %rdxï¼Œå®é™…åªç”¨åˆ°ä½ 1byte</span>
<span class="w">  </span><span class="err">401096:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e2</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w">                </span><span class="no">and</span><span class="w">    </span><span class="no">$0xf</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                </span><span class="c1"># ä¿ç•™ %edx çš„ä½ 4 ä½ï¼Œå…¶ä½™æ¸…é›¶</span>
</code></pre></div></td></tr></table></div>
<p>æ¯ä¸ªå­—ç¬¦ï¼ˆä½œä¸º ASCII å½¢å¼ï¼‰æœ€ç»ˆä»…ä»…è¯»å–äº†æœ€ä½çš„å››ä½ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰æœ€åå››ä½æ˜¯æœ‰ç”¨çš„</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">401099:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">92</span><span class="w"> </span><span class="no">b0</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x4024b0</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%edx</span><span class="w">      </span><span class="c1"># ä»åœ°å€ 0x4024b0 + %rdx è¯»å– 1byteï¼Œé›¶æ‰©å±•è‡³ 32 ä½</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">a0:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">54</span><span class="w"> </span><span class="err">04</span><span class="w"> </span><span class="err">10</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%dl</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">    </span><span class="c1"># å°† %dlï¼ˆ%edx çš„ä½ 8 ä½ï¼‰å­˜å…¥ %rsp + %rax + 16</span>
</code></pre></div></td></tr></table></div>
<p>æ¥ä¸‹æ¥è¿™å››ä½äºŒè¿›åˆ¶å†…å®¹ <code>%rdx</code> ä½œä¸ºåç§»å€¼åŠ åœ¨äº† <code>0x402400</code> çš„åœ°å€å¤„ï¼Œæ–°çš„ <code>%rdx</code> åˆè¢«è½¬ç§»åˆ°äº† <code>%rsp + %rax + 16</code> ï¼ˆè¿™ä¸ªä½ç½®åœ¨ä¹‹åç”¨äºæ£€éªŒå­—ç¬¦ä¸²ç›¸ç­‰ï¼‰</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼šå­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦å¯¹åº”çš„ ASCII å€¼çš„æœ€ä½å››ä½ä½œä¸ºç´¢å¼• <code>%edx</code> æ˜ å°„ <code>maduiersnfotvbyl</code> ï¼ˆæ°å¥½æ˜¯ 16 ä½ï¼‰çš„å†…å®¹</p>
<table>
<thead>
<tr>
<th>input</th>
<th>0000</th>
<th>0001</th>
<th>0010</th>
<th>0011</th>
<th>0100</th>
<th>0101</th>
<th>0110</th>
<th>0111</th>
<th>1000</th>
<th>1001</th>
<th>1010</th>
<th>1011</th>
<th>1100</th>
<th>1101</th>
<th>1110</th>
<th>1111</th>
</tr>
</thead>
<tbody>
<tr>
<td>output</td>
<td>m</td>
<td>a</td>
<td>d</td>
<td>u</td>
<td>i</td>
<td>e</td>
<td>r</td>
<td>s</td>
<td>n</td>
<td>f</td>
<td>o</td>
<td>t</td>
<td>v</td>
<td>b</td>
<td>y</td>
<td>l</td>
</tr>
</tbody>
</table>
<p>æ‰€ä»¥æ­£ç¡®ç­”æ¡ˆçš„å…­ä¸ªå­—ç¬¦çš„ ASCII ç ä½å››ä½åº”è¯¥ä¾æ¬¡ä¸º <code>1001</code> <code>1111</code> <code>1110</code> <code>0101</code> <code>0110</code> <code>0111</code> ï¼Œæ¯”å¦‚ <code>ionefg</code> <code>yonuvw</code> </p>
<h3 id="phase-6">Phase 6</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">00000000004010</span><span class="nf">f4</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase_6</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Part 1</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f4:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">56</span><span class="w">                   </span><span class="nf">push</span><span class="w">   </span><span class="nv">%r14</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f6:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">55</span><span class="w">                   </span><span class="nf">push</span><span class="w">   </span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f8:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">54</span><span class="w">                   </span><span class="nf">push</span><span class="w">   </span><span class="nv">%r12</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">fa:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">fb:</span><span class="w">   </span><span class="err">53</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">fc:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x50</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401100:</span><span class="w">   </span><span class="err">49</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">401103:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401106:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">51</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40145c</span> <span class="p">&lt;</span><span class="no">read_six_numbers</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40110</span><span class="nl">b:</span><span class="w">   </span><span class="err">49</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%r14</span>
<span class="w">  </span><span class="err">40110</span><span class="nl">e:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="nf">bc</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">       </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%r12d</span>
<span class="w">  </span><span class="c1"># Part 2</span>
<span class="w">  </span><span class="err">401114:</span><span class="w">   </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="no">ed</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r13</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">401117:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="mi">00</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%r13</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40111</span><span class="nl">b:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e8</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40111</span><span class="nl">e:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401121:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">401128</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401123:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401128:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%r12d</span>
<span class="w">  </span><span class="err">40112</span><span class="nl">c:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">fc</span><span class="w"> </span><span class="mi">06</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%r12d</span>
<span class="w">  </span><span class="err">401130:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">21</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">401153</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x5f</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401132:</span><span class="w">   </span><span class="err">44</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e3</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r12d</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="w">  </span><span class="err">401135:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">c3</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%ebx</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">401138:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">84</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40113</span><span class="nl">b:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="err">00</span><span class="w">                </span><span class="nf">cmp</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">40113</span><span class="nl">e:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401145</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x51</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401140:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">f5</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401145:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c3</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="w">  </span><span class="err">401148:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">fb</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="w">  </span><span class="err">40114</span><span class="nl">b:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="no">e8</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">401135</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x41</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40114</span><span class="nl">d:</span><span class="w">   </span><span class="err">49</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c5</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">401151:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">c1</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401114</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x20</span><span class="p">&gt;</span>
<span class="w">  </span><span class="c1"># Part 3</span>
<span class="w">  </span><span class="err">401153:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401158:</span><span class="w">   </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="no">f0</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r14</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40115</span><span class="nl">b:</span><span class="w">   </span><span class="nf">b9</span><span class="w"> </span><span class="mi">07</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x7</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">401160:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">ca</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401162:</span><span class="w">   </span><span class="err">2</span><span class="nf">b</span><span class="w"> </span><span class="mi">10</span><span class="w">                   </span><span class="no">sub</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401164:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">10</span><span class="w">                   </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,(</span><span class="nv">%rax</span><span class="p">)</span>
<span class="w">  </span><span class="err">401166:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40116</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">39</span><span class="w"> </span><span class="nf">f0</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40116</span><span class="nl">d:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">f1</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">401160</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x6c</span><span class="p">&gt;</span>
<span class="w">  </span><span class="c1"># Part 4</span>
<span class="w">  </span><span class="err">40116</span><span class="nl">f:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%esi</span>
<span class="w">  </span><span class="err">401174:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">21</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401197</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xa3</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401176:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">52</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40117</span><span class="nl">a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40117</span><span class="nl">d:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">c8</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40117</span><span class="nl">f:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">f5</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">401176</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x82</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401181:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401188</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401183:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6032d0</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401188:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">54</span><span class="w"> </span><span class="err">74</span><span class="w"> </span><span class="err">20</span><span class="w">          </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x20</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">  </span><span class="err">40118</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c6</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401191:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">fe</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401195:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">14</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4011ab</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xb7</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401197:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">34</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">40119</span><span class="nl">a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f9</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">40119</span><span class="nl">d:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="no">e4</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">401183</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x8f</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40119</span><span class="nl">f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">a4:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6032d0</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">a9:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">cb</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401176</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x82</span><span class="p">&gt;</span>
<span class="w">  </span><span class="c1"># Part 5</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ab:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">5</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">20</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x20</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">b0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">28</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x28</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">b5:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">50</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x50</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ba:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d9</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rcx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">bd:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">10</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">c0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">51</span><span class="w"> </span><span class="err">08</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rcx</span><span class="p">)</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">c4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">c8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">39</span><span class="w"> </span><span class="nf">f0</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">cb:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4011d2</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xde</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">cd:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d1</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rcx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">d0:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">eb</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4011bd</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xc9</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">d2:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c7</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">)</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">d9:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="c1"># Part 6</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">da:</span><span class="w">   </span><span class="nf">bd</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%ebp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">df:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e3:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">00</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e5:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="err">03</span><span class="w">                   </span><span class="nf">cmp</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,(</span><span class="nv">%rbx</span><span class="p">)</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e7:</span><span class="w">   </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jge</span><span class="w">    </span><span class="mh">4011ee</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xfa</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ee:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">5</span><span class="no">b</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">f2:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">ed</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%ebp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">f5:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">e8</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">4011df</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xeb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="c1"># Part 7</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">f7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x50</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">fb:</span><span class="w">   </span><span class="err">5</span><span class="nf">b</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">fc:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">fd:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">5</span><span class="nf">c</span><span class="w">                   </span><span class="no">pop</span><span class="w">    </span><span class="nv">%r12</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ff:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">5</span><span class="nf">d</span><span class="w">                   </span><span class="no">pop</span><span class="w">    </span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">401201:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">5</span><span class="nf">e</span><span class="w">                   </span><span class="no">pop</span><span class="w">    </span><span class="nv">%r14</span>
<span class="w">  </span><span class="err">401203:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>å¤ªé•¿äº†ï¼Œæˆ‘ä»¬ä¸€ç‚¹ä¸€ç‚¹çš„åˆ†æï¼š</p>
<div class="admonition tip">
<p class="admonition-title">ä¸€äº›å¯¹è¾ƒé•¿çš„åŸç¨‹åºçš„é˜¶æ®µåˆ’åˆ†æ–¹æ³•</p>
<p><code>call &lt;explode_bomb&gt;</code> å¯ä»¥å¸®åŠ©æ‹†åˆ†ä¸€ä¸ªç¨‹åºçš„ä¸åŒéƒ¨åˆ†ï¼Œè™½ç„¶å®ƒä¸ä¸€å®šè¡¨ç¤ºä¸€ä¸ªéƒ¨åˆ†çš„ç»“æŸ</p>
<p>åœ¨ä¹‹å‰çš„ <code>Phase</code> é‡åˆ°çš„ç›¸ä¼¼ä»£ç ä¹Ÿå¯ä»¥å¸®åŠ©æ‹†åˆ†ç¨‹åºï¼Œè®©ç¨‹åºçœ‹ä¸Šå»æ›´åŠ æœ‰ç†Ÿæ‚‰æ„Ÿ</p>
<p><code>j</code> ç±»å‹æŒ‡ä»¤ä¹Ÿæœ‰ä¸€å®šçš„å‚è€ƒä½œç”¨</p>
</div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">00000000004010</span><span class="nf">f4</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase_6</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Part 1</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f4:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">56</span><span class="w">                   </span><span class="nf">push</span><span class="w">   </span><span class="nv">%r14</span><span class="w">                     </span><span class="c1"># ä¸€äº›å‹æ ˆæ“ä½œï¼Œè¿™äº›å¯„å­˜å™¨éƒ½æ˜¯ â€œè¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨â€</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f6:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">55</span><span class="w">                   </span><span class="nf">push</span><span class="w">   </span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">f8:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">54</span><span class="w">                   </span><span class="nf">push</span><span class="w">   </span><span class="nv">%r12</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">fa:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">fb:</span><span class="w">   </span><span class="err">53</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4010</span><span class="nl">fc:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x50</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401100:</span><span class="w">   </span><span class="err">49</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">401103:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401106:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">51</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40145c</span> <span class="p">&lt;</span><span class="no">read_six_numbers</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40110</span><span class="nl">b:</span><span class="w">   </span><span class="err">49</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%r14</span>
<span class="w">  </span><span class="err">40110</span><span class="nl">e:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="nf">bc</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">       </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%r12d</span>
</code></pre></div></td></tr></table></div>
<p>è¯»å–å…­ä¸ªæ•°å­—åˆ†åˆ«ä½äº <code>%rsp</code> ~ <code>%rsp+0x14</code> å¤„ï¼Œ<code>%r13</code> <code>%r14</code> <code>%rsi</code> éƒ½è®¾ç½®ä¸º <code>%rsp</code> ï¼ˆä¹Ÿå°±æ˜¯æŒ‡å‘ <code>num1</code>ï¼‰ï¼Œ<code>%r12d</code> è®¾ç½®ä¸º <code>0</code> </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 2</span>
<span class="w">  </span><span class="err">401114:</span><span class="w">   </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="no">ed</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r13</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">401117:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="mi">00</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%r13</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40111</span><span class="nl">b:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e8</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40111</span><span class="nl">e:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401121:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">401128</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401123:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401128:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%r12d</span>
<span class="w">  </span><span class="err">40112</span><span class="nl">c:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">fc</span><span class="w"> </span><span class="mi">06</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%r12d</span>
<span class="w">  </span><span class="err">401130:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">21</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">401153</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x5f</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401132:</span><span class="w">   </span><span class="err">44</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e3</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r12d</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="w">  </span><span class="err">401135:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">c3</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%ebx</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">401138:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">84</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40113</span><span class="nl">b:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="err">00</span><span class="w">                </span><span class="nf">cmp</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">40113</span><span class="nl">e:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401145</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x51</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401140:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">f5</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401145:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c3</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="w">  </span><span class="err">401148:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">fb</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="w">  </span><span class="err">40114</span><span class="nl">b:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="no">e8</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">401135</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x41</span><span class="p">&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="mi">40114</span><span class="no">d</span><span class="p">:</span><span class="w">   </span><span class="mi">49</span><span class="w"> </span><span class="mi">83</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">401151:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">c1</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401114</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x20</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>å°† <code>%rbp</code> è®¾ç½®ä¸º <code>%r13</code>ï¼Œ <code>%eax</code> è®¾ç½®ä¸º <code>(%r13)</code> ï¼Œä¹Ÿå°±æ˜¯ <code>num1</code>çš„å€¼ï¼Œç„¶åå°†å…¶å‡å» <code>1</code> å’Œ <code>5</code> è¿›è¡Œæ— ç¬¦å·æ¯”è¾ƒï¼Œå¦‚æœ <code>&lt;=</code> æˆç«‹å°±è·³è½¬ï¼Œå¦åˆ™ç‚¸å¼¹çˆ†ç‚¸ï¼Œè¿™é‡Œè¯´æ˜ç¬¬ä¸€ä¸ªæ•°å­—å¿…é¡» <code>&lt;= 6</code> ï¼ˆæ³¨æ„åˆ°æ˜¯æ— ç¬¦å·æ¯”è¾ƒå¹¶ä¸”æœ‰å‡ä¸€æ“ä½œï¼Œå› æ­¤è¿™ä¸ªæ•°ä¹Ÿå¿…é¡» <code>&gt;= 1</code>ï¼‰ã€‚</p>
<p>æ¥ä¸‹æ¥å°† <code>%r12d</code> ï¼ˆæ­¤æ—¶ä¸º <code>0</code>ï¼‰è‡ªå¢å¹¶ä¸ <code>6</code> æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰å°±è·³è½¬åˆ° <code>401153</code> å¤„ï¼ˆè·³ç¦»ä¸Šé¢çš„ä»£ç é˜¶æ®µï¼‰ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªå¾ªç¯è®¡æ•°å™¨çš„ä½“ç°ï¼Œå¾ªç¯å…­æ¬¡ã€‚</p>
<p>å¦åˆ™å°†è‡ªå¢åçš„ <code>%r12d</code> ï¼ˆæ­¤æ—¶ä¸º <code>1</code>ï¼‰èµ‹å€¼ç»™ <code>%ebx</code>ï¼Œè¿™ä¸ªå€¼ç»è¿‡ç¬¦å·æ‰©å±•åä¼ é€’ç»™ <code>%rax</code>ï¼Œæ¥ä¸‹æ¥ <code>%eax</code> = <code>(%rsp + 4 * %rax)</code> ï¼Œè¿™ä¸€éƒ¨åˆ†çš„æ“ä½œé€»è¾‘å¾ˆåƒæ•°ç»„ç´¢å¼•çš„è®¡ç®—ï¼Œäº‹å®ä¸Š <code>%eax</code> è¢«èµ‹å€¼ä¸º â€œä¸‹ä¸€ä¸ªæ•°å­—â€</p>
<p>æ¥ä¸‹æ¥æ¯”è¾ƒ <code>%rbp</code> æŒ‡å‘çš„å€¼ä¸ <code>%eax</code> å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰å°±çˆ†ç‚¸ï¼Œæ³¨æ„åˆ° <code>%rbp</code> æ˜¯ç¬¬ä¸€ä¸ªæ•°ï¼Œå› æ­¤ä»¥ä¸Šçš„ä¸€è½®æ“ä½œæ˜¯ä¸ºäº†ç¡®ä¿ â€œè¾“å…¥çš„å‰ä¸¤ä¸ªæ•°ä¸ç›¸ç­‰â€</p>
<p>è€Œæ¥ä¸‹æ¥çš„ä¸‰è¡ŒæŒ‡ä»¤ï¼ˆä» <code>401145</code> å¼€å§‹ï¼‰å°† <code>%ebx</code> è‡ªå¢å¹¶ä¸ <code>5</code> æ¯”è¾ƒï¼Œå¦‚æœ <code>&lt;=</code> æˆç«‹å°±å›åˆ° <code>401135</code> é‡æ–°è¿›è¡Œ â€œå†ä¸‹ä¸€ä¸ªæ•°å­—â€ ä¸ç¬¬ä¸€ä¸ªæ•°å­—çš„æ¯”è¾ƒï¼Œå¯è§ â€œç¬¬ä¸€ä¸ªæ•°åº”è¯¥ä¸å®ƒåé¢çš„æ‰€æœ‰æ•°éƒ½ä¸ä¸€æ ·â€</p>
<p>æœ€åæ˜¯å¯¹ <code>%r13</code> å¢åŠ  <code>4</code> ï¼ˆä¸€ä¸ªæ•°å­—çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿›è¡Œä»¥ä¸Šæ‰€æœ‰æ“ä½œçš„å¾ªç¯</p>
<p>è¿™äº›å†…å®¹å¯ä»¥æ€»ç»“ä¸ºä¸‹é¢çš„ C è¯­è¨€å‡½æ•°è¡¨ç¤ºï¼š<strong>æ£€æµ‹è¾“å…¥çš„å…­ä¸ªæ•°æ˜¯å¦å¯ä»¥ç»„æˆ <code>1 2 3 4 5 6</code> çš„æŸç§æ— é‡å¤æ’åˆ—</strong>ï¼ˆæ¯”å¦‚ <code>2 5 1 4 6 3</code>ï¼‰</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">check_1_to_6_permutation</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">nums</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">// æ˜¯å¦æ»¡è¶³ 1~6 çš„æ’åˆ—</span>
<span class="w">    </span><span class="c1">// æ£€æŸ¥æ¯ä¸ªæ•°å­—æ˜¯å¦åœ¨ 1-6 èŒƒå›´å†…</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="n">explode_bomb</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// æ£€æŸ¥å½“å‰æ•°å­—æ˜¯å¦ä¸åç»­æ•°å­—é‡å¤</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="n">explode_bomb</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>åœ¨äº†è§£äº†è¾“å…¥å†…å®¹è¦æ±‚åç»§ç»­åˆ†æä¸‹é¢çš„éƒ¨åˆ†ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 3</span>
<span class="w">  </span><span class="err">401153:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">18</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401158:</span><span class="w">   </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="no">f0</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r14</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40115</span><span class="nl">b:</span><span class="w">   </span><span class="nf">b9</span><span class="w"> </span><span class="mi">07</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x7</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">401160:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">ca</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401162:</span><span class="w">   </span><span class="err">2</span><span class="nf">b</span><span class="w"> </span><span class="mi">10</span><span class="w">                   </span><span class="no">sub</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401164:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">10</span><span class="w">                   </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,(</span><span class="nv">%rax</span><span class="p">)</span>
<span class="w">  </span><span class="err">401166:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40116</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">39</span><span class="w"> </span><span class="nf">f0</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40116</span><span class="nl">d:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">f1</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">401160</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x6c</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p><code>%rsi</code> çš„åœ°å€ä¿®æ”¹ä¸º <code>%rsp + 0x18</code> ï¼Œ<code>%rax</code> è¢«èµ‹å€¼ä¸º <code>%r14</code> ï¼ˆ<code>%r14</code> åœ¨ä¹‹å‰æŒ‡å‘äº† <code>num1</code> ï¼‰ï¼Œ<code>%ecx</code> è®¾ç½®ä¸ºå¸¸æ•° <code>7</code> </p>
<p>å°† <code>%edx</code> è®¾ç½®ä¸ºäº† <code>7 - num1</code> ï¼ˆ<code>%rcx</code> - <code>(%rax)</code>ï¼‰ï¼Œç„¶åå°† <code>%rax</code> æŒ‡å‘çš„å†…å®¹ä¿®æ”¹ä¸ºäº† <code>%edx</code> ï¼Œæ¥ç€å°† <code>%rax</code> å¢åŠ å››ï¼ˆä»è€ŒæŒ‡å‘ä¸‹ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œåˆ¤æ–­ <code>%rax</code> å’Œ <code>%rsi</code> æ˜¯å¦ç›¸åŒï¼Œä¸ç›¸åŒåˆ™è·³è½¬åˆ°èµ‹å€¼ <code>%edx</code> çš„å¾ªç¯ï¼ˆå¾ªç¯è®¡æ•°å™¨ï¼‰</p>
<p>ä¸Šé¢è¿™ä¸€é˜¶æ®µçš„ä½œç”¨æ˜¯å°†<strong>æ¯ä¸€ä¸ªæ•°å­— <code>num</code> ä¿®æ”¹ä¸º <code>7 - num</code></strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 4</span>
<span class="w">  </span><span class="err">40116</span><span class="nl">f:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%esi</span>
<span class="w">  </span><span class="err">401174:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">21</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401197</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xa3</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401176:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">52</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40117</span><span class="nl">a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40117</span><span class="nl">d:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">c8</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40117</span><span class="nl">f:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">f5</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">401176</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x82</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401181:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401188</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401183:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6032d0</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401188:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">54</span><span class="w"> </span><span class="err">74</span><span class="w"> </span><span class="err">20</span><span class="w">          </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x20</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">  </span><span class="err">40118</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c6</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401191:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">fe</span><span class="w"> </span><span class="mi">18</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x18</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">401195:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">14</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4011ab</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xb7</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401197:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">34</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rsi</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">40119</span><span class="nl">a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f9</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">40119</span><span class="nl">d:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="no">e4</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">401183</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x8f</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40119</span><span class="nl">f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">a4:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6032d0</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">a9:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">cb</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">401176</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0x82</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>è¿™ä¸€æ®µå¼€å§‹å‡ºç°äº†å¾ˆå¤šçš„è·³è½¬æ“ä½œï¼Œæˆ‘ä»¬å°è¯•æ¨¡æ‹Ÿä¸€éç¨‹åºè¿è¡Œçš„æµç¨‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª Mermaid å›¾è¡¨å¯ä¾›æµç¨‹å‚è€ƒï¼š</p>
<pre class="mermaid"><code>flowchart TD
    A["mov $0x0,%esi"]
    A --&gt; C["mov (%rsp,%rsi,1),%ecx"]
    C --&gt; D{"cmp $0x1,%ecx"}
    D --&gt;|ecx &lt;= 1| E["mov $0x6032d0,%edx"]
    D --&gt;|ecx &gt; 1| F["mov $0x1,%eax<br/>mov $0x6032d0,%edx"]
    F --&gt; I["mov 0x8(%rdx),%rdx"]
    I --&gt; J["add $0x1,%eax"]
    J --&gt; K{"cmp %ecx,%eax"}
    K --&gt;|eax != ecx| I
    K --&gt;|eax == ecx| M["mov %rdx,0x20(%rsp,%rsi,2)<br/>add $0x4,%rsi"]
    E --&gt; M
    M --&gt; O{"cmp $0x18,%rsi"}
    O --&gt;|rsi != 24| C
    O --&gt;|rsi == 24| P["Go to Part 5"]
</code></pre>
<p>çœ‹ä¸æ‡‚ä¹Ÿä¸è¦ç´§ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆçœ‹ä¸€ä¸‹ <code>0x6032d0</code> çš„å†…å®¹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">24</span><span class="w"> </span><span class="mi">0x6032d0</span>
<span class="err">0</span><span class="nf">x6032d0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">node1</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x0000014c</span><span class="w">      </span><span class="mi">0x00000001</span><span class="w">      </span><span class="mi">0x006032e0</span><span class="w">      </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x6032e0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">node2</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x000000a8</span><span class="w">      </span><span class="mi">0x00000002</span><span class="w">      </span><span class="mi">0x006032f0</span><span class="w">      </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x6032f0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">node3</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x0000039c</span><span class="w">      </span><span class="mi">0x00000003</span><span class="w">      </span><span class="mi">0x00603300</span><span class="w">      </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603300</span><span class="w"> </span><span class="err">&lt;</span><span class="no">node4</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x000002b3</span><span class="w">      </span><span class="mi">0x00000004</span><span class="w">      </span><span class="mi">0x00603310</span><span class="w">      </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603310</span><span class="w"> </span><span class="err">&lt;</span><span class="no">node5</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x000001dd</span><span class="w">      </span><span class="mi">0x00000005</span><span class="w">      </span><span class="mi">0x00603320</span><span class="w">      </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603320</span><span class="w"> </span><span class="err">&lt;</span><span class="no">node6</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x000001bb</span><span class="w">      </span><span class="mi">0x00000006</span><span class="w">      </span><span class="mi">0x00000000</span><span class="w">      </span><span class="mi">0x00000000</span>
<span class="c1"># æ³¨é‡Š               # ä¸€ä¸ªintæ•°      # ä¸€ä¸ªåºå·       # æŒ‡å‘çš„åœ°å€ï¼Œæ°å¥½æ˜¯ node1 -&gt; node2 -&gt; ... -&gt; node6</span>
</code></pre></div></td></tr></table></div>
<p>ä» <code>&lt;node&gt;</code> è¿™ä¸ªæ ‡ç­¾æ¥çœ‹ï¼Œ <code>0x6032d0</code> å¼€å§‹çš„åœ°å€å­˜å‚¨äº†ä¸€ä¸ªé“¾è¡¨ï¼Œç”¨ C è¯­è¨€å¯ä»¥è¿™ä¹ˆæè¿°ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">node</span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">              </span><span class="c1">// å½“å‰èŠ‚ç‚¹çš„å€¼</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">label</span><span class="p">;</span><span class="w">              </span><span class="c1">// èŠ‚ç‚¹åºå·</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">node</span><span class="o">*</span><span class="w"> </span><span class="n">next</span><span class="p">;</span><span class="w">      </span><span class="c1">// æŒ‡å‘çš„ä¸‹ä¸€èŠ‚ç‚¹åœ°å€</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ç°åœ¨å†ç»“åˆ Mermaid æµç¨‹å›¾çœ‹ä¸€éè¿™æ®µç¨‹åºï¼š</p>
<p><code>%rsi</code> ä½œä¸ºæœ€å¤–éƒ¨çš„å¾ªç¯è®¡æ•°å™¨ï¼Œåˆå§‹åŒ–ä¸º <code>0</code> ï¼Œæ¯æ¬¡åŠ  <code>4</code> ï¼ˆ<code>40118d</code>ï¼‰ï¼ŒåŠ åˆ° <code>24</code> å°±åœæ­¢å¾ªç¯ï¼Œä¹Ÿå°±æ˜¯ <code>for(int i = 0; i &lt; 6; i++)</code> </p>
<p>å¾ªç¯å†…ï¼Œ<code>mov (%rsp,%rsi,1),%ecx</code> è¿™ä¸€æ­¥å¯ä»¥çœ‹ä½œ <code>int ECX = a[i]</code> ï¼Œå…¶ä¸­ <code>a</code> æ˜¯å­˜å‚¨äº†å…­ä¸ªæ•°å­—çš„æ•°ç»„ï¼ˆä¹‹å‰çš„é˜¶æ®µä¹Ÿæœ‰ç±»ä¼¼çš„ç¨‹åºï¼‰ï¼Œ<code>%rsi</code> å¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªåç§»å€¼ï¼Œç”¨æ¥éå†æ•´ä¸ªæ•°ç»„</p>
<p>åœ¨ <code>%ecx</code> è¢«æ›´æ–°èµ‹å€¼ä»¥åï¼Œå…¶ä¸ <code>1</code> è¿›è¡Œæ¯”è¾ƒï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>å¦‚æœè¿™ä¸ªæ•° `&lt;= 1`ï¼ˆç»“åˆå®é™…æƒ…å†µä¹Ÿå°±æ˜¯åˆ¤æ–­æ˜¯å¦ä¸º `1`ï¼‰ï¼Œå°±æŠŠ `%edx` è®¾ç½®ä¸º `0x6032d0` ï¼ˆä¹Ÿå°±æ˜¯å¤´èŠ‚ç‚¹ `node1` çš„åœ°å€ï¼‰

å¦åˆ™ `%ecx &gt; 1` ï¼Œæ­¤æ—¶å°† `%eax` è®¾ç½®ä¸º `1` ï¼Œ`%edx` è®¾ç½®ä¸º `0x6032d0` ï¼Œæ¥ä¸‹æ¥å°† `%rdx` è®¾ç½®ä¸º (`%rdx + 8`) ï¼ˆä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªåœ°å€ `node-&gt;next`ï¼‰ï¼Œå°† `%rax` åŠ ä¸Šä¸€ï¼Œé‡å¤æ“ä½œç›´åˆ° `%rcx == %rax`
</code></pre></div></td></tr></table></div>
<p>ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼š <code>%edx</code> è¢«è®¾ç½®ä¸ºäº†ç¬¬ <code>%ecx</code> ä¸ªèŠ‚ç‚¹çš„åœ°å€ï¼‰ </p>
<p>æ¥ä¸‹æ¥ <code>mov %rdx,0x20(%rsp,%rsi,2)</code> å°† <code>%rdx</code> å¤åˆ¶åˆ°äº† <code>(%rsp + 0x20 + 2 * %rsi)</code> æŒ‡å‘çš„åœ°å€å¤„ï¼Œè¿™ä¸ªæ“ä½œå°†æ ¹æ®æœ€å¤–éƒ¨çš„å¾ªç¯è®¡æ•°å™¨éå†æ•´ä¸ªæ•°ç»„</p>
<p>æ€»ç»“ï¼šæ­¤é˜¶æ®µ<strong>å°†è¾“å…¥çš„å…­ä¸ªæ•°ä½œä¸ºèŠ‚ç‚¹åºå·ï¼Œä¾æ¬¡å¯¹åº”å…­ä¸ªèŠ‚ç‚¹åœ°å€æŒ‰é¡ºåºå­˜å‚¨åˆ°ä» <code>%rsp+20</code> å¼€å§‹çš„æ ˆç©ºé—´å¤„</strong>ï¼ˆæ„é€ ä¸€ä¸ªåœ°å€æ•°ç»„ï¼‰</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 5</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ab:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">5</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">20</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x20</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rbx</span><span class="w">          </span><span class="c1"># å°†ä¸Šä¸€ä¸ª Part å¾—åˆ°çš„åœ°å€æ•°ç»„çš„ç¬¬ä¸€ä¸ªåœ°å€å­˜å…¥ %rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">b0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">28</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x28</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># %rax = %rsp + 40ï¼ˆç¬¬äºŒä¸ªå…ƒç´ çš„åœ°å€ï¼‰</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">b5:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">50</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x50</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rsi</span><span class="w">          </span><span class="c1"># %rsi = %rsp + 32 + 6*8ï¼ˆåœ°å€æ•°ç»„æœ«å°¾åçš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯arr.end()ï¼‰</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ba:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d9</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rbx</span><span class="p">,</span><span class="nv">%rcx</span><span class="w">                </span><span class="c1"># %rcx = %rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">bd:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">10</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">              </span><span class="c1"># %rdx = (%rax)</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">c0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">51</span><span class="w"> </span><span class="err">08</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rcx</span><span class="p">)</span><span class="w">           </span><span class="c1"># %rdx å€¼å¤åˆ¶åˆ° (%rcx+8) åœ°å€</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">c4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                </span><span class="c1"># %rax +=8</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">c8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">39</span><span class="w"> </span><span class="nf">f0</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                </span><span class="c1"># æ¯”è¾ƒ %rax ~ %rsi</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">cb:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4011d2</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xde</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># å¦‚æœç›¸ç­‰å°±è·³è½¬è‡³ 4011d2</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">cd:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d1</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rcx</span><span class="w">                </span><span class="c1"># å¦åˆ™ %rcx = %rdx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">d0:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="no">eb</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4011bd</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xc9</span><span class="p">&gt;</span><span class="w">    </span><span class="c1"># å¹¶ä¸”è·³å›åˆ° 4011bd</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">d2:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c7</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">)</span><span class="w">           </span><span class="c1"># %rax == %rsi æ—¶ï¼Œå°† 0 å­˜å‚¨åˆ°å†…å­˜åœ°å€ä¸º %rdx + 8 çš„ä½ç½®</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">d9:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>ä¸å¦¨è®°ä¸Šä¸€ä¸ª Part æ„é€ çš„åœ°å€æ•°ç»„ä¸º <code>addr[6]</code>ï¼Œ ç”¨ C++ é‡å†™ç¨‹åº</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Node</span><span class="o">*</span><span class="w"> </span><span class="nf">Part5</span><span class="p">(</span><span class="n">Node</span><span class="o">*</span><span class="w"> </span><span class="n">addr</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Node</span><span class="o">*</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">                          </span><span class="c1">// %rbx = addr[0]</span>
<span class="w">    </span><span class="n">Node</span><span class="o">*</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">first</span><span class="p">;</span><span class="w">                          </span><span class="c1">// %rcx = %rbx</span>
<span class="w">    </span><span class="c1">// ä»ç¬¬äºŒä¸ªå…ƒç´ å¼€å§‹éå†åœ°å€æ•°ç»„</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                   </span><span class="c1">// for (%rax = &amp;addr[1], %rax &lt; addr.end(), %rax++) </span>
<span class="w">        </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w">                    </span><span class="c1">// å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€èŠ‚ç‚¹ç”± addr[i] å†³å®š</span>
<span class="w">        </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span><span class="w">                    </span><span class="c1">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w">                        </span><span class="c1">// å¯¹åº” movq $0x0,0x8(%rdx)ï¼Œä½œç”¨æ˜¯ç»ˆæ­¢é“¾è¡¨</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">first</span><span class="p">;</span><span class="w">                                   </span><span class="c1">// å¾—åˆ°ä¸€ä¸ª</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><code>0x6032d0</code> å¤„çš„åŸå§‹é“¾è¡¨è®°ä¸º <code>node1 -&gt; ... -&gt; node6</code>ï¼Œè¿™ä¸€éƒ¨åˆ†ç¨‹åº<strong>æ ¹æ®è¾“å…¥çš„å…­ä¸ªæ•°å­—é¡ºåºé‡æ–°é“¾æ¥äº†é“¾è¡¨</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 6</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">da:</span><span class="w">   </span><span class="nf">bd</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%ebp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">df:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e3:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">00</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e5:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="err">03</span><span class="w">                   </span><span class="nf">cmp</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,(</span><span class="nv">%rbx</span><span class="p">)</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e7:</span><span class="w">   </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jge</span><span class="w">    </span><span class="mh">4011ee</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xfa</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">e9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ee:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">5</span><span class="no">b</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbx</span><span class="p">),</span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">f2:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">ed</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%ebp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">f5:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="nf">e8</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">4011df</span> <span class="p">&lt;</span><span class="no">phase_6</span><span class="p">+</span><span class="mi">0xeb</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>è¿™ä¸€éƒ¨åˆ†ç¨‹åºçš„å†…å®¹ååˆ†æ˜æ˜¾äº†ï¼šé‡æ–°é“¾æ¥åçš„é“¾è¡¨çš„å­˜å‚¨çš„å€¼å¿…é¡»é™åºï¼Œå¦åˆ™å¼•çˆ†ç‚¸å¼¹ã€‚æ­£ç¡®çš„é“¾è¡¨è¿æ¥æ–¹å¼æ˜¯ <code>3 -&gt; 4 -&gt; 5 -&gt; 6 -&gt; 1 -&gt; 2</code></p>
<p>è€ƒè™‘åˆ° Part 3 å°†æ¯ä¸€ä¸ªæ•° <code>num</code> æ”¹å†™ä¸º <code>7 - num</code> ï¼Œæ‰€ä»¥æ•´ä¸ª Phase æœ€ç»ˆçš„ç­”æ¡ˆå°±æ˜¯ <code>4 3 2 1 6 5</code> </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># Part 7</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">f7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">50</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x50</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">fb:</span><span class="w">   </span><span class="err">5</span><span class="nf">b</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">fc:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">fd:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">5</span><span class="nf">c</span><span class="w">                   </span><span class="no">pop</span><span class="w">    </span><span class="nv">%r12</span>
<span class="w">  </span><span class="err">4011</span><span class="nl">ff:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">5</span><span class="nf">d</span><span class="w">                   </span><span class="no">pop</span><span class="w">    </span><span class="nv">%r13</span>
<span class="w">  </span><span class="err">401201:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="err">5</span><span class="nf">e</span><span class="w">                   </span><span class="no">pop</span><span class="w">    </span><span class="nv">%r14</span>
<span class="w">  </span><span class="err">401203:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>æ¸…ç†æ ˆå¸§å¹¶æ¢å¤è¢«è°ƒç”¨è€…ä¿å­˜çš„å¯„å­˜å™¨ï¼Œä¸éœ€è¦å¤šåˆ†æ</p>
<h3 id="secret-phase">Secret Phase</h3>
<p>ç»“æŸå…­ä¸ªå¸¸è§„çš„ Phase åå¹¶æ²¡æœ‰å‘ç°ä»»ä½•è§¦å‘ Secret Phase çš„ä»£ç æ®µï¼Œè¿™é‡Œé‡‡ç”¨äº†ä¸€ä¸ªæ¯”è¾ƒæŠ•æœºçš„æ“ä½œï¼šæœç´¢å‡ºç°äº† <code>401242</code> åœ°å€çš„å‡½æ•°</p>
<p>å‡½æ•° <code>&lt;phase_defused&gt;</code> çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼šåœ¨ main å‡½æ•°ä¸­ï¼Œåœ¨æ¯ä¸€ä¸ªç‚¸å¼¹è¢«æ‹†é™¤æ—¶è¢«è°ƒç”¨ï¼Œè€Œ <code>401630</code> åœ°å€å¤„å‡ºç°äº†è·³è½¬è‡³éšè—é˜¶æ®µçš„è·³è½¬å‡½æ•°ï¼Œå¯¹è¿™ä¸ªå‡½æ•°çš„ç›¸å…³éƒ¨åˆ†è¿›è¡Œåˆ†æï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">4015</span><span class="nl">e1:</span><span class="w">   </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">8</span><span class="no">d</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">10</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%r8</span>
<span class="w">  </span><span class="err">4015</span><span class="nl">e6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rcx</span>
<span class="w">  </span><span class="err">4015</span><span class="nl">eb:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">4015</span><span class="nl">f0:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">19</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x402619</span><span class="p">,</span><span class="nv">%esi</span><span class="w">                   </span><span class="c1"># (gdb) x/s 0x402619: "%d %d %s"</span>
<span class="w">  </span><span class="err">4015</span><span class="nl">f5:</span><span class="w">   </span><span class="nf">bf</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x603870</span><span class="p">,</span><span class="nv">%edi</span><span class="w">                   </span><span class="c1"># 0x603870 &lt;input_strings+240&gt;: ""</span>
<span class="w">  </span><span class="err">4015</span><span class="nl">fa:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">f1</span><span class="w"> </span><span class="no">f5</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400bf0</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4015</span><span class="nl">ff:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">03</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x3</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401602:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">31</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">401635</span> <span class="p">&lt;</span><span class="no">phase_defused</span><span class="p">+</span><span class="mi">0x71</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401604:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x402622</span><span class="p">,</span><span class="nv">%esi</span><span class="w">                   </span><span class="c1"># 0x402622: "DrEvil"</span>
<span class="w">  </span><span class="err">401609:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">7</span><span class="no">c</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">10</span><span class="w">          </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">),</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">40160</span><span class="nl">e:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="no">fd</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401338</span> <span class="p">&lt;</span><span class="no">strings_not_equal</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401613:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401615:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">1</span><span class="nf">e</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">401635</span> <span class="p">&lt;</span><span class="no">phase_defused</span><span class="p">+</span><span class="mi">0x71</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401617:</span><span class="w">   </span><span class="nf">bf</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x4024f8</span><span class="p">,</span><span class="nv">%edi</span>
<span class="w">  </span><span class="err">40161</span><span class="nl">c:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">ef</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400b10</span> <span class="p">&lt;</span><span class="no">puts@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401621:</span><span class="w">   </span><span class="nf">bf</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x402520</span><span class="p">,</span><span class="nv">%edi</span>
<span class="w">  </span><span class="err">401626:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">e5</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400b10</span> <span class="p">&lt;</span><span class="no">puts@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40162</span><span class="nl">b:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401630:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">0</span><span class="no">d</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401242</span> <span class="p">&lt;</span><span class="no">secret_phase</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>å¾ˆæ˜æ˜¾è¿™ä¸ªç‰¹æ®Šçš„å¯†ç æ˜¯ <code>DrEvil</code> ï¼Œè€Œæ­£ç¡®è¾“å…¥å¯†ç çš„æ–¹å¼æ˜¯åœ¨æŸä¸ªé˜¶æ®µçš„è¾“å…¥ä¸­è¾“å…¥ä¸¤ä¸ªæ•´æ•° + å­—ç¬¦ä¸²ï¼ˆå³ <code>DrEvil</code>ï¼‰ã€‚</p>
<p>ï¼ˆå…·ä½“ä¸€ç‚¹æ¥è¯´ï¼šå°† <code>0x402619</code> ä½œä¸ºè¾“å…¥æ ¼å¼ï¼Œå°† <code>0x603870</code> ä½œä¸ºè¾“å…¥ï¼ˆä¸€å®šæ˜¯ä¹‹å‰æŸä¸€ä¸ªé˜¶æ®µçš„è¾“å…¥ï¼‰ï¼Œæå–å‡º <code>%s</code> åˆ¤æ–­æ˜¯å¦ä¸º <code>DrEvil</code>ï¼‰</p>
<p>æˆ‘ä»¬çŸ¥é“ Phase 3 å’Œ Phase 4 éœ€è¦è¾“å…¥çš„éƒ½æ˜¯ä¸¤ä¸ªæ•°å­—ï¼Œæ‰€ä»¥å“ªä¸€ä¸ªé˜¶æ®µåº”è¯¥å¤šä¸€ä¸ªè¾“å…¥å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨ä½¿ç”¨gdbè°ƒè¯•ï¼Œåœ¨ Phase 5 å¼€å§‹çš„æ—¶å€™æ‰“ä¸€ä¸ªæ–­ç‚¹ï¼Œç„¶åæ£€æŸ¥ <code>0x603870</code> çš„å†…å®¹</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code>(gdb) break *0x401062
Breakpoint 1 at 0x401062
(gdb) r
Starting program: /home/nopthon/Desktop/bomb/bomb 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Welcome to my fiendish little bomb. You have 6 phases with
which to blow yourself up. Have a nice day!
Border relations with Canada have never been better.
Phase 1 defused. How about the next one?
1 2 4 8 16 32
That's number 2.  Keep going!
2 707                                                                               # Phase 3 çš„è¾“å…¥
Halfway there!
1 0                                                                                 # Phase 4 çš„è¾“å…¥
So you got that one.  Try this one.
^_^(a breakpoint here)

Breakpoint 1, 0x0000000000401062 in phase_5 ()
(gdb) x/s 0x603870
0x603870 &lt;input_strings+240&gt;:   "1 0"                                               # Phase 4 çš„è¾“å…¥
</code></pre></div></td></tr></table></div>
<p>æˆ‘ä»¬å‘ç° <code>0x603870</code> å­˜å‚¨çš„æ˜¯ç¬¬å››é˜¶æ®µçš„è¾“å…¥ï¼Œå› æ­¤åœ¨ç¬¬å››é˜¶æ®µçš„è¾“å…¥ä¸­å¤šè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸² <code>DrEvil</code> å°±å¯ä»¥è¿›å…¥éšè—é˜¶æ®µï¼ˆæ¯”å¦‚ <code>1 0 DrEvil</code>ï¼‰</p>
<p>ä¸‹é¢æ˜¯éšè—é˜¶æ®µçš„ä»£ç ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000401242</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">secret_phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">401242:</span><span class="w">   </span><span class="err">53</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbx</span><span class="w">                             </span><span class="c1"># è¢«è°ƒç”¨è€…ä¿å­˜å¯„å­˜å™¨</span>
<span class="w">  </span><span class="err">401243:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">56</span><span class="w"> </span><span class="mi">02</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40149e</span> <span class="p">&lt;</span><span class="no">read_line</span><span class="p">&gt;</span><span class="w">               </span><span class="c1"># è¯»å–ä¸€è¡Œå†…å®¹ï¼Œè¿”å›å€¼ %rax</span>
<span class="w">  </span><span class="err">401248:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="mi">0</span><span class="no">a</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xa</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                        </span><span class="c1"># %edx = 10</span>
<span class="w">  </span><span class="err">40124</span><span class="nl">d:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%esi</span><span class="w">                        </span><span class="c1"># %esi = 0</span>
<span class="w">  </span><span class="err">401252:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                        </span><span class="c1"># %rdi = %rax</span>
<span class="w">  </span><span class="err">401255:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">76</span><span class="w"> </span><span class="no">f9</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400bd0</span> <span class="p">&lt;</span><span class="no">strtol@plt</span><span class="p">&gt;</span><span class="w">              </span><span class="c1"># è°ƒç”¨ C è¯­è¨€å‡½æ•° strtol() ï¼Œå­—ç¬¦ä¸²è½¬åŒ–ä¸º long æ•´æ•°</span>
<span class="w">  </span><span class="err">40125</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c3</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rbx</span><span class="w">                        </span><span class="c1"># è¿”å›å€¼ï¼ˆæ•´æ•°ï¼‰ %rax å­˜å…¥ %rbx</span>
<span class="w">  </span><span class="err">40125</span><span class="nl">d:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="no">ff</span><span class="w">                </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># %rax = %rax - 1 ï¼ˆåœ°å€è®¡ç®—ï¼‰</span>
<span class="w">  </span><span class="err">401260:</span><span class="w">   </span><span class="err">3</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x3e8</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                      </span><span class="c1"># %eax ä¸ 1000 æ¯”è¾ƒ</span>
<span class="w">  </span><span class="err">401265:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">40126c</span> <span class="p">&lt;</span><span class="no">secret_phase</span><span class="p">+</span><span class="mi">0x2a</span><span class="p">&gt;</span><span class="w">       </span><span class="c1"># %eax &lt;= 1000 åˆ™è·³è½¬</span>
<span class="w">  </span><span class="err">401267:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">ce</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">            </span><span class="c1"># å¦åˆ™ BOOM! </span>
<span class="w">  </span><span class="err">40126</span><span class="nl">c:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">de</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%ebx</span><span class="p">,</span><span class="nv">%esi</span><span class="w">                        </span><span class="c1"># %esi = %ebx ï¼ˆä¹Ÿå°±æ˜¯ä¹‹å‰çš„è¿”å›å€¼ï¼‰</span>
<span class="w">  </span><span class="err">40126</span><span class="nl">e:</span><span class="w">   </span><span class="nf">bf</span><span class="w"> </span><span class="no">f0</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6030f0</span><span class="p">,</span><span class="nv">%edi</span>
<span class="w">  </span><span class="err">401273:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">8</span><span class="no">c</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401204</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">&gt;</span><span class="w">                    </span><span class="c1"># è°ƒç”¨ fun7 å‡½æ•°</span>
<span class="w">  </span><span class="err">401278:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">02</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x2</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                        </span><span class="c1"># è¿”å›å€¼ %eax ä¸ 2 æ¯”è¾ƒ</span>
<span class="w">  </span><span class="err">40127</span><span class="nl">b:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">05</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">401282</span> <span class="p">&lt;</span><span class="no">secret_phase</span><span class="p">+</span><span class="mi">0x40</span><span class="p">&gt;</span><span class="w">       </span><span class="c1"># å¦‚æœç›¸ç­‰å°±è·³è½¬ï¼ˆä»£è¡¨æ‹†å¼¹æˆåŠŸï¼‰</span>
<span class="w">  </span><span class="err">40127</span><span class="nl">d:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">b8</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40143a</span> <span class="p">&lt;</span><span class="no">explode_bomb</span><span class="p">&gt;</span><span class="w">            </span><span class="c1"># å¦åˆ™ BOOM!</span>
<span class="w">  </span><span class="err">401282:</span><span class="w">   </span><span class="nf">bf</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x402438</span><span class="p">,</span><span class="nv">%edi</span><span class="w">                   </span><span class="c1"># è¿™é‡Œå­˜çš„æ˜¯æ‹†å¼¹æˆåŠŸçš„ç¥è´ºè¯­ :)</span>
<span class="w">  </span><span class="err">401287:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400b10</span> <span class="p">&lt;</span><span class="no">puts@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40128</span><span class="nl">c:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">33</span><span class="w"> </span><span class="mi">03</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4015c4</span> <span class="p">&lt;</span><span class="no">phase_defused</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401291:</span><span class="w">   </span><span class="err">5</span><span class="nf">b</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbx</span>
<span class="w">  </span><span class="err">401292:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">401293</span><span class="p">:</span><span class="w">   </span><span class="mi">90</span><span class="w">                      </span><span class="no">nop</span>
<span class="w">  </span><span class="na">...</span><span class="w"> </span><span class="no">...</span><span class="w"> </span><span class="c1"># å¾ˆå¤šçš„ nop</span>
<span class="w">  </span><span class="err">40129</span><span class="nl">f:</span><span class="w">   </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span>

<span class="err">0000000000401204</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">fun7</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">401204:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                        </span><span class="c1"># åˆ†é…æ ˆç©ºé—´</span>
<span class="w">  </span><span class="err">401208:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">ff</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rdi</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">40120</span><span class="nl">b:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">2</span><span class="nf">b</span><span class="w">                   </span><span class="no">je</span><span class="w">     </span><span class="mh">401238</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40120</span><span class="nl">d:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">17</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rdi</span><span class="p">),</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">40120</span><span class="nl">f:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">f2</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%esi</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401211:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="mi">0</span><span class="no">d</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">401220</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">+</span><span class="mi">0x1c</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401213:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">7</span><span class="no">f</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rdi</span><span class="p">),</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">401217:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">e8</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401204</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40121</span><span class="nl">c:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">add</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40121</span><span class="nl">e:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">1</span><span class="no">d</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">40123d</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">+</span><span class="mi">0x39</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401220:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401225:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">f2</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%esi</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">401227:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">14</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40123d</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">+</span><span class="mi">0x39</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401229:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">7</span><span class="no">f</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rdi</span><span class="p">),</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">40122</span><span class="nl">d:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">d2</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">401204</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401232:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">401236:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">05</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">40123d</span> <span class="p">&lt;</span><span class="no">fun7</span><span class="p">+</span><span class="mi">0x39</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">401238:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0xffffffff</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40123</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c4</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x8</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">401241:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>ä¸»å‡½æ•°éƒ¨åˆ†çš„ç¨‹åºå¾ˆæ¸…æ™°ï¼Œä¸»è¦å…³æ³¨ <code>fun7</code> å‡½æ•°çš„å†…å®¹</p>
<p>ä¸ºäº†æ–¹ä¾¿ç†è§£ç»˜åˆ¶å‡º <code>fun7</code> çš„ Mermaid ç¤ºæ„å›¾ï¼š</p>
<pre class="mermaid"><code>flowchart TD
    A[sub $0x8, %rsp] --&gt; B{"test %rdi, %rdi"}
    B --&gt;|%rdi == 0| C["mov $0xffffffff, %eax"]
    B --&gt;|%rdi != 0| D["mov (%rdi), %edx"]
    D --&gt; E{"cmp %esi, %edx"}
    E --&gt;|%edx &lt;= %esi| F["mov $0x0, %eax"]
    E --&gt;|%edx &gt; %esi| G["mov 0x8(%rdi), %rdi"]
    G --&gt; H["call fun7 (é€’å½’)"]
    H --&gt; I["add %eax, %eax"]
    I --&gt; J
    F --&gt; K{"cmp %esi, %edx"}
    K --&gt;|%edx == %esi| J
    K --&gt;|%edx != %esi| L["mov 0x10(%rdi), %rdi"]
    L --&gt; M["call fun7 (é€’å½’)"]
    M --&gt; N["lea 0x1(%rax,%rax,1), %eax"]
    N --&gt; J
    C --&gt; J
    J[add $0x8, %rsp]
    J --&gt; P["ret (è¿”å›)"]


</code></pre>
<p>å­˜åœ¨é€’å½’ï¼Œå¹¶ä¸”æœ‰æœç´¢çš„æ¨¡å¼ï¼Œè€ƒè™‘æ˜¯å¯¹ä¸€ä¸ªæ ‘å½¢æ•°æ®ç»“æ„çš„æ“ä½œ</p>
<p>åœ¨é¦–æ¬¡è°ƒç”¨ <code>fun7</code> å‰ï¼Œè¢«å­˜å…¥ <code>%edi</code> çš„ï¼ˆ<code>0x6030f0</code>ï¼‰åº”è¯¥æ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„çš„èµ·ç‚¹ï¼Œå¯ä»¥ç”¨ gdb è¿›è¡Œè®¿é—®</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># 0x6030f0 å¤„çš„å†…å®¹ï¼Œè¢«å­˜å…¥ %edi </span>
<span class="err">0</span><span class="nf">x6030f0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n1</span><span class="err">&gt;</span><span class="p">:</span><span class="w">      </span><span class="mi">0x00000024</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603110</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603130</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603110</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n21</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000008</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603190</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603150</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603130</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n22</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000032</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603170</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x006031b0</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603150</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n32</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000016</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603270</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603230</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603170</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n33</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000002d</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x006031d0</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603290</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603190</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n31</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000006</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x006031f0</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603250</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x6031b0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n34</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000006b</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00603210</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x006032b0</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x6031d0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n45</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000028</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x6031f0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n41</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000001</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603210</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n47</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000063</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603230</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n44</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000023</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603250</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n42</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000007</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603270</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n43</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000014</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x603290</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n46</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000002f</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="err">0</span><span class="nf">x6032b0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">n48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x000003e9</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="c1">#                   # å­˜å‚¨çš„å€¼               # å·¦åˆ†æ”¯èŠ‚ç‚¹åœ°å€           # å³åˆ†æ”¯èŠ‚ç‚¹åœ°å€          # å¡«å……å¯¹é½</span>
</code></pre></div></td></tr></table></div>
<p>ä»æ ‡ç­¾æ¥çœ‹å¾ˆåƒæ˜¯ä¸€ä¸ªäºŒå‰æ ‘ç»“æ„ï¼Œè€ƒè™‘æ¯ä¸ªèŠ‚ç‚¹åˆ†åˆ«å­˜å‚¨çš„å†…å®¹ä¾æ¬¡æ˜¯ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">Node</span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">;</span>
<span class="w">    </span><span class="n">Node</span><span class="o">*</span><span class="w"> </span><span class="n">left</span><span class="p">;</span>
<span class="w">    </span><span class="n">Node</span><span class="o">*</span><span class="w"> </span><span class="n">right</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>æ®æ­¤ç»˜åˆ¶å›¾åƒï¼š</p>
<pre class="mermaid"><code>flowchart LR
    n1["n1 (0x6030f0)<br>val: 36"]

    n1 --&gt; n21["n21 (0x603110)<br>val: 8"]
    n1 --&gt; n22["n22 (0x603130)<br/>val: 50"]

    n21 --&gt; n31["n31 (0x603190)<br/>val: 6"]
    n21 --&gt; n32["n32 (0x603150)<br/>val: 22"]

    n22 --&gt; n33["n33 (0x603170)<br/>val: 45"]
    n22 --&gt; n34["n34 (0x6031b0)<br/>val: 107"]

    n31 --&gt; n41["n41 (0x6031f0)<br/>val: 1"]
    n31 --&gt; n42["n42 (0x603250)<br/>val: 7"]

    n32 --&gt; n43["n43 (0x603270)<br/>val: 20"]
    n32 --&gt; n44["n44 (0x603230)<br/>val: 35"]

    n33 --&gt; n45["n45 (0x6031d0)<br/>val: 40"]
    n33 --&gt; n46["n46 (0x603290)<br/>val: 47"]

    n34 --&gt; n47["n47 (0x603210)<br/>val: 99"]
    n34 --&gt; n48["n48 (0x6032b0)<br/>val: 1001"]
</br></br></code></pre>
<p>ä¸éš¾çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ª<a href="https://oiwiki.org/ds/bst/">äºŒå‰æœç´¢æ ‘</a>ï¼Œè€Œ <code>fun7</code> çš„ä½œç”¨å¯ä»¥ç”¨ C è¯­è¨€è¿™æ ·è¡¨ç¤ºï¼šï¼ˆå‚è§<a href="https://oiwiki.org/ds/bst/#%E6%90%9C%E7%B4%A2%E5%85%83%E7%B4%A0">æœç´¢å…ƒç´ </a>ï¼Œä»£ç éå¸¸ç›¸è¿‘ï¼‰</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">fun7</span><span class="p">(</span><span class="n">Node</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                   </span><span class="c1">// %esi æ˜¯ä¸€ä¸ªè¢«æŸ¥æ‰¾çš„å€¼</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w">                                  </span><span class="c1">// %rdi == 0 æ—¶ï¼Œè¿”å›å€¼ 0xffffffff</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// %rdi != 0:</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">node_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span><span class="w">                     </span><span class="c1">// 40120d: mov (%rdi),%edx</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node_val</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                        </span><span class="c1">// 401225: cmp %esi,%edx</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node_val</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">value</span><span class="p">)</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span><span class="w">                             </span><span class="c1">// node_val == value</span>

<span class="w">        </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun7</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">     </span><span class="c1">// node_val &lt; value</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun7</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span><span class="w">          </span><span class="c1">// node_val &gt; value</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><code>&lt;secret_phase&gt;</code> ä¸»ç¨‹åºè¦æ±‚ <code>fun7</code> çš„æœ€ç»ˆè¿”å›å€¼ä¸º <code>2</code>ï¼Œå› æ­¤è¢«æŸ¥æ‰¾çš„å€¼åº”è¯¥è¦ä»å†…åˆ°å¤–é€†æ¨é€’å½’ï¼Œè®¡ç®—<code>2 * (2 * 0 + 1)</code> ä½œä¸ºè¿”å›å€¼</p>
<p>æ¯”å¦‚ä»¥ <code>n32</code> è¿™ä¸ªèŠ‚ç‚¹ä¸ºä¾‹ï¼Œè¢«æŸ¥æ‰¾çš„å€¼ä¸º <code>22</code>ï¼Œé‚£ä¹ˆå‘ä¸Šé€†æ¨é€’å½’å›åˆ°æ ¹èŠ‚ç‚¹çš„æ—¶å€™ï¼Œç»å†äº†è¿™æ ·çš„æ­¥éª¤ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>// ç¬¬ä¸‰å±‚é€’å½’
return 0;           // å…¶å®è¿™é‡Œä¹Ÿå¯ä»¥æ˜¯ 2*0 çš„ç»“æœï¼Œå¯¹åº”èŠ‚ç‚¹ n43
// ç¬¬äºŒå±‚é€’å½’
return 2*fun7 + 1;  // 1
// ç¬¬ä¸€å±‚é€’å½’
return 2*fun7;      // 2
</code></pre></div></td></tr></table></div>
<p>æ‰€ä»¥è¯¥é˜¶æ®µçš„æœ€ç»ˆç­”æ¡ˆä¸º <code>20</code> æˆ– <code>22</code> </p>
<hr/>
<h2 id="final-ans">Final Ans</h2>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code>â¯ ./bomb
Welcome to my fiendish little bomb. You have 6 phases with
which to blow yourself up. Have a nice day!
Border relations with Canada have never been better.            # Phase 1
Phase 1 defused. How about the next one?
1 2 4 8 16 32                                                   # Phase 2
That's number 2.  Keep going!
2 707                                                           # Phase 3
Halfway there!
1 0 DrEvil                                                      # Phase 4
So you got that one.  Try this one.
yonuvw                                                          # Phase 5
Good work!  On to the next...
4 3 2 1 6 5                                                     # Phase 6
Curses, you've found the secret phase!
But finding it and solving it are quite different...
22                                                              # Secret Phase
Wow! You've defused the secret stage!
Congratulations! You've defused the bomb!                       # Congrats!
</code></pre></div></td></tr></table></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
<script src="../../../stylesheets/extra.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>