
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Bomblab/">
      
      
        <link rel="next" href="../../../Deep-Learning/intro/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>ICS Binalab - CSNote</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    
      <link rel="stylesheet" href="https://fonts.loli.net/css?family=JetBrains Mono:400,500,600,700&display=swap">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ics-binalab-solution" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="CSNote" class="md-header__button md-logo" aria-label="CSNote" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CSNote
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ICS Binalab
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="CSNote" class="md-nav__button md-logo" aria-label="CSNote" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CSNote
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    index
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OI-learning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            OI-learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/C%2B%2B%20OOP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C++ 面向对象
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Algorithm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Algorithm/STL_algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STL 算法库 ref
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Algorithm/fastpow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    快速幂
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Structure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Data Structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Data-Structure/linkedlist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    链表
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Data-Structure/vector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STL vector ref
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Data-Structure/stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    栈 && 单调栈
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Data-Structure/queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    队列 && 单调队列
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OI-Learning/Data-Structure/hashmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    哈希表
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Course Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ICSPA x86 note
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            ICSPA x86 note
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ICSPA-x86/PA0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PA0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ICSPA-x86/PA1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PA1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ICSPA-x86/PA2-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PA2-1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ICSPA-x86/i386/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    i386 指令结构 for PA2-1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ICSPA-x86/PA2-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PA2-2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    网络攻防实战 note
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            网络攻防实战 note
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network-attack-and-defense-in-action/lab01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab01
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network-attack-and-defense-in-action/lab02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab02
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network-attack-and-defense-in-action/lab03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab03
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network-attack-and-defense-in-action/lab04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab04
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Network-attack-and-defense-in-action/lab05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab05
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ICS && CSAPP Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            ICS && CSAPP Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Datalab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSAPP Datalab
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bomblab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSAPP Bomblab
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    ICS Binalab
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    ICS Binalab
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-start-how-main-works" class="md-nav__link">
    <span class="md-ellipsis">
      Before Start: How &lt;main&gt; works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-1" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: 字符串比较
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: 浮点数表示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: 循环
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: 选择（条件分支）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: 递归调用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-6" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 6: 数组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-7" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 7: 指针
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-8" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 8: 结构与链表/树
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deep Learning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Deep Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Deep-Learning/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    intro
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-start-how-main-works" class="md-nav__link">
    <span class="md-ellipsis">
      Before Start: How &lt;main&gt; works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-1" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: 字符串比较
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: 浮点数表示
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: 循环
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: 选择（条件分支）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: 递归调用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-6" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 6: 数组
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-7" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 7: 指针
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-8" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 8: 结构与链表/树
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ics-binalab-solution">ICS Binalab Solution</h1>
<p>和 CSAPP Bomblab 的内容大致相同，Binalab 将每个 Part 进行了拆分处理并进行了改动</p>
<p>通过动态调试 / 静态分析二进制文件，为每个 Part 的二进制文件构造一个正确的输入，就可以完成每个 Part 的任务</p>
<div class="admonition quote">
<p class="admonition-title">随笔</p>
<p>完成校内 ICS 课程的 Binalab 之前，我在暑假完成了 CSAPP 的 Bomblab，这两个 Lab 的内容没有明显区别，因此这里的 Solution 会相对简略</p>
<p>可以算是二刷吧</p>
</div>
<h2 id="solution">Solution</h2>
<h3 id="before-start-how-main-works">Before Start: How <code>&lt;main&gt;</code> works</h3>
<details class="quote">
<summary>完整的 main 函数</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cm">/*</span>
<span class="cm">* Main module of BinaLAB.</span>
<span class="cm">*</span>
<span class="cm">* Copyright 2023, SU Feng, All rights reserved.</span>
<span class="cm">*/</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;config.h&quot;</span>

<span class="c1">//</span>
<span class="c1">// Global Data</span>
<span class="c1">//</span>

<span class="k">extern</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">phase</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">inputs</span><span class="p">);</span>

<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">phase_id</span><span class="p">;</span>

<span class="c1">//</span>
<span class="c1">// Declarations</span>
<span class="c1">//</span>

<span class="kt">char</span><span class="w"> </span><span class="n">inputs</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>

<span class="c1">//</span>
<span class="c1">// Utilities</span>
<span class="c1">// </span>

<span class="kt">void</span><span class="w"> </span><span class="nf">fixinput</span><span class="p">(</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputs</span><span class="o">+</span><span class="n">length</span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">inputs</span><span class="p">;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//</span>
<span class="c1">// Main Function</span>
<span class="c1">// </span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[]</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#if defined(QUESTION)</span>
<span class="w">    </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// If no command argument is given, read the input line from standard input.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdin</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="c1">// When a file argument is given, read the input line from the file.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">stream</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Error: Failed to open the file %s.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="c1">// More than one command line arguments are not allowed.</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Usage: %s [input file]</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Welcome to the binary program analysis lab.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Here begins the task. Please input your answer ...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Read the input line</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">inputs</span><span class="p">));</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="w"> </span><span class="n">fgets</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">inputs</span><span class="p">),</span><span class="w"> </span><span class="n">stream</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Error: Failed to read the input line.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">fixinput</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">inputs</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Run the phase</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">phase</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Congratulations! You&#39;ve completed %s successfully.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">phase_id</span><span class="p">);</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Oops, %s failed. Try again.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">phase_id</span><span class="p">);</span>

<span class="cp">#elif defined(ANSWER)</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">inputs</span><span class="p">));</span>
<span class="w">    </span><span class="n">phase</span><span class="p">(</span><span class="n">inputs</span><span class="p">);</span>

<span class="cp">#endif</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
<p>C 语言还是很好理解的，可以读取标准输入，也可以读取文件作为某个 Phase 的输入；宏定义 <code>QUESTION</code> 有效时，进行正常的测试；宏定义为 <code>ANSWER</code> 时生成答案（这个我们用不到）</p>
<p>但是在阅读汇编代码时，我们首先会发现一个问题：我们的输入储存在了哪里（换句话说，输入内容的首地址在哪个寄存器内被储存）</p>
<p>汇编代码中 <code>&lt;main&gt;</code> 函数有这样一个部分（以 Phase 1 为例）：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>40085f: e8 b9 fe ff ff          call   40071d &lt;fixinput&gt;
400864: bf 40 11 60 00          mov    $0x601140,%edi
400869: e8 5c 00 00 00          call   4008ca &lt;phase&gt;
</code></pre></div></td></tr></table></div>
<p><code>&lt;fixinput&gt;</code> 函数用于将字符串输入结尾的 <code>\n</code> 替换为 <code>\0</code>，而在调用 <code>&lt;phase&gt;</code> 函数之前的 <code>mov</code> 操作将输入首地址 <code>$0x601140</code> 赋值给了 <code>%edi</code>，因此在接下来的 Phase 中，用户输入的首地址是由 <code>%rdi</code> 传入的（至于理解传入后的压栈等操作，那是 Phase 内的任务）</p>
<p>另外，如果你看到了一些看上去把简单的事情复杂化的代码片段，那是编译器不执行任何优化的结果，比如 Phase 1 的 <code>%rdi</code> 传递</p>
<p>另另外，如果你发现了 <code>&lt;__func_DumwPqNk&gt;</code> 这样的什么都不做的函数，那大概率是给每个学生的作业标记</p>
<h3 id="phase-1">Phase 1: 字符串比较</h3>
<p>使用 <code>objdump -d phasex</code> 进行反汇编，给出 <code>&lt;phase&gt;</code> 函数与其他解题相关的函数的汇编（之后不再介绍）</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">00000000004008</span><span class="nf">ca</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ca:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">cb:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ce:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x10</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">               </span><span class="c1"># 栈上分配 16 字节空间</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d2:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">          </span><span class="c1"># 输入的字符串保存到栈上</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># 栈上加载字符串地址，保存到 %rax</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">da:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">e0</span><span class="w"> </span><span class="mi">0</span><span class="no">a</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x400ae0</span><span class="p">,</span><span class="nv">%esi</span><span class="w">           </span><span class="c1"># 0x400ae0 存入 %esi</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">df:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                </span><span class="c1"># rdi = rax</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e2:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="no">fd</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4005f0</span> <span class="p">&lt;</span><span class="no">strcmp@plt</span><span class="p">&gt;</span><span class="w">      </span><span class="c1"># 进行字符串比较，返回值约定由 %eax 储存</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e7:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e9:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                      </span><span class="c1"># eax = 0, al = 1，表示字符串相等</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ec:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                 </span><span class="c1"># al 零扩展为 eax</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ef:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">                           </span><span class="c1"># 恢复栈帧</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f0:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">                             </span><span class="c1"># 返回</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f1:</span><span class="w">   </span><span class="err">66</span><span class="w"> </span><span class="err">2</span><span class="nf">e</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cs</span><span class="w"> </span><span class="no">nopw</span><span class="w"> </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">        </span><span class="c1"># nop 代码对齐</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f8:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fb:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">nopl</span><span class="w">   </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="c1"># nop 代码对齐</span>
</code></pre></div></td></tr></table></div>
<p><code>%rdi</code> 经过一轮游（入栈，保存到 <code>%rax</code>，保存回 <code>%rdi</code>）还是回到了 <code>%rdi</code>，与 <code>0x400ae0</code> 处硬编码的字符串进行字符串比较，字符串相等时函数返回 <code>1</code>（否则返回 <code>0</code>），用 <code>eax</code> 作为整个 <code>&lt;phase&gt;</code> 函数的返回值</p>
<p>阅读这些代码时只需要关注 leave 语句之前的内容即可，函数返回值 <code>eax</code> 为 1 说明 Phase 答案正确</p>
<p>使用 gdb 读取内存：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>(gdb) x/s 0x400ae0
0x400ae0:   &quot;Early PCs used physical addressing.&quot;
</code></pre></div></td></tr></table></div>
<p><strong>Answer: <code>Early PCs used physical addressing.</code></strong></p>
<h3 id="phase-2">Phase 2: 浮点数表示</h3>
<p>相比 CSAPP 特有的 Phase</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400919</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400919:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span><span class="w">                   </span><span class="c1"># 栈上开辟空间</span>
<span class="w">  </span><span class="err">400921:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">                 </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">         </span><span class="c1"># 输入首地址入栈</span>
<span class="w">  </span><span class="err">400925:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># eax = 0</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># 64 位的 0 入栈</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">e:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 32 位的 0 入栈</span>
<span class="w">  </span><span class="err">400935:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax 指向 64 位的 0</span>
<span class="w">  </span><span class="err">400939:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rcx</span><span class="w">               </span><span class="c1"># rcx 指向 -0xc(%rbp) 的地址</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">             </span><span class="c1"># rdx 指向 64 位的 0</span>
<span class="w">  </span><span class="err">400941:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = rdi</span>
<span class="w">  </span><span class="err">400945:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">53</span><span class="w"> </span><span class="mi">0</span><span class="no">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x400b53</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># esi 指向 &quot;%d %d&quot; 常量的首地址</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                    </span><span class="c1"># rdi = rax，都指向了输入首地址</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">d:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># eax 初始化为 0</span>
<span class="w">  </span><span class="err">400952:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">d9</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400630</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span><span class="w"> </span><span class="c1"># 调用 sscanf，注意第一个参数的地址为 %rdx</span>
<span class="w">  </span><span class="err">400957:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">02</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x2</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># sscanf 返回值与 0x2 比较</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">a:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400963</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x4a</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 相等则跳转</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">c:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 不相等就将 eax 设为 0</span>
<span class="w">  </span><span class="err">400961:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">19</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">40097c</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x63</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 然后退出函数，表示输入错误</span>
<span class="w">  </span><span class="err">400963:</span><span class="w">   </span><span class="nf">f2</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">          </span><span class="no">movsd</span><span class="w">  </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%xmm0</span><span class="w">            </span><span class="c1"># a b 两个数被拼在一起解释为一个 64 位浮点数</span>
<span class="w">  </span><span class="err">400968:</span><span class="w">   </span><span class="nf">f2</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">2</span><span class="no">c</span><span class="w"> </span><span class="no">c0</span><span class="w">             </span><span class="no">cvttsd2si</span><span class="w"> </span><span class="nv">%xmm0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                </span><span class="c1"># 将双精度浮点数 %xmm0 截断转换为有符号整数存入 %eax</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">c:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0x4(%rbp) = eax</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">f:</span><span class="w">   </span><span class="err">81</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">38</span><span class="w"> </span><span class="mi">39</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="no">f3</span><span class="w">    </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0xf3303938</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">       </span><span class="c1"># 相当于 eax 和 0xf3303938 比较</span>
<span class="w">  </span><span class="err">400976:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                          </span><span class="c1"># 两值相等，将 al 设为 1</span>
<span class="w">  </span><span class="err">400979:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># al 零扩展赋值给 eax 作为返回值</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">c:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">40097</span><span class="no">d</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">40097</span><span class="no">e</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">90</span><span class="w">                   </span><span class="no">xchg</span><span class="w">   </span><span class="nv">%ax</span><span class="p">,</span><span class="nv">%ax</span>
</code></pre></div></td></tr></table></div>
<details class="tip">
<summary>前置知识：<code>sscanf</code> 函数</summary>
<p>sscanf 函数的签名：<code class="highlight"><span class="kt">int</span><span class="w"> </span><span class="n">sscanf</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span></code> </p>
<p>其中 ... 表示可变参数，存储解析结果的变量地址</p>
<p>i386 约定中，<code>__isoc99_sscanf@plt</code> 的参数使用如下：</p>
<p><code>%rax</code> 存储返回值（这是函数共同的约定）</p>
<p><code>%rdi</code> 存储输入字符串</p>
<p><code>%rsi</code> 存储格式字符串</p>
<p><code>%rdx</code> 存储第一个变量地址</p>
<p><code>%rcx</code> 存储第二个变量地址</p>
<p><code>%r8</code>, <code>%r9</code> 等寄存器存储接下来的变量地址</p>
<p>接下来如果还有变量地址需要存储就使用栈存储 (%rsp)</p>
<p>在上面的约定下，假设我的输入为 <code>1 2.0 3.0 4</code>，格式字符串为 <code>%d %f %d %d</code>，那么 <code>rax = 2</code>，<code>%rdx</code> 指向 int 值 1 的地址，<code>%rcx</code> 指向 float 值 2.0 的地址，后续参数对应的变量不会被赋值</p>
<p><code>sscanf</code> 在第一次失配后就不会继续往下匹配，所以 <code>4</code> 虽然和 <code>%d</code> 匹配，但是不会被 <code>sscanf</code> 匹配</p>
<div class="admonition success">
<p class="admonition-title"><code>sscanf</code> 函数之后会多次用到，所以务必记住其用法；看到很多 <code>lea</code> 指令加 <code>mov</code> 指令的基本上都是为 <code>sscanf</code> 做准备，不要因此被栈上操作绕晕了</p>
</div>
</details>
<p><code>&lt;__isoc99_sscanf@plt&gt;</code> 的返回值和 C 语言 <code>sscanf</code> 一样，返回格式字符串匹配成功的个数，这里 <code>esi</code> 指向硬编码串 <code>%d %d</code>，结合 <code>cmp</code> 函数，说明我的输入必须满足 <code>%d %d</code> 的格式（也就是两个 int 数用空格分隔），这样 <code>sscanf</code> 返回值为 2 才是正确的</p>
<p>在这之后 <code>%rdx</code> 与 <code>%rcx</code> 分别指向了我的输入中的两个 int 数，接下来的这条命令非常关键</p>
<p>--&gt; <code class="highlight"><span class="nf">movsd</span><span class="w"> </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%xmm0</span></code></p>
<p>我们知道之前调度内存时有：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">lea</span><span class="w">    </span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rcx</span><span class="w">               </span><span class="c1"># rcx 指向 -0xc(%rbp) 的地址</span>
<span class="nf">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">             </span><span class="c1"># rdx 指向 -0x10(%rbp) 的地址，这两个地址恰好是连续的</span>
</code></pre></div></td></tr></table></div>
<p><code>movsd -0x10(%rbp),%xmm0</code> 需要一个 64 位的数字解释为浮点数传入 <code>%xmm0</code>，因此这两个整数会“拼接”为一个 64 位的数，（类型双关）解释为双精度浮点数之后再截断取整，结果与 <code>0xf3303938</code> 常数进行比较</p>
<p>（注意 <code>movsd  -0x10(%rbp),%xmm0</code> 不是类型转换，它是从字节方向解释为了双精度浮点数，不会有精度损失）</p>
<p>那么我们如何写出正确答案呢？逆向计算： <code>0xf3303938</code> 转换为有符号整数： <code>-214943432</code>，转换为浮点数 <code>-214943432.0</code>，这个浮点数用 IEEE 754 双精度浮点数表示为 <code>1 10000011010 100110011111100011011001000000000000</code>，即 <code>C1A99F8D 90000000</code>，拆开来用有符号十进制转换，得到 <code>-1045848179</code> 和 <code>-1879048192</code>，考虑到栈上存储方向，这两个数字还要交换顺序</p>
<p><strong>Answer: <code>-1879048192 -1045848179</code></strong></p>
<h3 id="phase-3">Phase 3: 循环</h3>
<p>为了方便阅读，将一段长代码的各个子部分通过换行符分隔</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">Z00000000004008df</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">df:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># %rdi 入栈，记输入字符串为 input[]</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">eb:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = rdi</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ef:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f2:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">b9</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4005b0</span> <span class="p">&lt;</span><span class="no">strlen@plt</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 调用 strlen，返回值 %rax 为长度</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">05</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># 长度与 5 比较</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fb:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">0</span><span class="nf">a</span><span class="w">                   </span><span class="no">je</span><span class="w">     </span><span class="mh">400907</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x28</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 相等则跳转到下一步</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fd:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 不相等则 phase 函数返回 0，表示 WA</span>
<span class="w">  </span><span class="err">400902:</span><span class="w">   </span><span class="nf">e9</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400990</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xb1</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">400907:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># 下一步：</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">b:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax 存储了输入的第一个 ASCII 字符（零扩展 32 位）</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">e:</span><span class="w">   </span><span class="err">3</span><span class="nf">c</span><span class="w"> </span><span class="mi">77</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x77</span><span class="p">,</span><span class="nv">%al</span><span class="w">                    </span><span class="c1"># 取低八位与 0x77 比较</span>
<span class="w">  </span><span class="err">400910:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400919</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x3a</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 也就是说输入的第一个字符必须是 &#39;w&#39;</span>
<span class="w">  </span><span class="err">400912:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 否则返回 WA</span>
<span class="w">  </span><span class="err">400917:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">77</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400990</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xb1</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">400919:</span><span class="w">   </span><span class="nf">c6</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fb</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">movb</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x5</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 下一步，将 1bit 1 存储至 (%rbp -5) ,记这个变量为 j</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">d:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 将循环计数器初始化为 1，记这个变量为 i</span>
<span class="w">  </span><span class="err">400924:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">5</span><span class="no">f</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400985</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xa6</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 进入循环体</span>

<span class="w">  </span><span class="err">400926:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">400929:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%rdx</span><span class="w">                    </span><span class="c1"># eax 符号扩展到 64 位存入 rdx</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = rdi （input 的首地址）</span>
<span class="w">  </span><span class="err">400930:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax += i</span>
<span class="w">  </span><span class="err">400933:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax = input[i]，取 ASCII 值 </span>
<span class="w">  </span><span class="err">400936:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">be</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movsbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># 确保是基于 ASCII 低八位的符号扩展</span>
<span class="w">                                                                        </span><span class="c1"># ASCII 可显示字符的符号位一定为 0,所以相当于零扩展</span>
<span class="w">  </span><span class="err">400939:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%edx</span><span class="w">              </span><span class="c1"># edx = i</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">d2</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%rdx</span><span class="w">                    </span><span class="c1"># edx 符号扩展到 64 位</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">a</span><span class="w"> </span><span class="no">ff</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x1</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%rcx</span><span class="w">              </span><span class="c1"># rcx = i - 1</span>
<span class="w">  </span><span class="err">400943:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">             </span><span class="c1"># rdx 指向 input[0]</span>
<span class="w">  </span><span class="err">400947:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">ca</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rcx</span><span class="p">,</span><span class="nv">%rdx</span><span class="w">                    </span><span class="c1"># rdx 指向 input[i-1]</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">a:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">12</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%edx</span><span class="w">                  </span><span class="c1"># edx = input[i-1]，取 ASCII 值</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">d:</span><span class="w">   </span><span class="nf">d0</span><span class="w"> </span><span class="no">fa</span><span class="w">                   </span><span class="no">sar</span><span class="w">    </span><span class="nv">%dl</span><span class="w">                          </span><span class="c1"># 算术右移一位</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">f:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">be</span><span class="w"> </span><span class="no">d2</span><span class="w">                </span><span class="no">movsbl</span><span class="w"> </span><span class="nv">%dl</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                     </span><span class="c1"># 扩展至 32 位</span>
<span class="w">  </span><span class="err">400952:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">4</span><span class="no">a</span><span class="w"> </span><span class="mi">20</span><span class="w">                </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x20</span><span class="p">(</span><span class="nv">%rdx</span><span class="p">),</span><span class="nv">%ecx</span><span class="w">              </span><span class="c1"># ecx = edx + 32 = input[i-1] / 2 + 32 （纯数值计算）</span>
<span class="w">  </span><span class="err">400955:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">fb</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">-0</span><span class="no">x5</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%edx</span><span class="w">              </span><span class="c1"># edx = j</span>
<span class="w">  </span><span class="err">400959:</span><span class="w">   </span><span class="err">31</span><span class="w"> </span><span class="nf">ca</span><span class="w">                   </span><span class="no">xor</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                    </span><span class="c1"># edx = ecx XOR edx</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">b:</span><span class="w">   </span><span class="err">39</span><span class="w"> </span><span class="nf">d0</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 和 eax (= input[i]) 比较</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">d:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400966</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x87</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 不相等则 WA</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400964:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">2</span><span class="no">a</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400990</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xb1</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400966:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fb</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">-0</span><span class="no">x5</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = j</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">a:</span><span class="w">   </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span><span class="w">               </span><span class="c1"># edx = j + 1</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">d:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">d0</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># eax = j + 1</span>
<span class="w">                                                                        </span><span class="c1"># 接下来的步骤都在计算 (j + 1) % 32 的值 ，存入 j</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">f:</span><span class="w">   </span><span class="nf">c1</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w">                </span><span class="no">sar</span><span class="w">    </span><span class="no">$0x1f</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># eax 算术右移 31 位，即复制符号位为所有数位</span>
<span class="w">  </span><span class="err">400972:</span><span class="w">   </span><span class="nf">c1</span><span class="w"> </span><span class="no">e8</span><span class="w"> </span><span class="mi">1</span><span class="no">b</span><span class="w">                </span><span class="no">shr</span><span class="w">    </span><span class="no">$0x1b</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># 进行逻辑右移 27 位，即只取低四位</span>
<span class="w">                                                                        </span><span class="c1"># 即 eax = (j + 1 &gt;= 0 ? 0 : 31)</span>
<span class="w">  </span><span class="err">400975:</span><span class="w">   </span><span class="err">01</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">add</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                    </span><span class="c1"># edx += eax</span>
<span class="w">  </span><span class="err">400977:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e2</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w">                </span><span class="no">and</span><span class="w">    </span><span class="no">$0x1f</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                   </span><span class="c1"># edx %= 32</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">a:</span><span class="w">   </span><span class="err">29</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">sub</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                    </span><span class="c1"># edx -= eax</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">c:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">d0</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># eax = edx</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">e:</span><span class="w">   </span><span class="err">88</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fb</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%al</span><span class="p">,-</span><span class="mi">0x5</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">               </span><span class="c1"># j = eax 低八位</span>
<span class="w">  </span><span class="err">400981:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fc</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">addl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 循环计数器 i++</span>
<span class="w">  </span><span class="err">400985:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x4</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># if(i &lt;= 4)</span>
<span class="w">  </span><span class="err">400989:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="mi">9</span><span class="no">b</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">400926</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x47</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># go_back</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">b:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400990:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">400991</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">400992</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">2</span><span class="no">e</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cs</span><span class="w"> </span><span class="no">nopw</span><span class="w"> </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="err">400999:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">40099</span><span class="nl">c:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">             </span><span class="no">nopl</span><span class="w">   </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>循环语句之前的操作很显然：判断输入是否为长度为 5 的字符串，并且第一个字符必须为 <code>w</code></p>
<p>并且我们发现，这样的语句很明显和 CSAPP 中的 <code>explode_bomb</code> 函数等效：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                                </span><span class="c1"># 返回值 0</span>
<span class="nf">jmp</span><span class="w">    </span><span class="err">&lt;</span><span class="no">an</span><span class="w"> </span><span class="no">address</span><span class="w"> </span><span class="no">where</span><span class="w"> </span><span class="err">&#39;</span><span class="no">leave</span><span class="err">&#39;</span><span class="w"> </span><span class="no">is</span><span class="w"> </span><span class="no">put</span><span class="err">&gt;</span><span class="w">        </span><span class="c1"># 跳转到 phase 函数结尾，输出失败结果</span>
</code></pre></div></td></tr></table></div>
<p>在分析循环语句时，我们重点关注是否有 <code>jle</code> 或者 <code>jne</code> 语句，并且这个跳转语句向回跳转，比如这句：</p>
<p>--&gt; <code>400989: 7e 9b jle 400926 &lt;phase+0x47&gt;</code> </p>
<p>我们在这句指令之前可以找到：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">40091</span><span class="nl">d:</span><span class="w"> </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="na">...</span>
<span class="err">400981:</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fc</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">addl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="err">400985:</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x4</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="err">400989:</span><span class="w"> </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="mi">9</span><span class="no">b</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">400926</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x47</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>以上我们获得的信息：</p>
<ul>
<li><code>400926</code> ~ <code>400989</code> 为循环体</li>
<li>循环体对应的 <code>for</code> 函数为 <code class="highlight"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span></code></li>
</ul>
<p>在循环体内的语句应该比较显然，值得注意的是这样的结构：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">mov</span><span class="w"> </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">    </span><span class="c1"># rax = rdi （input 的首地址）</span>
<span class="nf">add</span><span class="w"> </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">           </span><span class="c1"># 给 rax 加上了偏移值 i</span>
</code></pre></div></td></tr></table></div>
<p>这是遍历一个数组/字符串的典型写法</p>
<p>循环体内的代码可以用 C 语言这样表示，其中记 <code>-0x4(%rbp)</code> 存储值为 <code>i</code>，<code>-0x5(%rbp)</code> 存储值为 <code>j</code>，输入的字符串为一个 char 数组 <code>input[]</code>：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">((</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="mi">-1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">){</span><span class="w">  </span><span class="c1">// 这里是低八位比较</span>
<span class="w">         </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">FAIL</span><span class="p">();</span>
<span class="p">}</span>
<span class="n">SUCCEED</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>手推循环：<code>input[0] = 'w' = 0x77</code> </p>
<p>--&gt; <code>input[1] = ((0x77 &gt;&gt; 1) + 32) ^ 1 = 91 ^ 1 = 0b01011010 = 'Z' = 90</code> </p>
<p>--&gt; <code>input[2] = ((90 &gt;&gt; 1) + 32) ^ 2 = 77 ^ 2 = 0b01001111 = 'O' = 79</code> </p>
<p>--&gt; <code>input[3] = ((79 &gt;&gt; 1) + 32) ^ 3 = 71 ^ 3 = 0b01000100 = 'D' = 68</code> </p>
<p>--&gt; <code>input[4] = ((68 &gt;&gt; 1) + 32) ^ 4 = 66 ^ 4 = 0b01000110 = 'F' = 70</code> </p>
<p>Answer: <code>wZODF</code></p>
<h3 id="phase-4">Phase 4: 选择（条件分支）</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">00000000004008</span><span class="nf">a4</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">a4:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">a5:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">a8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># %rdi 入栈，记输入字符串为 input[]</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ac:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 0 入栈，我们记这个变量为 j</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">b3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = rdi</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">b7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0x8(%rbp) = rax，我们记这个变量为 i</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">bb:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">5</span><span class="no">e</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">40091b</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x77</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">4008</span><span class="nl">bd:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = i</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">c1:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax = *i = input[i]</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">c4:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">be</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movsbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># 取 input[i] 低八位</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">c7:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e8</span><span class="w"> </span><span class="mi">41</span><span class="w">                </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x41</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># input[i] -= 65</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ca:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># input[i] - 65 &gt; 5，则跳转到 400916 </span>
<span class="w">  </span><span class="err">4008</span><span class="nl">cd:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">47</span><span class="w">                   </span><span class="nf">ja</span><span class="w">     </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1">#（注意是无符号比较）</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">cf:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 否则 input[i] &lt;= 70：</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">0</span><span class="no">b</span><span class="w"> </span><span class="mi">40</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x400b20</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="nv">%rax</span><span class="w">       </span><span class="c1"># rax = 0x4008db + 8 * (input[i] - 65)（存地址）</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d8:</span><span class="w">   </span><span class="err">00</span><span class="w">                                                          </span><span class="c1"># （gdb 得到 0x400b20 处存储的是 0x4008db）</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d9:</span><span class="w">   </span><span class="nf">ff</span><span class="w"> </span><span class="no">e0</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="p">*</span><span class="nv">%rax</span><span class="w">                        </span><span class="c1"># 跳转到 rax 存储的地址</span>

<span class="w">  </span><span class="err">4008</span><span class="nl">db:</span><span class="w">   </span><span class="err">81</span><span class="w"> </span><span class="err">65</span><span class="w"> </span><span class="nf">f4</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="mi">7</span><span class="no">f</span><span class="w">    </span><span class="no">andl</span><span class="w">   </span><span class="no">$0x7fffffff</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">       </span><span class="c1"># j 清除符号位为 0</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e2:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">32</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400916 </span>

<span class="w">  </span><span class="err">4008</span><span class="nl">e4:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = j</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e7:</span><span class="w">   </span><span class="err">0</span><span class="nf">d</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">80</span><span class="w">          </span><span class="no">or</span><span class="w">     </span><span class="no">$0x80000000</span><span class="p">,</span><span class="nv">%eax</span><span class="w">             </span><span class="c1"># eax 符号位强制为 1</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ec:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j 符号位强制为 1</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ef:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">25</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400916 </span>

<span class="w">  </span><span class="err">4008</span><span class="nl">f1:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="mi">00</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j == 0 ?</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f5:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                          </span><span class="c1"># (j == 0) ? al = 1 : al = 0;</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f8:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># 零扩展</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fb:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j = (j == 0) ? 1 : 0;</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fe:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">16</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400916 </span>

<span class="w">  </span><span class="err">400900:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = j</span>
<span class="w">  </span><span class="err">400903:</span><span class="w">   </span><span class="err">35</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">80</span><span class="w">          </span><span class="nf">xor</span><span class="w">    </span><span class="no">$0x80000000</span><span class="p">,</span><span class="nv">%eax</span><span class="w">             </span><span class="c1"># eax = -eax</span>
<span class="w">  </span><span class="err">400908:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j 翻转符号位</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">b:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">09</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400916</span>

<span class="w">  </span><span class="err">40090</span><span class="nl">d:</span><span class="w">   </span><span class="nf">d1</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">shll</span><span class="w">   </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">                   </span><span class="c1"># j &lt;&lt;= 1</span>
<span class="w">  </span><span class="err">400910:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">04</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400916</span>

<span class="w">  </span><span class="err">400912:</span><span class="w">   </span><span class="nf">d1</span><span class="w"> </span><span class="mi">7</span><span class="no">d</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">sarl</span><span class="w">   </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">                   </span><span class="c1"># j &gt;&gt;= 1 （算术右移）</span>
<span class="w">  </span><span class="err">400915:</span><span class="w">   </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span><span class="w">                                 </span><span class="c1"># 相当于跳转到 400916</span>

<span class="w">  </span><span class="err">400916:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">01</span><span class="w">          </span><span class="no">addq</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i++</span>

<span class="w">  </span><span class="err">40091</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = i</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">f:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax = *i</span>
<span class="w">  </span><span class="err">400922:</span><span class="w">   </span><span class="err">84</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%al</span><span class="w">                      </span><span class="c1"># eax 若不为 \0 就跳回循环（也就是需要遍历整个字符串）</span>
<span class="w">  </span><span class="err">400924:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">97</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">4008bd</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x19</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">400926:</span><span class="w">   </span><span class="err">81</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="mi">99</span><span class="w"> </span><span class="mi">57</span><span class="w"> </span><span class="mi">65</span><span class="w">    </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x65579927</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">       </span><span class="c1"># 比较 j 是否等于 $0x65579927</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">d:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                          </span><span class="c1"># 相等则输入正确</span>
<span class="w">  </span><span class="err">400930:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400933:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400934:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">400935</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">2</span><span class="no">e</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cs</span><span class="w"> </span><span class="no">nopw</span><span class="w"> </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">c:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">40093</span><span class="nl">f:</span><span class="w">   </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span>
</code></pre></div></td></tr></table></div>
<p>经过分析后不难发现，程序设置了变量 <code>j = 0</code>，之后对 <code>input[]</code> 进行遍历：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">4008</span><span class="nl">bd:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = i</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">c1:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax = *i = input[i]</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">c4:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">be</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movsbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># 取 input[i] 低八位</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">c7:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e8</span><span class="w"> </span><span class="mi">41</span><span class="w">                </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x41</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># input[i] -= 65</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ca:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># input[i] - 65 &gt; 5，则跳转到 400916 </span>
<span class="w">  </span><span class="err">4008</span><span class="nl">cd:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">47</span><span class="w">                   </span><span class="nf">ja</span><span class="w">     </span><span class="mh">400916</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x72</span><span class="p">&gt;</span><span class="w">          </span><span class="c1">#（注意是无符号比较，所以自然排除了 input[i] - 65 &lt; 0）</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">cf:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 否则 65 &lt;= input[i] &lt;= 70：</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">0</span><span class="no">b</span><span class="w"> </span><span class="mi">40</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x400b20</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="nv">%rax</span><span class="w">       </span><span class="c1"># rax = 0x4008db + 8 * (input[i] - 65)（存地址）</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d8:</span><span class="w">   </span><span class="err">00</span><span class="w">                                                          </span><span class="c1"># （gdb 得到 0x400b20 处存储的是 0x4008db）</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">d9:</span><span class="w">   </span><span class="nf">ff</span><span class="w"> </span><span class="no">e0</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="p">*</span><span class="nv">%rax</span><span class="w">                        </span><span class="c1"># 跳转到 rax 存储的地址</span>
</code></pre></div></td></tr></table></div>
<p>这里是一个<strong>跳转表</strong>的实现，当 <code>input[i]={65,66,...,70}</code> 时，分别对应了 <code>j</code> 的六种不同的计算操作，用 C++ 语言描述为：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">int32_t</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="nf">sign</span><span class="p">(</span><span class="n">j</span><span class="p">);</span><span class="w"> </span><span class="c1">// sign(j) 取 j 的符号位的引用</span>

<span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">input</span><span class="p">){</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">opr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">65</span><span class="p">;</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">opr</span><span class="p">){</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">            </span><span class="n">sign</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">            </span><span class="n">sign</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">3</span><span class="p">:</span>
<span class="w">            </span><span class="n">sign</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">sign</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">4</span><span class="p">:</span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="mi">5</span><span class="p">:</span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>而最终 <code>cmpl $0x65579927,-0xc(%rbp)</code>，我们希望 <code>j</code> 在一轮计算后结果为 <code>0x65579927</code>，据此构造一个 opr 链，使得：</p>
<p><code>0b0</code> --&gt; <code>0b 0110 0101 0101 0111 1001 1001 0010 0111</code></p>
<p>这里给出一个只利用算数右移和翻转符号位来自定义任意数位的方法：</p>
<p><code>opr = [3]</code> --&gt; <code>0b 1000 0000</code></p>
<p><code>opr += [5,5,5]</code> --&gt; <code>0b 1111 0000</code></p>
<p><code>opr += [3]</code> --&gt; <code>0b 0111 0000</code></p>
<p><code>opr += [5,5]</code> --&gt; <code>0b 0001 1100</code></p>
<p><code>opr += [3]</code> --&gt; <code>0b 1001 1100</code></p>
<p><code>opr += [5]</code> --&gt; <code>0b 1100 1110</code></p>
<p><code>opr += [3]</code> --&gt; <code>0b 0100 1110</code></p>
<p><code>opr += [5]</code> --&gt; <code>0b 0010 0111</code></p>
<p>上面的操作中，<code>j</code> 的最高八位已经被设定为了 <code>0x65579927</code> 的低八位，只要持续按照上面的模式生成，就可以得到任意需要的值</p>
<p>不难得到完整的 opr 链为</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>[3,5,5,5] + [3,5,5] + [3,5] + [3,5,5] + [3,5] + [3,5,5] + [3,5,5] + [3,5,5] + [3,5,5,5,5] + [3,5] + [3,5] + [3,5] + [3,5] + [3,5] + [3,5] + [3,5] + [3,5] + [3,5,5] + [3,5,5] + [3]`
</code></pre></div></td></tr></table></div>
<p>不难看出上面的 opr 链的构造规律，注意最后没有 <code>5</code>，最后每个数字加上 65 映射到 ASCII 表上得到答案：</p>
<div class="admonition tip">
<p class="admonition-title">利用 gdb 的动态调试</p>
<p>你可以通过打断点 --&gt; 查内存的方式获取程序运行到某一个时间点时，某一处内存的值</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code>(gdb) break *0x400926
Breakpoint 1 at 0x400926
(gdb) run
Starting program: /home/nopthon/icslab/phase4 
[Thread debugging using libthread_db enabled]
Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.
Welcome to the binary program analysis lab.
Here begins the task. Please input your answer ...
DFFFDFFDFDFFDFDFFDFFDFFDFFFFDFDFDFDFDFDFDFDFDFFDFFD

Breakpoint 1, 0x0000000000400926 in phase ()
(gdb) x/wx $rbp - 0xc       # 查询了 -0xc(%rbp) 的值
0x7fffffffdc84: 0x65579927
(gdb) continue
Continuing.
Congratulations! You&#39;ve completed phase 4 successfully.
[Inferior 1 (process 10462) exited normally]
</code></pre></div></td></tr></table></div>
</div>
<p><strong>Answer: <code>DFFFDFFDFDFFDFDFFDFFDFFDFFFFDFDFDFDFDFDFDFDFDFFDFFD</code></strong>（不唯一）</p>
<h3 id="phase-5">Phase 5: 递归调用</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400969</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400969:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400971:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400975:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">fc</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">400979:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">d:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">93</span><span class="w"> </span><span class="mi">0</span><span class="no">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x400b93</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># 模式字符串 &quot;%x&quot;，读取一个 16 进制数</span>
<span class="w">  </span><span class="err">400982:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400985:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">a:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">a1</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400630</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span><span class="w"> </span><span class="c1"># 模式匹配</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">f:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400992:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40099b</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x32</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 输入必须为一个 16 进制数，地址存入 %rdx</span>
<span class="w">  </span><span class="err">400994:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400999:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">1</span><span class="no">d</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009b8</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x4f</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">40099</span><span class="nl">b:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = 输入的 16 进制数本身，记为 input</span>
<span class="w">  </span><span class="err">40099</span><span class="nl">e:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                   </span><span class="c1"># edx = 32</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a3:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">a0</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6011a0</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># esi = 数组 number_list 的首地址，简称为 nums</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a8:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%edi</span><span class="w">                    </span><span class="c1"># edi = eax = input</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">aa:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">4</span><span class="no">b</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008fa</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">&gt;</span><span class="w">                </span><span class="c1"># 调用递归函数 seek（函数名暗示作用为搜索值）</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">af:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">2</span><span class="no">e</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x2e</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                   </span><span class="c1"># 返回值 eax 与 46 比较</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b2:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                          </span><span class="c1"># 相等则输入正确，否则输入错误</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b5:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b8:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">4009</span><span class="no">b9</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">4009</span><span class="no">ba</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">       </span><span class="no">nopw</span><span class="w">   </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="w">  </span><span class="err">00000000004008</span><span class="nf">fa</span><span class="w"> </span><span class="err">&lt;</span><span class="no">seek</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fa:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fb:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fe:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x10</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400902:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0x4(%rbp) = edi，记为变量 x，初始值 input</span>
<span class="w">  </span><span class="err">400905:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">75</span><span class="w"> </span><span class="nf">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># -0x10(%rbp) = rsi，记为变量 y，初始值 &amp;nums[0]</span>
<span class="w">  </span><span class="err">400909:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">55</span><span class="w"> </span><span class="nf">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0x8(%rbp) = edx，记为变量 z，初始值 32</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">c:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># z &gt; 1 ?</span>
<span class="w">  </span><span class="err">400910:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">08</span><span class="w">                   </span><span class="nf">ja</span><span class="w">     </span><span class="mh">40091a</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">+</span><span class="mi">0x20</span><span class="p">&gt;</span><span class="w">           </span><span class="c1"># z &gt; 1 则跳转</span>

<span class="w">  </span><span class="err">400912:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = y</span>
<span class="w">  </span><span class="err">400916:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">00</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># rax = nums[y]</span>
<span class="w">  </span><span class="err">400918:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">4</span><span class="no">d</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400967</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">+</span><span class="mi">0x6d</span><span class="p">&gt;</span><span class="w">           </span><span class="c1"># 退出函数</span>

<span class="w">  </span><span class="err">40091</span><span class="nl">a:</span><span class="w">   </span><span class="nf">d1</span><span class="w"> </span><span class="mi">6</span><span class="no">d</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">shrl</span><span class="w">   </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">                   </span><span class="c1"># z 右移一位</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">d:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = x</span>
<span class="w">  </span><span class="err">400920:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">e0</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">and</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># eax = lowest_bit(x)</span>
<span class="w">  </span><span class="err">400923:</span><span class="w">   </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">test</span><span class="w">   </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># lowest_bit(x) == 0 ?</span>
<span class="w">  </span><span class="err">400925:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">28</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40094f</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">+</span><span class="mi">0x55</span><span class="p">&gt;</span><span class="w">           </span><span class="c1"># lowest_bit(x) == 0 则跳转，这里是二选一的分支</span>
<span class="w">                                                                        </span><span class="c1"># 可以推测是二分操作</span>

<span class="w">  </span><span class="err">400927:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = z</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x0</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">            </span><span class="c1"># rdx = 4 * z，注意 4 = sizeof(int)</span>
<span class="w">  </span><span class="err">400931:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">400932:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = y</span>
<span class="w">  </span><span class="err">400936:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">34</span><span class="w"> </span><span class="mi">02</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="p">(</span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nv">%rsi</span><span class="w">           </span><span class="c1"># rsi = y + z = &amp;nums[z]</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">a:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = x</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">d:</span><span class="w">   </span><span class="nf">d1</span><span class="w"> </span><span class="no">e8</span><span class="w">                   </span><span class="no">shr</span><span class="w">    </span><span class="nv">%eax</span><span class="w">                         </span><span class="c1"># eax &gt;&gt;= 1</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">f:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c1</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%ecx</span><span class="w">                    </span><span class="c1"># ecx = x &gt;&gt; 1</span>
<span class="w">  </span><span class="err">400941:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = z</span>
<span class="w">  </span><span class="err">400944:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%edx</span><span class="w">                    </span><span class="c1"># edx = z</span>
<span class="w">  </span><span class="err">400946:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">cf</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%edi</span><span class="w">                    </span><span class="c1"># edi = x &gt;&gt; 1</span>
<span class="w">  </span><span class="err">400948:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">ad</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008fa</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">&gt;</span><span class="w">                </span><span class="c1"># 将上面的寄存器值作为参数进行下一层递归</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">d:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">18</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400967</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">+</span><span class="mi">0x6d</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">40094</span><span class="nl">f:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = x</span>
<span class="w">  </span><span class="err">400952:</span><span class="w">   </span><span class="nf">d1</span><span class="w"> </span><span class="no">e8</span><span class="w">                   </span><span class="no">shr</span><span class="w">    </span><span class="nv">%eax</span><span class="w">                         </span><span class="c1"># eax = x &gt;&gt; 1</span>
<span class="w">  </span><span class="err">400954:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c1</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%ecx</span><span class="w">                    </span><span class="c1"># ecx = x &gt;&gt; 1</span>
<span class="w">  </span><span class="err">400956:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%edx</span><span class="w">              </span><span class="c1"># edx = z</span>
<span class="w">  </span><span class="err">400959:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = y</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rsi</span><span class="w">                    </span><span class="c1"># rsi = y</span>
<span class="w">  </span><span class="err">400960:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">cf</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%ecx</span><span class="p">,</span><span class="nv">%edi</span><span class="w">                    </span><span class="c1"># edi = x &gt;&gt; 1</span>
<span class="w">  </span><span class="err">400962:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">93</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008fa</span> <span class="p">&lt;</span><span class="no">seek</span><span class="p">&gt;</span><span class="w">                </span><span class="c1"># 将上面的寄存器值作为参数进行下一层递归</span>
<span class="w">  </span><span class="err">400967:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">400968</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span>

<span class="c1"># 从 0x6011a0 开始的数组 number_list</span>
<span class="c1"># (gdb) x/32w 0x6011a0</span>
<span class="c1"># 其实应该用 x/128b 的</span>
<span class="err">0</span><span class="nf">x6011a0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x00000068</span><span class="w">  </span><span class="mi">0x00000049</span><span class="w">  </span><span class="mi">0x00000066</span><span class="w">  </span><span class="mi">0x00000014</span>
<span class="err">0</span><span class="nf">x6011b0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">16</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x0000005a</span><span class="w">  </span><span class="mi">0x00000012</span><span class="w">  </span><span class="mi">0x00000030</span><span class="w">  </span><span class="mi">0x00000065</span>
<span class="err">0</span><span class="nf">x6011c0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">32</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x0000001b</span><span class="w">  </span><span class="mi">0x00000011</span><span class="w">  </span><span class="mi">0x0000006a</span><span class="w">  </span><span class="mi">0x0000000d</span>
<span class="err">0</span><span class="nf">x6011d0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x0000004e</span><span class="w">  </span><span class="mi">0x00000015</span><span class="w">  </span><span class="mi">0x0000006c</span><span class="w">  </span><span class="mi">0x0000000b</span>
<span class="err">0</span><span class="nf">x6011e0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">64</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x00000073</span><span class="w">  </span><span class="mi">0x00000005</span><span class="w">  </span><span class="mi">0x00000029</span><span class="w">  </span><span class="mi">0x00000045</span>
<span class="err">0</span><span class="nf">x6011f0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">80</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x00000020</span><span class="w">  </span><span class="mi">0x00000040</span><span class="w">  </span><span class="mi">0x00000074</span><span class="w">  </span><span class="mi">0x00000032</span>
<span class="err">0</span><span class="nf">x601200</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">96</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x00000025</span><span class="w">  </span><span class="mi">0x0000005d</span><span class="w">  </span><span class="mi">0x0000007f</span><span class="w">  </span><span class="mi">0x00000059</span>
<span class="err">0</span><span class="nf">x601210</span><span class="w"> </span><span class="err">&lt;</span><span class="no">number_list</span><span class="err">+</span><span class="mi">112</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="mi">0x00000070</span><span class="w">  </span><span class="mi">0x00000026</span><span class="w">  </span><span class="mi">0x0000003c</span><span class="w">  </span><span class="mi">0x0000002e</span><span class="w"> </span><span class="c1"># &lt;-- 注意最后一个元素是 cmp $0x2e,%eax 的应匹配值</span>
</code></pre></div></td></tr></table></div>
<p>题目要求输入一个 16 进制数，然后进行对 <code>&lt;number_list&gt;</code> 的递归查找：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="cm">/*-0x4(%rbp) 记为变量 x，由 edi 传递，第一次调用 seek 函数时初始值 input</span>
<span class="cm">* -0x10(%rbp)记为变量 y，由 rsi 传递，第一次调用 seek 函数时初始值 &amp;nums[0]</span>
<span class="cm">* -0x8(%rbp) 记为变量 z，由 edx 传递，第一次调用 seek 函数时初始值 32</span>
<span class="cm">*/</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">seek</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">*</span><span class="n">y</span>

<span class="w">    </span><span class="n">z</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">                </span><span class="c1">// z 一开始为数组的长度，每次递归时减半</span>
<span class="w">                            </span><span class="c1">// nums[z] 为取半后数组的中点元素</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">seek</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w">    </span><span class="c1">// y+z 表示“右半元素首地址”</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">seek</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w">      </span><span class="c1">// y 表示 “左半元素首地址”</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>递归结束后，我们需要比较的是 <code>cmp $0x2e,%eax</code>，对应了数组的最后一个元素。因此在递归二分时，我们应该确保每一次的 <code>(x &amp; 1)</code> 都成立</p>
<p><code>z = 32</code>，因此需要 <code>x</code> 的低五位都为 <code>1</code>，而 <code>x</code> 的初始值为我的 16 进制输入，因此答案要求输入的 16 进制数的低五位都为 <code>1</code></p>
<p><strong>Answer: <code>0x1f</code></strong>（不唯一）</p>
<h3 id="phase-6">Phase 6: 数组</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400921</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400921:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400922:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400925:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">30</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x30</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400929:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400931:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c7</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="no">c0</span><span class="w"> </span><span class="mi">11</span><span class="w">    </span><span class="no">movq</span><span class="w">   </span><span class="no">$0x6011c0</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rsp</span><span class="p">)</span><span class="w">              </span>
<span class="w">  </span><span class="mi">400938</span><span class="p">:</span><span class="w">   </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span>
<span class="w">  </span><span class="mi">40093</span><span class="no">a</span><span class="p">:</span><span class="w">   </span><span class="mi">48</span><span class="w"> </span><span class="no">c7</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="no">b4</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w">    </span><span class="no">movq</span><span class="w">   </span><span class="no">$0x6011b4</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400941:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">400942:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="nf">b9</span><span class="w"> </span><span class="no">bc</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">       </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6011bc</span><span class="p">,</span><span class="nv">%r9d</span>
<span class="w">  </span><span class="err">400948:</span><span class="w">   </span><span class="err">41</span><span class="w"> </span><span class="nf">b8</span><span class="w"> </span><span class="no">b0</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">       </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6011b0</span><span class="p">,</span><span class="nv">%r8d</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">e:</span><span class="w">   </span><span class="nf">b9</span><span class="w"> </span><span class="no">b8</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6011b8</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="w">  </span><span class="err">400953:</span><span class="w">   </span><span class="nf">ba</span><span class="w"> </span><span class="no">ac</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x6011ac</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">400958:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="no">c7</span><span class="w"> </span><span class="mi">0</span><span class="no">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x400bc7</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># 模式串：&quot;%u %u %u %u %u %u&quot;，六个无符号数</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400960:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400965:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">c6</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400630</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span><span class="w"> </span><span class="c1"># 应该不用解释了</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">06</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x6</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">d:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400976</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x55</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400974:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">78</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009ee</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xcd</span><span class="p">&gt;</span>

<span class="c1"># 此时的内存分布：</span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">3</span><span class="no">w</span><span class="w"> </span><span class="mi">0x6011ac</span>
<span class="err">0</span><span class="nf">x6011ac</span><span class="w"> </span><span class="err">&lt;</span><span class="no">rows</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="c1"># 对应的地址存储在      %edx        %r8d        (%rsp)</span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">3</span><span class="no">w</span><span class="w"> </span><span class="mi">0x6011b8</span>
<span class="err">0</span><span class="nf">x6011b8</span><span class="w"> </span><span class="err">&lt;</span><span class="no">cols</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span><span class="w">  </span><span class="mi">0x00000000</span>
<span class="c1"># 对应的地址存储在      %ecx        %r9d        0x8(%rsp)</span>

<span class="c1"># Tip: sscanf 依次将匹配的变量地址存入 %edx  %ecx  %r8d  %r9d  (%rsp)  0x8(%rsp) ...</span>

<span class="w">  </span><span class="err">400976:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 记 -0x4(%rbp) 变量为 i，初始化 i = 0</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">d:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">64</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009e3</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xc2</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 可以看得出来接下来是一个循环结构</span>

<span class="w">  </span><span class="err">40097</span><span class="nl">f:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">400982:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="no">ac</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x6011ac</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span><span class="w">       </span><span class="c1"># eax = raw[i]</span>
<span class="w">  </span><span class="err">400989:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">03</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x3</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># raw[i] 与 3 比较</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">c:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">0</span><span class="nf">f</span><span class="w">                   </span><span class="no">ja</span><span class="w">     </span><span class="mh">40099d</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x7c</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># raw[i] &gt; 3 （或者为负）则跳转到 Fail</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">e:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">400991:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="no">b8</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x6011b8</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span><span class="w">       </span><span class="c1"># eax = col[i]</span>
<span class="w">  </span><span class="err">400998:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">07</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x7</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># col[i] 与 7 比较</span>
<span class="w">  </span><span class="err">40099</span><span class="nl">b:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">4009a4</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x83</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 0 &lt;= col[i] &lt;= 7 时跳转，否则 Fail</span>

<span class="w">  </span><span class="err">40099</span><span class="nl">d:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># Fail</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a2:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">4</span><span class="no">a</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009ee</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xcd</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">4009</span><span class="nl">a4:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a7:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="no">ac</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x6011ac</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%edx</span><span class="w">       </span><span class="c1"># edx = raw[i]</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ae:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b1:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="no">b8</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x6011b8</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span><span class="w">       </span><span class="c1"># eax = col[i]</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b8:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">c0</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 有清零高 32 位的作用</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ba:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">d2</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">bc:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">d0</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="mi">60</span><span class="w">    </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x601160</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="nv">%edx</span><span class="w">   </span><span class="c1"># edx = (零扩展至 32 位)cmat[rows[i]][col[i]]</span>

<span class="c1"># 注意到 0x601160 处存储了一个二维数组（矩阵），根据标签提示判断数组元素大小为 1 byte</span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">32</span><span class="no">b</span><span class="w"> </span><span class="mi">0x601160</span>
<span class="err">0</span><span class="nf">x601160</span><span class="w"> </span><span class="err">&lt;</span><span class="no">cmat</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x70</span><span class="w">    </span><span class="mi">0x6f</span><span class="w">    </span><span class="mi">0x6b</span><span class="w">    </span><span class="mi">0x55</span><span class="w">    </span><span class="mi">0x49</span><span class="w">    </span><span class="mi">0x43</span><span class="w">    </span><span class="mi">0x68</span><span class="w">    </span><span class="mi">0x4c</span>
<span class="err">0</span><span class="nf">x601168</span><span class="w"> </span><span class="err">&lt;</span><span class="no">cmat</span><span class="err">+</span><span class="mi">8</span><span class="err">&gt;</span><span class="p">:</span><span class="w">  </span><span class="mi">0x4b</span><span class="w">    </span><span class="mi">0x4e</span><span class="w">    </span><span class="mi">0x4a</span><span class="w">    </span><span class="mi">0x5a</span><span class="w">    </span><span class="mi">0x58</span><span class="w">    </span><span class="mi">0x62</span><span class="w">    </span><span class="mi">0x61</span><span class="w">    </span><span class="mi">0x79</span>
<span class="err">0</span><span class="nf">x601170</span><span class="w"> </span><span class="err">&lt;</span><span class="no">cmat</span><span class="err">+</span><span class="mi">16</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="mi">0x64</span><span class="w">    </span><span class="mi">0x42</span><span class="w">    </span><span class="mi">0x71</span><span class="w">    </span><span class="mi">0x53</span><span class="w">    </span><span class="mi">0x41</span><span class="w">    </span><span class="mi">0x50</span><span class="w">    </span><span class="mi">0x47</span><span class="w">    </span><span class="mi">0x44</span>
<span class="err">0</span><span class="nf">x601178</span><span class="w"> </span><span class="err">&lt;</span><span class="no">cmat</span><span class="err">+</span><span class="mi">24</span><span class="err">&gt;</span><span class="p">:</span><span class="w"> </span><span class="mi">0x45</span><span class="w">    </span><span class="mi">0x56</span><span class="w">    </span><span class="mi">0x76</span><span class="w">    </span><span class="mi">0x6a</span><span class="w">    </span><span class="mi">0x72</span><span class="w">    </span><span class="mi">0x52</span><span class="w">    </span><span class="mi">0x54</span><span class="w">    </span><span class="mi">0x4f</span>

<span class="w">  </span><span class="err">4009</span><span class="nl">c3:</span><span class="w">   </span><span class="err">00</span><span class="w">                                                          </span><span class="c1"># 0x2007b5(%rip) 的值是原注释提供的</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">0</span><span class="no">d</span><span class="w"> </span><span class="no">b5</span><span class="w"> </span><span class="mi">07</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x2007b5</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rcx</span><span class="w">          </span><span class="c1"># rcx = 0x00400bc3，</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">cb:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ce:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">c8</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rcx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># eax = i + 0x00400bc3</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d1:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax = arr[i] （零扩展为 32 位）</span>

<span class="c1"># 注意到 i + 0x00400bc3 又是一个数组索引，通过 %al 判断数组元素大小为 1 byte</span>
<span class="c1"># 我们记这个数组为 arr</span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">3</span><span class="no">b</span><span class="w"> </span><span class="mi">0x400bc3</span>
<span class="err">0</span><span class="nl">x400bc3:</span><span class="w">   </span><span class="err">0</span><span class="nf">x55</span><span class="w">    </span><span class="mi">0x44</span><span class="w">    </span><span class="mi">0x6f</span>

<span class="w">  </span><span class="err">4009</span><span class="nl">d4:</span><span class="w">   </span><span class="err">38</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%dl</span><span class="w">                      </span><span class="c1"># arr[i] 与 cmat[rows[i]][col[i]] 比较</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d6:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">4009df</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xbe</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 如果相等就跳转，否则 Fail</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d8:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># Fail</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">dd:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009ee</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xcd</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">df:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fc</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">addl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i++</span>

<span class="w">  </span><span class="err">4009</span><span class="nl">e3:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">02</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x2</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i &lt;= 2 时持续循环</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e7:</span><span class="w">   </span><span class="err">76</span><span class="w"> </span><span class="err">96</span><span class="w">                   </span><span class="nf">jbe</span><span class="w">    </span><span class="mh">40097f</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x5e</span><span class="p">&gt;</span><span class="w">          </span>
<span class="w">  </span><span class="mi">4009</span><span class="no">e9</span><span class="p">:</span><span class="w">   </span><span class="no">b8</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 完成循环则 SUCCEED</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ee:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">4009</span><span class="no">ef</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span>
</code></pre></div></td></tr></table></div>
<p>简单来说，有一个二维数组 <code>cmat[3][8]</code> 和一个一维数组 <code>arr[22]</code>，我的六个无符号输入分别代表了三对 <code>cmat</code> 坐标，总共比较三次 <code>arr[i]</code> 与 <code>cmat[rows[i]][col[i]]</code> 要求都要相等</p>
<p>不难发现 <code>arr[0] == cmat[0][3]</code> <code>arr[1] == cmat[2][7]</code> <code>arr[2] == cmat[0][1]</code> ，据此得到答案</p>
<p><strong>Answer: <code>0 3 2 7 0 1</code></strong></p>
<h3 id="phase-7">Phase 7: 指针</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">00000000004009</span><span class="nf">f2</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f2:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">30</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x30</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">fa:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">d8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x28</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">fe:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 记变量 -0x8(%rbp) 为 j,初始化为 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a05:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x20</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a09:</span><span class="w">   </span><span class="err">4</span><span class="nf">c</span><span class="w"> </span><span class="mi">8</span><span class="no">d</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%r8</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a0d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x20</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a11:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">78</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a15:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x20</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a19:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">48</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rcx</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a1d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">e0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x20</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a21:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">d8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x28</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a25:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">d</span><span class="w"> </span><span class="mi">75</span><span class="w"> </span><span class="no">e0</span><span class="w">             </span><span class="no">lea</span><span class="w">    </span><span class="mi">-0</span><span class="no">x20</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a29:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">c6</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">add</span><span class="w">    </span><span class="no">$0x10</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a2d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">34</span><span class="w"> </span><span class="err">24</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,(</span><span class="nv">%rsp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a31:</span><span class="w">   </span><span class="err">4</span><span class="nf">d</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="no">c1</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%r8</span><span class="p">,</span><span class="nv">%r9</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a34:</span><span class="w">   </span><span class="err">49</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,</span><span class="nv">%r8</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a37:</span><span class="w">   </span><span class="nf">be</span><span class="w"> </span><span class="mi">93</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x400c93</span><span class="p">,</span><span class="nv">%esi</span><span class="w">               </span><span class="c1"># 模式串 &quot;%d %d %d %d %d&quot;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a3c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a3f:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a44:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">e7</span><span class="w"> </span><span class="no">fb</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">400630</span> <span class="p">&lt;</span><span class="no">__isoc99_sscanf@plt</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a49:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a4c:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400a55</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x63</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a4e:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a53:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">5</span><span class="no">a</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400aaf</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xbd</span><span class="p">&gt;</span>

<span class="c1"># 此时 5 个整数的存储位置，在之后会有作用</span>
<span class="c1"># -0x20(%rbp)   第一个数 nums[0]</span>
<span class="c1"># -0x1c(%rbp)   第二个数 nums[1]</span>
<span class="c1"># -0x18(%rbp)   第三个数 nums[2]</span>
<span class="c1"># -0x14(%rbp)   第四个数 nums[3]</span>
<span class="c1"># -0x10(%rbp)   第五个数 nums[4]</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a55:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># 记变量 -0x4(%rbp) 为 i,初始化为 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a5c:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">3</span><span class="no">e</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400a9c</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xaa</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a5e:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a61:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">98</span><span class="w">                   </span><span class="nf">cltq</span><span class="w">                                </span><span class="c1"># eax 符号扩展到 rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a63:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">85</span><span class="w"> </span><span class="no">e0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x20</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nv">%eax</span><span class="w">      </span><span class="c1"># eax = nums[i]</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a67:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0xc(%rbp) = nums[i]</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a6a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="mi">00</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># nums[i] 和 0 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a6e:</span><span class="w">   </span><span class="err">78</span><span class="w"> </span><span class="err">25</span><span class="w">                   </span><span class="nf">js</span><span class="w">     </span><span class="mh">400a95</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xa3</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># nums[i] &lt; 0 跳转到 FAIL</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a70:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = nums[i]</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a73:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0xf</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># nums[i] 和 15 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a76:</span><span class="w">   </span><span class="err">77</span><span class="w"> </span><span class="err">1</span><span class="nf">d</span><span class="w">                   </span><span class="no">ja</span><span class="w">     </span><span class="mh">400a95</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xa3</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># nums[i] &gt; 15 跳转到 FAIL</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a78:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = nums[i]</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a7b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">98</span><span class="w">                   </span><span class="nf">cltq</span><span class="w">                                </span><span class="c1"># eax 符号扩展到 rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a7d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">04</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">60</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x602140</span><span class="p">(,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="nv">%rax</span><span class="w">       </span><span class="c1"># rax = operators[nums[i]]</span>

<span class="c1"># 这里是一个一维数组，存储的是函数指针</span>
<span class="err">(</span><span class="nf">gdb</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="err">/</span><span class="mi">16</span><span class="no">g</span><span class="w"> </span><span class="mi">0x602140</span>
<span class="err">0</span><span class="nf">x602140</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x0000000000400902</span><span class="w">  </span><span class="mi">0x0000000000400911</span>
<span class="err">0</span><span class="nf">x602150</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">16</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000400920</span><span class="w">  </span><span class="mi">0x000000000040092f</span>
<span class="err">0</span><span class="nf">x602160</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">32</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x000000000040093e</span><span class="w">  </span><span class="mi">0x000000000040094d</span>
<span class="err">0</span><span class="nf">x602170</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x000000000040095c</span><span class="w">  </span><span class="mi">0x000000000040096b</span>
<span class="err">0</span><span class="nf">x602180</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">64</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x000000000040097a</span><span class="w">  </span><span class="mi">0x0000000000400989</span>
<span class="err">0</span><span class="nf">x602190</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">80</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000400998</span><span class="w">  </span><span class="mi">0x00000000004009a7</span>
<span class="err">0</span><span class="nf">x6021a0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">96</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x00000000004009b6</span><span class="w">  </span><span class="mi">0x00000000004009c5</span>
<span class="err">0</span><span class="nf">x6021b0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">operators</span><span class="err">+</span><span class="mi">112</span><span class="err">&gt;</span><span class="p">:</span><span class="w">   </span><span class="mi">0x00000000004009d4</span><span class="w">  </span><span class="mi">0x00000000004009e3</span>



<span class="w">  </span><span class="err">400</span><span class="nl">a84:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">400</span><span class="nl">a85:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%edx</span><span class="w">              </span><span class="c1"># edx = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a88:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="nf">d7</span><span class="w">                   </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edx</span><span class="p">,</span><span class="nv">%edi</span><span class="w">                    </span><span class="c1"># edi = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a8a:</span><span class="w">   </span><span class="nf">ff</span><span class="w"> </span><span class="no">d0</span><span class="w">                   </span><span class="no">call</span><span class="w">   </span><span class="p">*</span><span class="nv">%rax</span><span class="w">                        </span><span class="c1"># 调用函数，返回值 eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a8c:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j = eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a8f:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fc</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">addl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i++</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a93:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">07</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400a9c</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xaa</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a95:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># FAIL</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a9a:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">13</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400aaf</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xbd</span><span class="p">&gt;</span>


<span class="w">  </span><span class="err">400</span><span class="nl">a9c:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w"> </span><span class="mi">04</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x4</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i 与 4 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa0:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="no">bc</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">400a5e</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x6c</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># i &lt;= 4 时持续循环</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa2:</span><span class="w">   </span><span class="err">81</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0x89</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># j 和 137 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa9:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aac:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aaf:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">400</span><span class="no">ab0</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">400</span><span class="no">ab1</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">2</span><span class="no">e</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cs</span><span class="w"> </span><span class="no">nopw</span><span class="w"> </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ab8:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">400</span><span class="nl">abb:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">44</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">nopl</span><span class="w">   </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<details class="tip">
<summary><code>operators</code> 函数指针数组指向的十六个运算函数</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">0000000000400902</span><span class="w"> </span><span class="err">&lt;</span><span class="nf">_opfunc0_</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">400902:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400903:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400906:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400909:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">c:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">2</span><span class="no">b</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x2b</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">f:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400910:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">0000000000400911</span> <span class="p">&lt;</span><span class="no">_opfunc1_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">400911:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400912:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400915:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400918:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">b:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">35</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x35</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">e:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">f:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">0000000000400920</span> <span class="p">&lt;</span><span class="no">_opfunc2_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">400920:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400921:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400924:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400927:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">a:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">29</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x29</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">d:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">e:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040092f</span> <span class="p">&lt;</span><span class="no">_opfunc3_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">f:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400930:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400933:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400936:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400939:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">03</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x3</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">c:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">d:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040093e</span> <span class="p">&lt;</span><span class="no">_opfunc4_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">e:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400942:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400945:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400948:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">07</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x7</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">b:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">c:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040094d</span> <span class="p">&lt;</span><span class="no">_opfunc5_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">d:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400951:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400954:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400957:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1f</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">a:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">b:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040095c</span> <span class="p">&lt;</span><span class="no">_opfunc6_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">c:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400960:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400963:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400966:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">25</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x25</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400969:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">a:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040096b</span> <span class="p">&lt;</span><span class="no">_opfunc7_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">b:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">f:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400972:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400975:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">1</span><span class="no">d</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1d</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400978:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400979:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040097a</span> <span class="p">&lt;</span><span class="no">_opfunc8_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">a:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">e:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400981:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400984:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">05</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x5</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400987:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400988:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">0000000000400989</span> <span class="p">&lt;</span><span class="no">_opfunc9_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">400989:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">d:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400990:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400993:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">17</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x17</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400996:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400997:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">0000000000400998</span> <span class="p">&lt;</span><span class="no">_opfunc10_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">400998:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">400999:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40099</span><span class="nl">c:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">40099</span><span class="nl">f:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a2:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">02</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x2</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a5:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a6:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">00000000004009a7</span> <span class="p">&lt;</span><span class="no">_opfunc11_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a7:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ab:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ae:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b1:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">2</span><span class="no">f</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x2f</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b4:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b5:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">00000000004009b6</span> <span class="p">&lt;</span><span class="no">_opfunc12_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b6:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ba:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">bd:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c0:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">13</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x13</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c3:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c4:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">00000000004009c5</span> <span class="p">&lt;</span><span class="no">_opfunc13_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c5:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c9:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">cc:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">cf:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">11</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x11</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d2:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d3:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">00000000004009d4</span> <span class="p">&lt;</span><span class="no">_opfunc14_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d4:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d5:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d8:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">db:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">de:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">0</span><span class="no">b</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0xb</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e1:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e2:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">00000000004009e3</span> <span class="p">&lt;</span><span class="no">_opfunc15_</span><span class="p">&gt;:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e3:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e7:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%edi</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ea:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ed:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">0</span><span class="no">d</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0xd</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f0:</span><span class="w">   </span><span class="err">5</span><span class="nf">d</span><span class="w">                      </span><span class="no">pop</span><span class="w">    </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f1:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span>
</code></pre></div></td></tr></table></div>
</details>
<p>不难发现这 16 个函数对应的都是对参数 <code>j</code>（也就是 <code>-0x8(%rbp)</code>）的加法运算（具体地说，都是 <code>j += const_int</code> ）</p>
<table>
<thead>
<tr>
<th><em>opfunc</em></th>
<th style="text-align: center;">0</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
<th style="text-align: center;">7</th>
<th style="text-align: center;">8</th>
<th style="text-align: center;">9</th>
<th style="text-align: center;">10</th>
<th style="text-align: center;">11</th>
<th style="text-align: center;">12</th>
<th style="text-align: center;">13</th>
<th style="text-align: center;">14</th>
<th style="text-align: center;">15</th>
</tr>
</thead>
<tbody>
<tr>
<td>加上的数</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">53</td>
<td style="text-align: center;">41</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">29</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">47</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">13</td>
</tr>
</tbody>
</table>
<p>循环中 <code class="highlight"><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span></code> 说明可以进行五次计算，Phase 要求是：调用五次 <code>opfunc</code> 系列函数，要求调用完毕以后 <code>j</code> 的值恰好增加 <code>137</code> </p>
<p>手搓一个 $O(n^3)$ 的函数遍历一下可以得到 <code>7</code> <code>13</code> <code>17</code> <code>47</code> <code>53</code> 这五个数（答案不唯一，随意挑一个），找到对应的 <code>opfunc</code> 序号得到答案</p>
<p><strong>Answer: <code>1 4 11 13 15</code></strong> （不唯一，五个数字的顺序随意，也不一定必须是这五个数字） </p>
<h3 id="phase-8">Phase 8: 结构与链表/树</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">00000000004009</span><span class="nf">d3</span><span class="w"> </span><span class="err">&lt;</span><span class="no">phase</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d3:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d4:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d7:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">db:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">df:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">e6:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">c5</span><span class="w"> </span><span class="no">fb</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4005b0</span> <span class="p">&lt;</span><span class="no">strlen@plt</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 字符串长度必须为 15</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">eb:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w">             </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0xf</span><span class="p">,</span><span class="nv">%rax</span><span class="w">        </span>
<span class="w">  </span><span class="mi">4009</span><span class="no">ef</span><span class="p">:</span><span class="w">   </span><span class="mi">74</span><span class="w"> </span><span class="mi">0</span><span class="no">a</span><span class="w">                   </span><span class="no">je</span><span class="w">     </span><span class="mh">4009fb</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x28</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f1:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">f6:</span><span class="w">   </span><span class="nf">e9</span><span class="w"> </span><span class="no">d9</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400ad4</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x101</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">4009</span><span class="nl">fb:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0xc(%rbp) 记为 i，初始化为 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a02:</span><span class="w">   </span><span class="nf">e9</span><span class="w"> </span><span class="no">ab</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400ab2</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xdf</span><span class="p">&gt;</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a07:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0x8(%rbp) 记为 j，初始化为 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a0e:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span>
<span class="w">  </span><span class="err">400</span><span class="nl">a0f:</span><span class="w">   </span><span class="nf">c7</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># -0x10(%rbp) 记为 k，初始化为 0</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a16:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">53</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400a6b</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x98</span><span class="p">&gt;</span>

<span class="c1"># 这里是 0x602180 指向的数据结构，手动按照 x/3g 对齐了一下</span>
<span class="c1"># 标签中的 tree 暗示了 {值，左子树地址，右子树地址} 的数据结构</span>
<span class="err">0</span><span class="nf">x602180</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">&gt;</span><span class="p">:</span><span class="w">        </span><span class="mi">0x0000000000004d70</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602198</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">24</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000000000005567</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6021b0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">48</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000000000004e79</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6021c8</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">72</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000000000004675</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6021e0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">96</span><span class="err">&gt;</span><span class="p">:</span><span class="w">     </span><span class="mi">0x0000000000005661</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6021f8</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">120</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000005769</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602210</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">144</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000004872</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602228</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">168</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000004b6a</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602240</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">192</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x000000000000527a</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602258</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">216</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000004573</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602270</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">240</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000005068</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x602288</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">264</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x000000000000446c</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6022a0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">288</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000005366</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6022b8</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">312</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000004364</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="err">0</span><span class="nf">x6022d0</span><span class="w"> </span><span class="err">&lt;</span><span class="no">tree</span><span class="err">+</span><span class="mi">336</span><span class="err">&gt;</span><span class="p">:</span><span class="w">    </span><span class="mi">0x0000000000005877</span><span class="w">  </span><span class="mi">0x0000000000000000</span><span class="w">  </span><span class="mi">0x0000000000000000</span>
<span class="w">                        </span><span class="c1"># val               # leftNode          # rightNode</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a18:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">             </span><span class="c1"># eax = k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a1b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%rdx</span><span class="w">                    </span><span class="c1"># rdx = k（符号扩展到 64 位）</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a1e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a21:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = 2*k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a24:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = 3*k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a27:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c1</span><span class="w"> </span><span class="no">e0</span><span class="w"> </span><span class="mi">03</span><span class="w">             </span><span class="no">shl</span><span class="w">    </span><span class="no">$0x3</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax 左移三位</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a2b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">05</span><span class="w"> </span><span class="err">80</span><span class="w"> </span><span class="err">21</span><span class="w"> </span><span class="err">60</span><span class="w"> </span><span class="err">00</span><span class="w">       </span><span class="nf">add</span><span class="w">    </span><span class="no">$0x602180</span><span class="p">,</span><span class="nv">%rax</span><span class="w">               </span><span class="c1"># rax = 0x602180 + (8*3*k)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a31:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">10</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span><span class="w">                  </span><span class="c1"># edx = treeNode[k].val</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a34:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f4</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">              </span><span class="c1"># eax = i</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a37:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">c8</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%rcx</span><span class="w">                    </span><span class="c1"># rcx = i（符号扩展到 64 位）</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a3a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = 输入首地址</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a3e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">c8</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rcx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax += i</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a41:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">00</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">                  </span><span class="c1"># eax = input[i];</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a44:</span><span class="w">   </span><span class="err">38</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%dl</span><span class="w">                      </span><span class="c1"># 取低八位与 treeNode[k].val 比较 </span>
<span class="w">                                                                        </span><span class="c1"># 注意树节点值 val 也只取低八位</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a46:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">1</span><span class="nf">f</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">400a67</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 不相等则跳转到 400a67</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a48:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span><span class="w">             </span><span class="c1"># eax = k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a4b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">63</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">movslq</span><span class="w"> </span><span class="nv">%eax</span><span class="p">,</span><span class="nv">%rdx</span><span class="w">                    </span><span class="c1"># rdx = k（符号扩展至 64 位）</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a4e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a51:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = 2*k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a54:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">01</span><span class="w"> </span><span class="nf">d0</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = 3*k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a57:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="nf">c1</span><span class="w"> </span><span class="no">e0</span><span class="w"> </span><span class="mi">03</span><span class="w">             </span><span class="no">shl</span><span class="w">    </span><span class="no">$0x3</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax = 24*k</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a5b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">05</span><span class="w"> </span><span class="err">80</span><span class="w"> </span><span class="err">21</span><span class="w"> </span><span class="err">60</span><span class="w"> </span><span class="err">00</span><span class="w">       </span><span class="nf">add</span><span class="w">    </span><span class="no">$0x602180</span><span class="p">,</span><span class="nv">%rax</span><span class="w">               </span><span class="c1"># rax = 0x602180 + (8*3*k)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a61:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j = &amp;(treeNode[k])</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a65:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">0</span><span class="no">a</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400a71</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x9e</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400a71</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a67:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f0</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">addl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># k++</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a6b:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f0</span><span class="w"> </span><span class="mi">0</span><span class="no">e</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0xe</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># k 与 14 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a6f:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="no">a7</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">400a18</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x45</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># k &lt;= 14 回到循环</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a71:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmpq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j 与 0 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a76:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">400a7f</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xac</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># j != 0 时跳转，否则 FAIL</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a78:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a7d:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">55</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400ad4</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x101</span><span class="p">&gt;</span>
<span class="w">                                                                        </span><span class="c1"># 原注释：0x201__(%rip) 地址都是 602310</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a7f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">8</span><span class="no">a</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x20188a</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># rax = root（root 一开始为 0）</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a86:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax != 0 时跳转到 400a98 </span>
<span class="w">  </span><span class="err">400</span><span class="nl">a89:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">0</span><span class="nf">d</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">400a98</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xc5</span><span class="p">&gt;</span><span class="w">          </span>
<span class="w">  </span><span class="mi">400</span><span class="no">a8b</span><span class="p">:</span><span class="w">   </span><span class="mi">48</span><span class="w"> </span><span class="mi">8</span><span class="no">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a8f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">05</span><span class="w"> </span><span class="err">7</span><span class="nf">a</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="mi">0x20187a</span><span class="p">(</span><span class="nv">%rip</span><span class="p">)</span><span class="w">          </span><span class="c1"># root = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a96:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">16</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400aae</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xdb</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 400aae</span>

<span class="w">  </span><span class="err">400</span><span class="nl">a98:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x201871</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a9f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">              </span><span class="c1"># rdx = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rsi</span><span class="w">                    </span><span class="c1"># rsi = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                    </span><span class="c1"># rdi = root</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">37</span><span class="w"> </span><span class="no">fe</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008e5</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">&gt;</span><span class="w">              </span><span class="c1"># 调用 insert 函数</span>

<span class="w">  </span><span class="err">400</span><span class="nl">aae:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f4</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">addl</span><span class="w">   </span><span class="no">$0x1</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i++</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ab2:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f4</span><span class="w"> </span><span class="mi">0</span><span class="no">e</span><span class="w">             </span><span class="no">cmpl</span><span class="w">   </span><span class="no">$0xe</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># i &lt;= 14?</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ab6:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">8</span><span class="no">e</span><span class="w"> </span><span class="mi">4</span><span class="no">b</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">       </span><span class="no">jle</span><span class="w">    </span><span class="mh">400a07</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x34</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># i &lt;= 14 跳回 400a07</span>

<span class="w">  </span><span class="err">400</span><span class="nl">abc:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">4</span><span class="no">d</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x20184d</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ac3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                    </span><span class="c1"># rdi = rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ac6:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">b0</span><span class="w"> </span><span class="no">fe</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40097b</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">&gt;</span><span class="w">               </span><span class="c1"># 调用 depth 函数</span>
<span class="w">  </span><span class="err">400</span><span class="nl">acb:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">04</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 返回值 eax 与 4 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ace:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                          </span><span class="c1"># 相等则 al = 1</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ad1:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># eax = 1</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ad4:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">                               </span><span class="c1"># 结束 Phase</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ad5:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">400</span><span class="no">ad6</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">2</span><span class="no">e</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cs</span><span class="w"> </span><span class="no">nopw</span><span class="w"> </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">add:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span>

<span class="err">00000000004008</span><span class="nf">e5</span><span class="w"> </span><span class="err">&lt;</span><span class="no">insert</span><span class="err">&gt;</span><span class="p">:</span><span class="w">                                              </span><span class="c1"># 我们过一会再分析这个函数</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e5:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e9:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x10</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ed:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">75</span><span class="w"> </span><span class="nf">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f5:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmpq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fa:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">02</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">4008fe</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x19</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fc:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">7</span><span class="no">b</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400979</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fe:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400902:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span>
<span class="w">  </span><span class="err">400906:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">a:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">e:</span><span class="w">   </span><span class="err">38</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%dl</span>
<span class="w">  </span><span class="err">400910:</span><span class="w">   </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="mi">34</span><span class="w">                   </span><span class="no">jge</span><span class="w">    </span><span class="mh">400946</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x61</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400912:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400916:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">d:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">19</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400938</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x53</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400923:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400927:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400931:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">af</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008e5</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400936:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">40</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400978</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x93</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400938:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">400940:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">50</span><span class="w"> </span><span class="err">08</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">)</span>
<span class="w">  </span><span class="err">400944:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">33</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400979</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400946:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400951:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">19</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40096c</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x87</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400953:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400957:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">400962:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400965:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">7</span><span class="no">b</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008e5</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">a:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400978</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x93</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400970:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">400974:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">50</span><span class="w"> </span><span class="err">10</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">)</span>
<span class="w">  </span><span class="err">400978:</span><span class="w">   </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span>
<span class="w">  </span><span class="err">400979:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">40097</span><span class="no">a</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>

<span class="mh">000000000040097b</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">&gt;:</span><span class="w">                                               </span><span class="c1"># 只要知道这个函数计算二叉树的深度即可</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">b:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">40097</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">20</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x20</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">400983:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">400987:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">e8</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmpq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">c:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">07</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">400995</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">+</span><span class="mi">0x1a</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40098</span><span class="nl">e:</span><span class="w">   </span><span class="nf">b8</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">mov</span><span class="w">    </span><span class="no">$0x0</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">400993:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">3</span><span class="no">c</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009d1</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">+</span><span class="mi">0x56</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400995:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400999:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40099</span><span class="nl">d:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a0:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">d6</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40097b</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a5:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">a8:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">e8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x18</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ac:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b0:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b3:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">c3</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40097b</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">b8:</span><span class="w">   </span><span class="err">89</span><span class="w"> </span><span class="err">45</span><span class="w"> </span><span class="nf">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%eax</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">bb:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">be:</span><span class="w">   </span><span class="err">3</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c1:</span><span class="w">   </span><span class="err">7</span><span class="nf">e</span><span class="w"> </span><span class="mi">08</span><span class="w">                   </span><span class="no">jle</span><span class="w">    </span><span class="mh">4009cb</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">+</span><span class="mi">0x50</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c3:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">fc</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x4</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c6:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">c9:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">06</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">4009d1</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">+</span><span class="mi">0x56</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">cb:</span><span class="w">   </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">ce:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">c0</span><span class="w"> </span><span class="mi">01</span><span class="w">                </span><span class="no">add</span><span class="w">    </span><span class="no">$0x1</span><span class="p">,</span><span class="nv">%eax</span>
<span class="w">  </span><span class="err">4009</span><span class="nl">d1:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">4009</span><span class="no">d2</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>和 CSAPP-Bomblab 的 Secret Phase 一样，都是二叉搜索树，但是这个明显难一些</p>
<p>首先开头检查字符串长度必须为 15，并且能大致看出这个 Phase 涉及二叉树的建立（尤其是 <code>0x602180 &lt;tree&gt;</code> 这里）。然后直接看代码的最后部分</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="err">400</span><span class="nl">abc:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">4</span><span class="no">d</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x20184d</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ac3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                    </span><span class="c1"># rdi = rax</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ac6:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">b0</span><span class="w"> </span><span class="no">fe</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">40097b</span> <span class="p">&lt;</span><span class="no">depth</span><span class="p">&gt;</span><span class="w">               </span><span class="c1"># 调用 depth 函数</span>
<span class="w">  </span><span class="err">400</span><span class="nl">acb:</span><span class="w">   </span><span class="err">83</span><span class="w"> </span><span class="nf">f8</span><span class="w"> </span><span class="mi">04</span><span class="w">                </span><span class="no">cmp</span><span class="w">    </span><span class="no">$0x4</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                    </span><span class="c1"># 返回值 eax 与 4 比较</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ace:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="mi">94</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">sete</span><span class="w">   </span><span class="nv">%al</span><span class="w">                          </span><span class="c1"># 相等则 al = 1</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ad1:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="no">c0</span><span class="w">                </span><span class="no">movzbl</span><span class="w"> </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%eax</span><span class="w">                     </span><span class="c1"># eax = 1</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ad4:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">                               </span><span class="c1"># 结束 Phase</span>
<span class="w">  </span><span class="err">400</span><span class="nl">ad5:</span><span class="w">   </span><span class="nf">c3</span><span class="w">                      </span><span class="no">ret</span><span class="w">    </span>
<span class="w">  </span><span class="mi">400</span><span class="no">ad6</span><span class="p">:</span><span class="w">   </span><span class="mi">66</span><span class="w"> </span><span class="mi">2</span><span class="no">e</span><span class="w"> </span><span class="mi">0</span><span class="no">f</span><span class="w"> </span><span class="mi">1</span><span class="no">f</span><span class="w"> </span><span class="mi">84</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">cs</span><span class="w"> </span><span class="no">nopw</span><span class="w"> </span><span class="mi">0x0</span><span class="p">(</span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="err">400</span><span class="nl">add:</span><span class="w">   </span><span class="err">00</span><span class="w"> </span><span class="err">00</span><span class="w"> </span><span class="err">00</span>
</code></pre></div></td></tr></table></div>
<p>经过一系列的建二叉树操作后，二叉树的深度必须为 4，若深度为 4 则 Phase 输入正确</p>
<p>因此中间的内容都围绕着建二叉树展开：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0xc</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0xc(%rbp) 记为 i，初始化为 0</span>
<span class="nf">jmp</span><span class="w">    </span><span class="mh">400ab2</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xdf</span><span class="p">&gt;</span>
<span class="nf">movq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># -0x8(%rbp) 记为 j，初始化为 0</span>
<span class="nf">movl</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># -0x10(%rbp) 记为 k，初始化为 0</span>
<span class="nf">jmp</span><span class="w">    </span><span class="mh">400a6b</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0x98</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<p>我们重点关注这三个变量，尤其是关注它们的赋值情况</p>
<p><code>i</code> 变量是最外层的循环计数器，并且有这样的使用方法：</p>
<p>--&gt; <code class="highlight"><span class="err">400</span><span class="nl">a41:</span><span class="w"> </span><span class="nf">movzbl</span><span class="w"> </span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">          </span><span class="c1"># eax = input[i];</span></code></p>
<p>由此可见，<code>i</code> 用于遍历输入的字符串，从 <code>input[0]</code> 遍历到 <code>input[14]</code></p>
<p><code>k</code> 变量也是 <code>(k = 0; k &lt;=14; k++)</code> 的循环结构</p>
<p>--&gt; <code>#!asm 400a61: mov %rax,-0x8(%rbp)         # j = &amp;(treeNode[k])</code></p>
<p>由此可见，<code>k</code> 用于遍历二叉树节点</p>
<p><code>j</code> 变量和 <code>k</code> 变量的关系从上面的例子中已经能很好的表示了</p>
<p>继续观察理解，我们可以将 <code>i</code> 的大循环压缩为这样的 C 语言代码：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">14</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">14</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">treeNode</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">val</span><span class="p">)</span>
<span class="w">            </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">treeNode</span><span class="p">[</span><span class="n">k</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">FAIL</span><span class="p">();</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">insert</span><span class="p">(</span><span class="o">?</span><span class="p">);</span><span class="w"> </span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>也就是说，我的 15 位字符串输入，每一位的 ASCII 值的都可以和二叉树的一个节点匹配，否则 FAIL</p>
<p>现在的问题是，我们并不清楚 <code>insert</code> 函数的逻辑：</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">  </span><span class="c1"># 不难发现，root 初始化为 0，所以 insert 操作在 i = 0 时一定不会进行</span>
<span class="w">  </span><span class="c1"># 因为 i = 0 对应根节点，不需要被插入</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a7f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">8</span><span class="no">a</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x20188a</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># rax = root（root 一开始为 0）</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a86:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># rax != 0 时跳转到 400a98 </span>
<span class="w">  </span><span class="c1"># 这里是根节点才会进行的操作，令 root = j = &amp;(treeNode[k])</span>
<span class="w">  </span><span class="c1"># 接下来进行 insert 操作时，我们就能定位根节点了</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a89:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">0</span><span class="nf">d</span><span class="w">                   </span><span class="no">jne</span><span class="w">    </span><span class="mh">400a98</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xc5</span><span class="p">&gt;</span><span class="w">          </span>
<span class="w">  </span><span class="mi">400</span><span class="no">a8b</span><span class="p">:</span><span class="w">   </span><span class="mi">48</span><span class="w"> </span><span class="mi">8</span><span class="no">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a8f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">05</span><span class="w"> </span><span class="err">7</span><span class="nf">a</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="mi">0x20187a</span><span class="p">(</span><span class="nv">%rip</span><span class="p">)</span><span class="w">          </span><span class="c1"># root = j</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a96:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">16</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400aae</span> <span class="p">&lt;</span><span class="no">phase</span><span class="p">+</span><span class="mi">0xdb</span><span class="p">&gt;</span><span class="w">          </span><span class="c1"># 跳转到 i++ 的地方</span>
<span class="w">  </span><span class="c1"># 为使用 insert 函数进行寄存器准备</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a98:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">05</span><span class="w"> </span><span class="mi">71</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">00</span><span class="w">    </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x201871</span><span class="p">(</span><span class="nv">%rip</span><span class="p">),</span><span class="nv">%rax</span><span class="w">          </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">400</span><span class="nl">a9f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">              </span><span class="c1"># rdx = &amp;(treeNode[k])</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa3:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rsi</span><span class="w">                    </span><span class="c1"># rsi = &amp;(treeNode[k])</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span><span class="w">                    </span><span class="c1"># rdi = root</span>
<span class="w">  </span><span class="err">400</span><span class="nl">aa9:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">37</span><span class="w"> </span><span class="no">fe</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008e5</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">&gt;</span><span class="w">              </span><span class="c1"># 调用 insert 函数</span>

<span class="w">  </span><span class="err">00000000004008</span><span class="nf">e5</span><span class="w"> </span><span class="err">&lt;</span><span class="no">insert</span><span class="err">&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e5:</span><span class="w">   </span><span class="err">55</span><span class="w">                      </span><span class="nf">push</span><span class="w">   </span><span class="nv">%rbp</span><span class="w">                         </span><span class="c1"># 正常的栈操作</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e6:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">e5</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsp</span><span class="p">,</span><span class="nv">%rbp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">e9:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="nf">ec</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">sub</span><span class="w">    </span><span class="no">$0x10</span><span class="p">,</span><span class="nv">%rsp</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">ed:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdi</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># j = rdi = root</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f1:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">75</span><span class="w"> </span><span class="nf">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rsi</span><span class="p">,-</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">             </span><span class="c1"># K = &amp;(treeNode[k])，待插入节点地址</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">f5:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">83</span><span class="w"> </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="no">f8</span><span class="w"> </span><span class="mi">00</span><span class="w">          </span><span class="no">cmpq</span><span class="w">   </span><span class="no">$0x0</span><span class="p">,-</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">)</span><span class="w">              </span><span class="c1"># root 和 0 比较</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fa:</span><span class="w">   </span><span class="err">75</span><span class="w"> </span><span class="err">02</span><span class="w">                   </span><span class="nf">jne</span><span class="w">    </span><span class="mh">4008fe</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x19</span><span class="p">&gt;</span><span class="w">         </span><span class="c1"># 不相等则继续</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fc:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">7</span><span class="no">b</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400979</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span><span class="w">         </span><span class="c1"># 意料外的 root = 0，退出函数</span>
<span class="w">  </span><span class="err">4008</span><span class="nl">fe:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">             </span><span class="c1"># rax = K</span>
<span class="w">  </span><span class="err">400902:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%edx</span><span class="w">               </span><span class="c1"># edx = K-&gt;val[3:2]</span>
<span class="w">  </span><span class="err">400906:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">a:</span><span class="w">   </span><span class="err">0</span><span class="nf">f</span><span class="w"> </span><span class="no">b6</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">01</span><span class="w">             </span><span class="no">movzbl</span><span class="w"> </span><span class="mi">0x1</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%eax</span><span class="w">               </span><span class="c1"># eax = root-&gt;val[3:2]</span>
<span class="w">  </span><span class="err">40090</span><span class="nl">e:</span><span class="w">   </span><span class="err">38</span><span class="w"> </span><span class="nf">c2</span><span class="w">                   </span><span class="no">cmp</span><span class="w">    </span><span class="nv">%al</span><span class="p">,</span><span class="nv">%dl</span><span class="w">                      </span><span class="c1"># eax 和 edx 比大小</span>
<span class="w">  </span><span class="err">400910:</span><span class="w">   </span><span class="err">7</span><span class="nf">d</span><span class="w"> </span><span class="mi">34</span><span class="w">                   </span><span class="no">jge</span><span class="w">    </span><span class="mh">400946</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x61</span><span class="p">&gt;</span><span class="w">         </span><span class="c1"># 插入子树的分支</span>
<span class="w">  </span><span class="c1"># k-&gt;val &lt; root-&gt;val，则尝试插入左子树：</span>
<span class="w">  </span><span class="err">400912:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">400916:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span><span class="w">               </span><span class="c1"># rax = root-&gt;left</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span><span class="w">                    </span><span class="c1"># root-&gt;left 是否为空</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">d:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">19</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">400938</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x53</span><span class="p">&gt;</span><span class="w">         </span><span class="c1"># 为空就插入</span>
<span class="w">    </span><span class="c1"># 如果左子树不为空，递归至下一层，这期间的操作参考 400a98 的部分：</span>
<span class="w">  </span><span class="err">40091</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span>
<span class="w">  </span><span class="mi">400923</span><span class="p">:</span><span class="w">   </span><span class="mi">48</span><span class="w"> </span><span class="mi">8</span><span class="no">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">08</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400927:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">40092</span><span class="nl">e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400931:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="no">af</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008e5</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">400936:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">40</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400978</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x93</span><span class="p">&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="c1"># 如果左子树为空，插入左子树：</span>
<span class="w">  </span><span class="err">400938:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span><span class="w">              </span><span class="c1"># rax = root</span>
<span class="w">  </span><span class="err">40093</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span><span class="w">             </span><span class="c1"># rdx = K</span>
<span class="w">  </span><span class="err">400940:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">50</span><span class="w"> </span><span class="err">08</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x8</span><span class="p">(</span><span class="nv">%rax</span><span class="p">)</span><span class="w">               </span><span class="c1"># K 插入至左子树</span>
<span class="w">  </span><span class="err">400944:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">33</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400979</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x94</span><span class="p">&gt;</span>
<span class="w">  </span><span class="c1"># k-&gt;val &gt;= root-&gt;val，则尝试插入右子树：</span>
<span class="w">  </span><span class="err">400946:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">a:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40094</span><span class="nl">e:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">85</span><span class="w"> </span><span class="nf">c0</span><span class="w">                </span><span class="no">test</span><span class="w">   </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400951:</span><span class="w">   </span><span class="err">74</span><span class="w"> </span><span class="err">19</span><span class="w">                   </span><span class="nf">je</span><span class="w">     </span><span class="mh">40096c</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x87</span><span class="p">&gt;</span>
<span class="w">    </span><span class="c1"># 如果右子树不为空，递归至下一层，这期间的操作参考 400a98 的部分：</span>
<span class="w">  </span><span class="err">400953:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400957:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">10</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">b:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">40095</span><span class="nl">f:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">d6</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="nv">%rsi</span>
<span class="w">  </span><span class="err">400962:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="nf">c7</span><span class="w">                </span><span class="no">mov</span><span class="w">    </span><span class="nv">%rax</span><span class="p">,</span><span class="nv">%rdi</span>
<span class="w">  </span><span class="err">400965:</span><span class="w">   </span><span class="nf">e8</span><span class="w"> </span><span class="mi">7</span><span class="no">b</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w"> </span><span class="no">ff</span><span class="w">          </span><span class="no">call</span><span class="w">   </span><span class="mh">4008e5</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">&gt;</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">a:</span><span class="w">   </span><span class="nf">eb</span><span class="w"> </span><span class="mi">0</span><span class="no">c</span><span class="w">                   </span><span class="no">jmp</span><span class="w">    </span><span class="mh">400978</span> <span class="p">&lt;</span><span class="no">insert</span><span class="p">+</span><span class="mi">0x93</span><span class="p">&gt;</span>
<span class="w">    </span><span class="c1"># 如果右子树为空，插入右子树：</span>
<span class="w">  </span><span class="err">40096</span><span class="nl">c:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="no">f8</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x8</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rax</span>
<span class="w">  </span><span class="err">400970:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">8</span><span class="nf">b</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="no">f0</span><span class="w">             </span><span class="no">mov</span><span class="w">    </span><span class="mi">-0</span><span class="no">x10</span><span class="p">(</span><span class="nv">%rbp</span><span class="p">),</span><span class="nv">%rdx</span>
<span class="w">  </span><span class="err">400974:</span><span class="w">   </span><span class="err">48</span><span class="w"> </span><span class="err">89</span><span class="w"> </span><span class="err">50</span><span class="w"> </span><span class="err">10</span><span class="w">             </span><span class="nf">mov</span><span class="w">    </span><span class="nv">%rdx</span><span class="p">,</span><span class="mi">0x10</span><span class="p">(</span><span class="nv">%rax</span><span class="p">)</span>
<span class="w">  </span><span class="err">400978:</span><span class="w">   </span><span class="err">90</span><span class="w">                      </span><span class="nf">nop</span>
<span class="w">  </span><span class="err">400979:</span><span class="w">   </span><span class="nf">c9</span><span class="w">                      </span><span class="no">leave</span><span class="w">  </span>
<span class="w">  </span><span class="mi">40097</span><span class="no">a</span><span class="p">:</span><span class="w">   </span><span class="no">c3</span><span class="w">                      </span><span class="no">ret</span>
</code></pre></div></td></tr></table></div>
<details class="quote">
<summary>摘自 OI-Wiki 的<a href="https://oiwiki.org/ds/bst">二叉搜索树</a>相关知识</summary>
<p>二叉搜索树是一种二叉树的树形数据结构，其定义如下：</p>
<ul>
<li>
<p>空树是二叉搜索树。</p>
</li>
<li>
<p>若二叉搜索树的左子树不为空，则其左子树上所有点的附加权值均小于其根节点的值。</p>
</li>
<li>
<p>若二叉搜索树的右子树不为空，则其右子树上所有点的附加权值均大于其根节点的值。</p>
</li>
<li>
<p>二叉搜索树的左右子树均为二叉搜索树。</p>
</li>
</ul>
<p><strong>插入一个元素</strong></p>
<p>在以 root 为根节点的二叉搜索树中插入一个值为 value 的节点。</p>
<p>分类讨论如下：</p>
<ul>
<li>
<p>若 root 为空，直接返回一个值为 value 的新节点。</p>
</li>
<li>
<p>若 root 的权值等于 value，该节点的附加域该值出现的次数自增 1</p>
</li>
<li>
<p>若 root 的权值大于 value，在 root 的左子树中插入权值为 value 的节点。</p>
</li>
<li>
<p>若 root 的权值小于 value，在 root 的右子树中插入权值为 value 的节点。</p>
</li>
</ul>
</details>
<p>以上我们明白了 <code>insert</code> 函数的功能就是在二叉搜索树上插入新的值</p>
<p>这里需要尤其注意的是：在输入的单个字符与节点对应时，我们取的是节点值的最低八位；而在 <code>insert</code> 操作时，我们取的是 <code>val[3:2]</code>，也就是低十六位的高八位。因此我们在理解 <code>treeNode</code> 的 <code>val</code> 内容时，必须分开来看</p>
<p>以下是 <code>val</code> 取低十六位时，低八位 ASCII 字符与高八位十六进制数的对应表：</p>
<table>
<thead>
<tr>
<th style="text-align: center;">p</th>
<th style="text-align: center;">g</th>
<th style="text-align: center;">y</th>
<th style="text-align: center;">u</th>
<th style="text-align: center;">a</th>
<th style="text-align: center;">i</th>
<th style="text-align: center;">r</th>
<th style="text-align: center;">j</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">s</th>
<th style="text-align: center;">h</th>
<th style="text-align: center;">l</th>
<th style="text-align: center;">f</th>
<th style="text-align: center;">d</th>
<th style="text-align: center;">w</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0x4d</td>
<td style="text-align: center;">0x55</td>
<td style="text-align: center;">0x4e</td>
<td style="text-align: center;">0x46</td>
<td style="text-align: center;">0x56</td>
<td style="text-align: center;">0x57</td>
<td style="text-align: center;">0x48</td>
<td style="text-align: center;">0x4b</td>
<td style="text-align: center;">0x52</td>
<td style="text-align: center;">0x45</td>
<td style="text-align: center;">0x50</td>
<td style="text-align: center;">0x44</td>
<td style="text-align: center;">0x53</td>
<td style="text-align: center;">0x43</td>
<td style="text-align: center;">0x58</td>
</tr>
</tbody>
</table>
<p>我们又知道，15 个节点的二叉树要求深度为 4，那么它必须是一个满二叉树。下面不加证明的给出一个结论：</p>
<blockquote>
<p>满二叉搜索树的中序遍历是节点值的递增序列</p>
</blockquote>
<p>我们给出这个递增序列对应的节点编号 <code>dlsurjpyhzfgaiw</code>，之后的计算过程略</p>
<p><strong>Answer: <code>yugljzidsrphfaw</code></strong></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../stylesheets/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>